# Complete Daily Report Architecture & Implementation Guide

**ë¬¸ì„œ ë²„ì „**: 2.0
**ì‘ì„±ì¼**: 2025-11-11
**ì‘ì„±ì**: Claude Code (Sonnet 4.5)
**ê²€ì¦ ìƒíƒœ**: âœ… ì‹¤ì œ ë™ì‘ ê²€ì¦ ì™„ë£Œ (2025-11-10 ë³´ê³ ì„œ ìƒì„± ì„±ê³µ)

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ì „ì²´ ì•„í‚¤í…ì²˜](#ì „ì²´-ì•„í‚¤í…ì²˜)
3. [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)
4. [í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ìƒì„¸](#í•µì‹¬-ì»´í¬ë„ŒíŠ¸-ìƒì„¸)
5. [ìë™í™” vs ìˆ˜ë™ í”„ë¡œì„¸ìŠ¤](#ìë™í™”-vs-ìˆ˜ë™-í”„ë¡œì„¸ìŠ¤)
6. [Claude --print ë©”ì»¤ë‹ˆì¦˜](#claude---print-ë©”ì»¤ë‹ˆì¦˜)
7. [MCP ì„œë²„ í†µí•©](#mcp-ì„œë²„-í†µí•©)
8. [ì†ŒìŠ¤ì½”ë“œ ë¶„ì„](#ì†ŒìŠ¤ì½”ë“œ-ë¶„ì„)
9. [ì‹¤ì „ ê°€ì´ë“œ](#ì‹¤ì „-ê°€ì´ë“œ)
10. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ê°œìš”

### ì‹œìŠ¤í…œ ëª©ì 

**ì¼ê°„ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ìë™ ë³´ê³ ì„œ ìƒì„± ì‹œìŠ¤í…œ**ì€ ë‹¤ìŒ ëª©í‘œë¥¼ ë‹¬ì„±í•©ë‹ˆë‹¤:

1. **ë°ì´í„° í†µí•©**: OpenSearch (Cortex XDR) + PostgreSQL (TI/MITRE/CVE) ì™„ì „ í†µí•©
2. **ìë™ ë¶„ì„**: claude CLI ë˜ëŠ” Claude Codeë¥¼ í†µí•œ AI ë¶„ì„ ìë™í™”
3. **ì „ë¬¸ ë³´ê³ ì„œ**: HTML/Markdown/JSON 3ê°œ í¬ë§·ì˜ ì „ë¬¸ì ì¸ í•œêµ­ì–´ ë³´ì•ˆ ë³´ê³ ì„œ
4. **Cron ìë™í™”**: ì™„ì „ ë¬´ì¸ ìë™í™” ê°€ëŠ¥ (Supabase ì—ëŸ¬ ì•Œë¦¼ í¬í•¨)
5. **MCP í™•ì¥**: 12ê°œ MCP ì„œë²„ë¡œ ì‹¤ì‹œê°„ ë°ì´í„° ì¡°íšŒ ë° í™•ì¥ ê°€ëŠ¥

### í•µì‹¬ ë©”íŠ¸ë¦­ (ì‹¤ì œ ê²€ì¦ ì™„ë£Œ)

| í•­ëª© | 2025-11-09 (ìˆ˜ë™) | 2025-11-10 (ìë™) âœ… |
|------|-------------------|---------------------|
| **ì¸ì‹œë˜íŠ¸** | 125ê±´ | 17ê±´ |
| **ë°ì´í„° ìˆ˜ì§‘ ì‹œê°„** | 30-60ì´ˆ | 30ì´ˆ |
| **AI ë¶„ì„ ë°©ë²•** | Claude Code ìˆ˜ë™ | claude --print ìë™ |
| **AI ë¶„ì„ ì‹œê°„** | 2-3ë¶„ (ìˆ˜ë™) | 60-120ì´ˆ (ìë™) |
| **ë³´ê³ ì„œ ìƒì„± ì‹œê°„** | 5-10ì´ˆ | 5ì´ˆ |
| **ì´ ì†Œìš” ì‹œê°„** | 5ë¶„ (ìˆ˜ë™ ì‘ì—… í¬í•¨) | 2-3ë¶„ (ì™„ì „ ìë™) |
| **íŒŒì¼ í¬ê¸°** | 245KB (HTML+MD+JSON) | 117.9KB (HTML+MD+JSON) |
| **ë¹„ìš©** | $0 (ë¬´ë£Œ) | $0.01-0.05 (ì¶”ì •) |
| **ìë™í™”** | âŒ ë¶ˆê°€ | âœ… Cron ê°€ëŠ¥ |

---

## ì „ì²´ ì•„í‚¤í…ì²˜

### ë ˆì´ì–´ë³„ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸŒ ë°ì´í„° ì†ŒìŠ¤ ë ˆì´ì–´                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Remote OpenSearch               â”‚  â”‚ PostgreSQL n8n (Remote)         â”‚â”‚
â”‚  â”‚ 20.41.120.173:9200              â”‚  â”‚ postgres:5432 â†’ 20.41.120.173   â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ â€¢ logs-cortex_xdr-incidents-*   â”‚  â”‚ â€¢ ioclog.threat_intel_feeds    â”‚â”‚
â”‚  â”‚ â€¢ logs-cortex_xdr-alerts-*      â”‚  â”‚ â€¢ ioclog.mitre_attack          â”‚â”‚
â”‚  â”‚ â€¢ logs-cortex_xdr-files-*       â”‚  â”‚ â€¢ ioclog.cve_catalog           â”‚â”‚
â”‚  â”‚ â€¢ logs-cortex_xdr-networks-*    â”‚  â”‚ â€¢ ioclog.nsrl_modern (9M)      â”‚â”‚
â”‚  â”‚ â€¢ ~29,578 incidents             â”‚  â”‚ â€¢ ~1.36M IOC vectors           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Local OpenSearch                â”‚  â”‚ PostgreSQL Editor (Local)       â”‚â”‚
â”‚  â”‚ localhost:9200                  â”‚  â”‚ localhost:5432/postgres         â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ â€¢ IOC Vector Search (k-NN)      â”‚  â”‚ â€¢ Application data              â”‚â”‚
â”‚  â”‚ â€¢ 1.36M vectors                 â”‚  â”‚ â€¢ User, DashboardConfig         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ”Œ MCP ì„œë²„ ë ˆì´ì–´ (12ê°œ)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ğŸ“¦ í‘œì¤€ MCP (5ê°œ)                                                           â”‚
â”‚  â”œâ”€ next-devtools       : Next.js 16 ê°œë°œ ë„êµ¬                              â”‚
â”‚  â”œâ”€ chrome-devtools     : ë¸Œë¼ìš°ì € ìë™í™” (Playwright)                       â”‚
â”‚  â”œâ”€ context7            : ìµœì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì„œ ì¡°íšŒ                          â”‚
â”‚  â”œâ”€ memory              : ì§€ì‹ ê·¸ë˜í”„ ì €ì¥ì†Œ                                 â”‚
â”‚  â””â”€ shadcn              : shadcn/ui ì»´í¬ë„ŒíŠ¸ ê´€ë¦¬                            â”‚
â”‚                                                                              â”‚
â”‚  ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ MCP (4ê°œ)                                                   â”‚
â”‚  â”œâ”€ postgres-siem       : SIEM DB (siem_db)                                â”‚
â”‚  â”œâ”€ postgres-editor     : Editor DB (postgres)                             â”‚
â”‚  â”œâ”€ postgres-n8n        : n8n DB (ioclog schema) - TI/MITRE/CVE           â”‚
â”‚  â””â”€ opensearch          : Remote OpenSearch (20.41.120.173)               â”‚
â”‚                                                                              â”‚
â”‚  ğŸ›¡ï¸ ì»¤ìŠ¤í…€ ë³´ì•ˆ MCP (3ê°œ)                                                    â”‚
â”‚  â”œâ”€ incident-analysis   : í†µê³„, ì°¨íŠ¸, ë³´ê³ ì„œ ìƒì„± (5ê°œ í•¨ìˆ˜)                 â”‚
â”‚  â”œâ”€ claude-investigation: ìƒì„¸ ë¶„ì„, HTML ë³´ê³ ì„œ (2ê°œ í•¨ìˆ˜)                  â”‚
â”‚  â””â”€ nl-query            : ìì—°ì–´ â†’ OpenSearch DSL ë³€í™˜ (2ê°œ í•¨ìˆ˜)           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          âš™ï¸ ì²˜ë¦¬ ì—”ì§„ ë ˆì´ì–´                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ğŸ”§ ë°ì´í„° ìˆ˜ì§‘ ì—”ì§„                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ collect-daily-incidents-data.ts                                      â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 1. OpenSearch ì¿¼ë¦¬ (7ê°œ ì¸ë±ìŠ¤)                                       â”‚  â”‚
â”‚  â”‚    - incidents (17ê±´)                                                â”‚  â”‚
â”‚  â”‚    - alerts, files, networks, processes, endpoints, causality_chains â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 2. TI ìƒê´€ë¶„ì„ (Benign Hash Cache + Vector Search)                  â”‚  â”‚
â”‚  â”‚    - Benign Hash Cache: PostgreSQL + NSRL (9M hashes)               â”‚  â”‚
â”‚  â”‚    - Vector Search: Local OpenSearch k-NN (1.36M vectors)           â”‚  â”‚
â”‚  â”‚    - ê²°ê³¼: 28ê°œ í•´ì‹œ â†’ Benign 24, Unknown 4, Threat 0               â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 3. MITRE ATT&CK ë§¤í•‘                                                 â”‚  â”‚
â”‚  â”‚    - PostgreSQL mitre_attack í…Œì´ë¸” ì¡°íšŒ                            â”‚  â”‚
â”‚  â”‚    - 10ê°œ ê¸°ë²• ìë™ ë§¤í•‘                                             â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 4. í†µê³„ ì§‘ê³„ (ì‹¬ê°ë„/ìƒíƒœ/íƒì§€ìœ í˜•/í˜¸ìŠ¤íŠ¸ë³„)                         â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 5. AI ë¶„ì„ìš© ë°ì´í„° êµ¬ì¡°í™”                                           â”‚  â”‚
â”‚  â”‚    - top_incidents (ìƒìœ„ 10ê°œ)                                       â”‚  â”‚
â”‚  â”‚    - statistics (ì „ì²´ í†µê³„)                                          â”‚  â”‚
â”‚  â”‚    - threat_intelligence (TI ë¶„ì„)                                   â”‚  â”‚
â”‚  â”‚    - mitre_attack (ê¸°ë²• ë¶„ì„)                                        â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ Output: daily_incidents_data_YYYY-MM-DD.json                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  ğŸ¤– AI ë¶„ì„ ì—”ì§„                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ create-ai-analysis-prompt.ts â†’ run-ai-analysis.ts                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 1. í”„ë¡¬í”„íŠ¸ ìƒì„± (9,282ì)                                           â”‚  â”‚
â”‚  â”‚    - ë‚ ì§œ ë° ì „ì²´ ê°œìš”                                               â”‚  â”‚
â”‚  â”‚    - ìƒìœ„ 10ê°œ ì¸ì‹œë˜íŠ¸ ìƒì„¸                                         â”‚  â”‚
â”‚  â”‚    - ì‹¬ê°ë„/ìƒíƒœ/íƒì§€ìœ í˜•/í˜¸ìŠ¤íŠ¸ë³„ í†µê³„                              â”‚  â”‚
â”‚  â”‚    - TI ë¶„ì„ (ìœ„í˜‘ íŒŒì¼ Top 10)                                     â”‚  â”‚
â”‚  â”‚    - MITRE ATT&CK ë¶„ì„ (ê¸°ë²• Top 10)                               â”‚  â”‚
â”‚  â”‚    - ë„¤íŠ¸ì›Œí¬ ìœ„í˜‘ ë¶„ì„ (êµ­ê°€ë³„ Top 10)                              â”‚  â”‚
â”‚  â”‚    - JSON ì‘ë‹µ ìŠ¤í‚¤ë§ˆ í¬í•¨                                           â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 2. AI ë¶„ì„ ì‹¤í–‰ (3ê°€ì§€ ë°©ë²•)                                         â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚  â”‚    â”‚ ë°©ë²• A: claude --print (ìë™) âœ…       â”‚                       â”‚  â”‚
â”‚  â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ cat prompt.txt | claude --print     â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ JSON ìë™ ì¶”ì¶œ ë° ì €ì¥              â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ 60-120ì´ˆ ì†Œìš”                        â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ Cron ìë™í™” ê°€ëŠ¥                     â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ ë¹„ìš©: $0.01-0.05/report             â”‚                       â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚  â”‚    â”‚ ë°©ë²• B: Claude Code ìˆ˜ë™ (ë¬´ë£Œ)        â”‚                       â”‚  â”‚
â”‚  â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ í”„ë¡¬í”„íŠ¸ ë³µì‚¬ â†’ Claude Code ë¶™ì—¬ë„£ê¸°â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ JSON ì‘ë‹µ ìˆ˜ë™ ì €ì¥                  â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ 2-3ë¶„ ì†Œìš” (ìˆ˜ë™ ì‘ì—…)              â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ Cron ë¶ˆê°€                            â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ ë¹„ìš©: $0 (ë¬´ë£Œ)                      â”‚                       â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚  â”‚    â”‚ ë°©ë²• C: Azure OpenAI (ëŒ€ì²´)            â”‚                       â”‚  â”‚
â”‚  â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ Azure OpenAI SDK ì‚¬ìš©               â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ gpt-4o-mini ëª¨ë¸                     â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ 30-60ì´ˆ ì†Œìš”                         â”‚                       â”‚  â”‚
â”‚  â”‚    â”‚ â€¢ ë¹„ìš©: $0.005-0.01/report            â”‚                       â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ Output: ai_analysis_YYYY-MM-DD.json                                 â”‚  â”‚
â”‚  â”‚ - executive_summary                                                  â”‚  â”‚
â”‚  â”‚ - threat_assessment (risk_level, risk_score, key_findings)          â”‚  â”‚
â”‚  â”‚ - incident_analysis (false_positive_rate, patterns)                 â”‚  â”‚
â”‚  â”‚ - threat_intelligence_insights                                       â”‚  â”‚
â”‚  â”‚ - mitre_attack_analysis                                              â”‚  â”‚
â”‚  â”‚ - network_threat_analysis                                            â”‚  â”‚
â”‚  â”‚ - recommendations (immediate/short_term/long_term)                  â”‚  â”‚
â”‚  â”‚ - security_posture_assessment (grade, strengths, weaknesses)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  ğŸ“„ ë³´ê³ ì„œ ìƒì„± ì—”ì§„                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ generate-final-report.ts                                             â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 1. ë°ì´í„° & AI ë¶„ì„ í†µí•©                                             â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 2. HTML ë³´ê³ ì„œ ìƒì„± (Tailwind CSS 4)                                â”‚  â”‚
â”‚  â”‚    - í—¤ë” (ë‚ ì§œ, ìƒì„±ì‹œê°, ë©”íƒ€ë°ì´í„°)                               â”‚  â”‚
â”‚  â”‚    - ìš”ì•½ (ì¸ì‹œë˜íŠ¸ ìˆ˜, ìœ„í—˜ë„, ë“±ê¸‰, ì˜¤íƒë¥ )                        â”‚  â”‚
â”‚  â”‚    - ì¢…í•© ìš”ì•½ (AI executive_summary)                               â”‚  â”‚
â”‚  â”‚    - ì£¼ìš” ë°œê²¬ì‚¬í•­ (AI key_findings)                                â”‚  â”‚
â”‚  â”‚    - í†µê³„ ë¶„ì„ (Chart.js ì°¨íŠ¸ + í…Œì´ë¸”)                             â”‚  â”‚
â”‚  â”‚    - Critical/High ì¸ì‹œë˜íŠ¸ (25ê±´ ìƒì„¸)                             â”‚  â”‚
â”‚  â”‚    - íŒŒì¼ ì•„í‹°íŒ©íŠ¸ ë¶„ì„ (TI ìƒê´€ë¶„ì„ í¬í•¨)                           â”‚  â”‚
â”‚  â”‚    - ë„¤íŠ¸ì›Œí¬ ì•„í‹°íŒ©íŠ¸ ë¶„ì„                                          â”‚  â”‚
â”‚  â”‚    - MITRE ATT&CK ë¶„ì„                                              â”‚  â”‚
â”‚  â”‚    - CVE ì·¨ì•½ì  ë¶„ì„                                                 â”‚  â”‚
â”‚  â”‚    - ê¶Œê³ ì‚¬í•­ (ì¦‰ì‹œ/ë‹¨ê¸°/ì¥ê¸°)                                       â”‚  â”‚
â”‚  â”‚    - ë³´ì•ˆ íƒœì„¸ í‰ê°€ (ë“±ê¸‰, ê°•ì , ì•½ì )                               â”‚  â”‚
â”‚  â”‚    - í‘¸í„° (AI ë¶„ì„ ê¸°ë°˜ í‘œì‹œ)                                        â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 3. Markdown ë³´ê³ ì„œ ìƒì„± (GitHub-flavored)                           â”‚  â”‚
â”‚  â”‚    - ìš”ì•½ + ì£¼ìš” ì„¹ì…˜ë§Œ í¬í•¨                                         â”‚  â”‚
â”‚  â”‚    - ìƒì„¸ ë‚´ìš©ì€ HTML ì°¸ì¡° ì•ˆë‚´                                      â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ 4. JSON ë³´ê³ ì„œ ìƒì„± (êµ¬ì¡°í™”ëœ ì „ì²´ ë°ì´í„°)                           â”‚  â”‚
â”‚  â”‚    - API í†µí•©ìš©                                                      â”‚  â”‚
â”‚  â”‚    - ì¶”ê°€ ë¶„ì„ ê°€ëŠ¥                                                  â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ Output:                                                              â”‚  â”‚
â”‚  â”‚ - daily_report_YYYY-MM-DD.html (99KB, Tailwind CSS)                â”‚  â”‚
â”‚  â”‚ - daily_report_YYYY-MM-DD.md (4.9KB, Markdown)                      â”‚  â”‚
â”‚  â”‚ - daily_report_YYYY-MM-DD.json (14KB, JSON)                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸš€ ì‹¤í–‰ ë°©ë²• ë ˆì´ì–´                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1ï¸âƒ£ ì¸í„°ë™í‹°ë¸Œ ëª¨ë“œ (generate-complete-daily-report.sh)              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ 4ë‹¨ê³„ íŒŒì´í”„ë¼ì¸ ìˆœì°¨ ì‹¤í–‰                                         â”‚  â”‚
â”‚  â”‚ â€¢ claude ëª…ë ¹ì–´ ìë™ ê°ì§€                                            â”‚  â”‚
â”‚  â”‚ â€¢ ì—†ìœ¼ë©´ ì‚¬ìš©ìì—ê²Œ í”„ë¡¬í”„íŠ¸ í‘œì‹œ                                    â”‚  â”‚
â”‚  â”‚ â€¢ ê° ë‹¨ê³„ë³„ ì§„í–‰ ìƒí™© ì¶œë ¥                                           â”‚  â”‚
â”‚  â”‚ â€¢ AI ë¶„ì„ ìš”ì•½ ì¶œë ¥ (jq ì‚¬ìš©)                                       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤:                                                       â”‚  â”‚
â”‚  â”‚ - ë¶„ì„ê°€ê°€ ìˆ˜ë™ìœ¼ë¡œ ë³´ê³ ì„œ ìƒì„±                                      â”‚  â”‚
â”‚  â”‚ - ê°œë°œ ë° í…ŒìŠ¤íŠ¸                                                     â”‚  â”‚
â”‚  â”‚ - AI ë¶„ì„ ê²°ê³¼ ì§ì ‘ í™•ì¸                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2ï¸âƒ£ ìë™í™” ëª¨ë“œ (auto-daily-report.sh) âœ… Cron ê°€ëŠ¥                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ ì™„ì „ ìë™í™” (ì‚¬ìš©ì ì…ë ¥ ë¶ˆí•„ìš”)                                   â”‚  â”‚
â”‚  â”‚ â€¢ AI ë¶„ì„ íŒŒì¼ í•„ìˆ˜ ì²´í¬                                             â”‚  â”‚
â”‚  â”‚ â€¢ ì—ëŸ¬ ë°œìƒ ì‹œ Supabase ì•Œë¦¼ ì „ì†¡                                    â”‚  â”‚
â”‚  â”‚ â€¢ ë¡œê·¸ íŒŒì¼ ìë™ ì €ì¥ (/tmp/auto-daily-report-YYYY-MM-DD.log)      â”‚  â”‚
â”‚  â”‚ â€¢ ë°ì´í„° íŒŒì¼ ìœ íš¨ì„± ê²€ì¦ (jq ì‚¬ìš©)                                 â”‚  â”‚
â”‚  â”‚ â€¢ ì—ëŸ¬ ìƒíƒœ íŒŒì¼ ìƒì„± (/tmp/daily_report_error_YYYY-MM-DD.flag)    â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤:                                                       â”‚  â”‚
â”‚  â”‚ - ë§¤ì¼ ìë™ ë³´ê³ ì„œ ìƒì„± (Cron)                                       â”‚  â”‚
â”‚  â”‚ - CI/CD íŒŒì´í”„ë¼ì¸ í†µí•©                                              â”‚  â”‚
â”‚  â”‚ - ë¬´ì¸ ì„œë²„ í™˜ê²½                                                     â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ Cron ì„¤ì • ì˜ˆì‹œ:                                                      â”‚  â”‚
â”‚  â”‚ 0 8 * * * cd /www/ib-editor/my-app && \                             â”‚  â”‚
â”‚  â”‚   ./script/auto-daily-report.sh >> /var/log/daily-report.log 2>&1  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3ï¸âƒ£ MCP í…œí”Œë¦¿ ëª¨ë“œ (generate-daily-report-mcp.sh)                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ MCP ë„êµ¬ ì‚¬ìš© ì˜ˆì‹œ í‘œì‹œ                                            â”‚  â”‚
â”‚  â”‚ â€¢ í…œí”Œë¦¿ ê¸°ë°˜ ë³´ê³ ì„œ ìƒì„± (ì‹¤ì œ ë°ì´í„° ë¯¸í¬í•¨)                       â”‚  â”‚
â”‚  â”‚ â€¢ MCP ì„œë²„ í•™ìŠµ ë° í…ŒìŠ¤íŠ¸ìš©                                          â”‚  â”‚
â”‚  â”‚ â€¢ ë¹ ë¥¸ ì‹¤í–‰ (ë°ì´í„° ìˆ˜ì§‘ ìƒëµ)                                       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ MCP ë„êµ¬ ì˜ˆì‹œ:                                                       â”‚  â”‚
â”‚  â”‚ - mcp__incident_analysis__get_incident_statistics                    â”‚  â”‚
â”‚  â”‚ - mcp__incident_analysis__create_incident_trend_chart                â”‚  â”‚
â”‚  â”‚ - mcp__incident_analysis__analyze_top_threats                        â”‚  â”‚
â”‚  â”‚ - mcp__incident_analysis__analyze_geographic_distribution            â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤:                                                       â”‚  â”‚
â”‚  â”‚ - MCP ì„œë²„ ê¸°ëŠ¥ í•™ìŠµ                                                 â”‚  â”‚
â”‚  â”‚ - ë³´ê³ ì„œ ë ˆì´ì•„ì›ƒ í”„ë¡œí† íƒ€ì´í•‘                                        â”‚  â”‚
â”‚  â”‚ - ë¹ ë¥¸ í…œí”Œë¦¿ ìƒì„±                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ“¦ ì¶œë ¥ ë ˆì´ì–´                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  public/reports/data/                                                       â”‚
â”‚  â”œâ”€ daily_incidents_data_2025-11-10.json (381KB) - ì›ë³¸ ë°ì´í„°             â”‚
â”‚  â”œâ”€ ai_analysis_prompt_2025-11-10.txt (9.3KB) - AI í”„ë¡¬í”„íŠ¸                â”‚
â”‚  â””â”€ ai_analysis_2025-11-10.json (4.2KB) - AI ë¶„ì„ ê²°ê³¼                     â”‚
â”‚                                                                              â”‚
â”‚  public/reports/daily/                                                      â”‚
â”‚  â”œâ”€ daily_report_2025-11-10.html (99KB) - Tailwind CSS ìŠ¤íƒ€ì¼              â”‚
â”‚  â”œâ”€ daily_report_2025-11-10.md (4.9KB) - Markdown ìš”ì•½                     â”‚
â”‚  â””â”€ daily_report_2025-11-10.json (14KB) - êµ¬ì¡°í™”ëœ JSON                    â”‚
â”‚                                                                              â”‚
â”‚  URL ì ‘ê·¼:                                                                   â”‚
â”‚  http://localhost:40017/reports/daily/daily_report_2025-11-10.html         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë°ì´í„° íë¦„

### Stage 1: ë°ì´í„° ìˆ˜ì§‘ (30ì´ˆ)

```mermaid
graph TB
    A[OpenSearch<br/>opensearch:9200] --> B[collect-daily-incidents-data.ts]
    C[PostgreSQL n8n<br/>postgres:5432] --> B
    D[PostgreSQL TI<br/>Benign Hash Cache] --> B
    E[Local OpenSearch<br/>Vector Search] --> B

    B --> F[Incidents<br/>17ê±´]
    B --> G[Alerts<br/>ì•ŒëŸ¿ ëª©ë¡]
    B --> H[Files<br/>28ê°œ í•´ì‹œ]
    B --> I[Networks<br/>150ê±´ ì—°ê²°]
    B --> J[MITRE<br/>10ê°œ ê¸°ë²•]

    F --> K[daily_incidents_data_2025-11-10.json]
    G --> K
    H --> K
    I --> K
    J --> K

    K --> L[AI ë¶„ì„ìš© ë°ì´í„°<br/>- top_incidents<br/>- statistics<br/>- threat_intelligence<br/>- mitre_attack]
```

**ì£¼ìš” ì²˜ë¦¬**:
1. **ì¸ì‹œë˜íŠ¸ ì¡°íšŒ**: `logs-cortex_xdr-incidents-*` ì¸ë±ìŠ¤ì—ì„œ ë‚ ì§œ í•„í„°ë§
2. **ìƒì„¸ ë°ì´í„° ìˆ˜ì§‘**: ê° ì¸ì‹œë˜íŠ¸ë³„ë¡œ 7ê°œ ì¸ë±ìŠ¤ ì¡°íšŒ
   - incidents, alerts, files, networks, processes, endpoints, causality_chains
3. **TI ìƒê´€ë¶„ì„**:
   - Benign Hash Cache ì´ˆê¸°í™” (PostgreSQL + NSRL 9M hashes)
   - ê° í•´ì‹œ Benign ì²´í¬ â†’ ë²¡í„° ì„œì¹˜ (1.36M vectors)
   - ê²°ê³¼: Benign 24, Threat 0, Unknown 4
4. **MITRE ë§¤í•‘**: PostgreSQL `mitre_attack` í…Œì´ë¸”ì—ì„œ ê¸°ë²• ìƒì„¸ ì •ë³´ ì¡°íšŒ
5. **í†µê³„ ì§‘ê³„**: ì‹¬ê°ë„ë³„, ìƒíƒœë³„, íƒì§€ìœ í˜•ë³„, í˜¸ìŠ¤íŠ¸ë³„

**ì¶œë ¥**: `daily_incidents_data_2025-11-10.json` (381KB)

### Stage 2: í”„ë¡¬í”„íŠ¸ ìƒì„± (1ì´ˆ)

```mermaid
graph LR
    A[daily_incidents_data_2025-11-10.json] --> B[create-ai-analysis-prompt.ts]
    B --> C[êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ ìƒì„±<br/>- ë‚ ì§œ ë° ì „ì²´ ê°œìš”<br/>- ìƒìœ„ 10ê°œ ì¸ì‹œë˜íŠ¸ ìƒì„¸<br/>- í†µê³„ ë¶„ì„<br/>- TI ë¶„ì„<br/>- MITRE ë¶„ì„<br/>- ë„¤íŠ¸ì›Œí¬ ë¶„ì„]
    C --> D[JSON ì‘ë‹µ ìŠ¤í‚¤ë§ˆ í¬í•¨]
    D --> E[ai_analysis_prompt_2025-11-10.txt<br/>9,282ì]
```

**í”„ë¡¬í”„íŠ¸ êµ¬ì¡°**:
```markdown
# ì¼ê°„ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë¶„ì„ ìš”ì²­

ë‹¹ì‹ ì€ ë³´ì•ˆ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì•„ë˜ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ì „ë¬¸ì ì¸ ë³´ì•ˆ íŒë‹¨ì„ ì œê³µí•´ì£¼ì„¸ìš”.

## ë¶„ì„ ë‚ ì§œ
**2025-11-10**

## ì „ì²´ ê°œìš”
- **ì´ ì¸ì‹œë˜íŠ¸**: 17ê±´
- **Critical**: 3ê±´
- **High**: 5ê±´
- **Medium**: 9ê±´
- **Low**: 0ê±´

## ìƒìœ„ ìœ„í˜‘ ì¸ì‹œë˜íŠ¸ (Top 10)
### 1. [CRITICAL] ì¸ì‹œë˜íŠ¸ #888-000527
**ì„¤ëª…**: ...
**ë¶„ì„ê°€ íŒë‹¨**: ...
**íŒŒì¼ ë¶„ì„**: ì´ 2ê°œ, ìœ„í˜‘ 0ê°œ
**ë„¤íŠ¸ì›Œí¬ ë¶„ì„**: ì´ 0ê±´
**MITRE ATT&CK**: T1112 (Modify Registry)
...

## ğŸ¤– ë¶„ì„ ìš”ì²­ì‚¬í•­
ìœ„ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒì„ ë¶„ì„í•˜ê³  **JSON í˜•ì‹**ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:

```json
{
  "executive_summary": "ë‹¹ì¼ ë³´ì•ˆ ìƒí™© ì¢…í•© ìš”ì•½ (2-3ë¬¸ì¥)",
  "threat_assessment": {
    "overall_risk_level": "critical|high|medium|low",
    "risk_score": 0-100,
    "confidence": 0-100,
    "key_findings": [...]
  },
  ...
}
```
```

**ì¶œë ¥**: `ai_analysis_prompt_2025-11-10.txt` (9.3KB)

### Stage 3: AI ë¶„ì„ (60-120ì´ˆ)

#### ë°©ë²• A: claude --print (ìë™) âœ… ê²€ì¦ ì™„ë£Œ

```mermaid
graph TB
    A[ai_analysis_prompt_2025-11-10.txt] --> B{claude ëª…ë ¹ì–´<br/>ì¡´ì¬?}
    B -->|Yes| C[run-ai-analysis.ts]
    C --> D[cat prompt.txt | claude --print]
    D --> E[Claude API í˜¸ì¶œ]
    E --> F[JSON ì‘ë‹µ ìˆ˜ì‹ ]
    F --> G[```json ... ``` ë¸”ë¡ ì¶”ì¶œ]
    G --> H[JSON íŒŒì‹± ê²€ì¦]
    H --> I[ai_analysis_2025-11-10.json<br/>ì €ì¥]

    B -->|No| J[ìˆ˜ë™ ì‹¤í–‰ ê°€ì´ë“œ í‘œì‹œ]
    J --> K[í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì¶œë ¥]
    K --> L[ì‚¬ìš©ì Enter ëŒ€ê¸°]
    L --> M{AI ë¶„ì„ íŒŒì¼<br/>ì¡´ì¬?}
    M -->|Yes| I
    M -->|No| N[ì—ëŸ¬: íŒŒì¼ ì—†ìŒ]
```

**claude --print ë™ì‘ ë©”ì»¤ë‹ˆì¦˜**:

1. **ì…ë ¥**:
   ```bash
   cat public/reports/data/ai_analysis_prompt_2025-11-10.txt | claude --print
   ```

2. **ì²˜ë¦¬**:
   - claude CLIê°€ í‘œì¤€ ì…ë ¥(stdin)ì—ì„œ í”„ë¡¬í”„íŠ¸ ì½ê¸°
   - Anthropic API í˜¸ì¶œ (Claude Sonnet 4.5)
   - ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ìˆ˜ì‹ 

3. **ì¶œë ¥ íŒŒì‹±**:
   ```typescript
   // run-ai-analysis.ts (line 57-70)
   const result = execSync(`cat ${promptFile} | claude --print`, {
     encoding: 'utf-8',
     maxBuffer: 10 * 1024 * 1024, // 10MB
     timeout: 300000, // 5ë¶„
   });

   // ```json ... ``` ë¸”ë¡ì—ì„œ ì¶”ì¶œ
   const jsonMatch = result.match(/```json\s*([\s\S]*?)\s*```/);
   if (jsonMatch) {
     jsonResult = jsonMatch[1];
   }

   // JSON íŒŒì‹± ê²€ì¦
   let parsedResult;
   try {
     parsedResult = JSON.parse(jsonResult);
   } catch (parseError) {
     // íŒŒì‹± ì‹¤íŒ¨ ì‹œ ì›ë³¸ ì‘ë‹µ ì €ì¥
     parsedResult = {
       raw_response: jsonResult,
       parse_error: 'JSON íŒŒì‹± ì‹¤íŒ¨ - ìˆ˜ë™ í™•ì¸ í•„ìš”',
     };
   }
   ```

4. **ì €ì¥**:
   - `public/reports/data/ai_analysis_2025-11-10.json`
   - í•œêµ­ì–´ ì „ë¬¸ ë³´ì•ˆ ë¶„ì„ (executive_summary, threat_assessment, etc.)

**ì‹¤ì œ í…ŒìŠ¤íŠ¸ ê²°ê³¼ (2025-11-10)**:
```json
{
  "executive_summary": "2025-11-10 ì´ 17ê±´ì˜ ì¸ì‹œë˜íŠ¸ ë°œìƒ (Critical 3ê±´, High 5ê±´, Medium 9ê±´). ëŒ€ë¶€ë¶„ì´ False Positive(8ê±´)ë¡œ í™•ì¸ë˜ì—ˆìœ¼ë©°, Local Analysis Malware ì˜¤íƒì´ ì£¼ë¥¼ ì´ë¤˜ìŠµë‹ˆë‹¤. ì‹¤ì œ ìœ„í˜‘ì€ ì œí•œì ì´ë©°, XDR Agentê°€ ëŒ€ë¶€ë¶„ì˜ ì˜ì‹¬ í™œë™ì„ íš¨ê³¼ì ìœ¼ë¡œ ì°¨ë‹¨í–ˆìŠµë‹ˆë‹¤.",
  "threat_assessment": {
    "overall_risk_level": "low",
    "risk_score": 25,
    "confidence": 85,
    "key_findings": [
      "17ê±´ ì¤‘ 8ê±´(47%)ì´ False Positiveë¡œ í™•ì¸ë˜ì–´ ë†’ì€ ì˜¤íƒë¥  ì‹œì‚¬",
      "ì‹¤ì œ ìœ„í˜‘ ì‹œë„ëŠ” XDR Agentì— ì˜í•´ ëª¨ë‘ ì°¨ë‹¨ë˜ì–´ ì¹¨í•´ ì‚¬ê³  ì—†ìŒ",
      "ëŒ€ë¶€ë¶„ì´ ì •ìƒ ì—…ë¬´ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì •ìƒ ë™ì‘ìœ¼ë¡œ í™•ì¸"
    ]
  }
}
```

#### ë°©ë²• B: Claude Code ìˆ˜ë™ (ë¬´ë£Œ)

```mermaid
graph TB
    A[ai_analysis_prompt_2025-11-10.txt] --> B[í”„ë¡¬í”„íŠ¸ ë³µì‚¬]
    B --> C[Claude Code ì›¹/CLIì— ë¶™ì—¬ë„£ê¸°]
    C --> D[Claude Code ë¶„ì„ ìˆ˜í–‰<br/>2-3ë¶„]
    D --> E[JSON ì‘ë‹µ ë°›ê¸°]
    E --> F[JSON ìˆ˜ë™ ì €ì¥]
    F --> G[ai_analysis_2025-11-10.json]
```

**ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€ (2025-11-09)**:
- 125ê±´ ì¸ì‹œë˜íŠ¸ ë¶„ì„
- Claude Codeê°€ ì§ì ‘ Write ë„êµ¬ë¡œ JSON ì‘ì„±
- 161ì¤„ JSON ìƒì„±
- ë¹„ìš©: $0 (ë¬´ë£Œ)

#### ë°©ë²• C: Azure OpenAI (ëŒ€ì²´)

```typescript
import { AzureOpenAI } from 'openai';

const client = new AzureOpenAI({
  apiKey: process.env.AZURE_OPENAI_API_KEY,
  endpoint: process.env.AZURE_OPENAI_ENDPOINT,
  deployment: 'gpt-4o-mini',
});

const response = await client.chat.completions.create({
  messages: [
    { role: 'system', content: 'You are a security analyst expert.' },
    { role: 'user', content: promptText }
  ],
  temperature: 0.3,
  response_format: { type: 'json_object' }
});

const analysis = JSON.parse(response.choices[0].message.content);
```

**ì¶œë ¥**: `ai_analysis_2025-11-10.json` (4.2KB)

### Stage 4: ë³´ê³ ì„œ ìƒì„± (5ì´ˆ)

```mermaid
graph TB
    A[daily_incidents_data_2025-11-10.json] --> D[generate-final-report.ts]
    B[ai_analysis_2025-11-10.json] --> D

    D --> E[HTML ìƒì„±<br/>generateComprehensiveHTML]
    E --> F[Tailwind CSS 4 ìŠ¤íƒ€ì¼]
    F --> G[Chart.js ì°¨íŠ¸]
    G --> H[daily_report_2025-11-10.html<br/>99KB]

    D --> I[Markdown ìƒì„±<br/>generateComprehensiveMarkdown]
    I --> J[GitHub-flavored Markdown]
    J --> K[daily_report_2025-11-10.md<br/>4.9KB]

    D --> L[JSON í†µí•©]
    L --> M[êµ¬ì¡°í™”ëœ ë°ì´í„°]
    M --> N[daily_report_2025-11-10.json<br/>14KB]
```

**HTML ë³´ê³ ì„œ êµ¬ì¡°**:
```html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì¼ê°„ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë³´ê³ ì„œ - 2025-11-10</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* OKLCH ìƒ‰ìƒ íŒ”ë ˆíŠ¸, Dark mode ì§€ì› */
  </style>
</head>
<body class="bg-gray-50">
  <div class="container mx-auto px-4 py-8 max-w-7xl">
    <!-- 1. í—¤ë” -->
    <!-- 2. ìš”ì•½ -->
    <!-- 3. ì¢…í•© ìš”ì•½ (AI) -->
    <!-- 4. ì£¼ìš” ë°œê²¬ì‚¬í•­ (AI) -->
    <!-- 5. í†µê³„ ë¶„ì„ (Chart.js) -->
    <!-- 6. Critical/High ì¸ì‹œë˜íŠ¸ -->
    <!-- 7. íŒŒì¼ ì•„í‹°íŒ©íŠ¸ -->
    <!-- 8. ë„¤íŠ¸ì›Œí¬ ì•„í‹°íŒ©íŠ¸ -->
    <!-- 9. MITRE ATT&CK -->
    <!-- 10. CVE ì·¨ì•½ì  -->
    <!-- 11. ê¶Œê³ ì‚¬í•­ (AI) -->
    <!-- 12. ë³´ì•ˆ íƒœì„¸ í‰ê°€ (AI) -->
    <!-- 13. í‘¸í„° -->
  </div>
</body>
</html>
```

**ì¶œë ¥**:
- `daily_report_2025-11-10.html` (99KB)
- `daily_report_2025-11-10.md` (4.9KB)
- `daily_report_2025-11-10.json` (14KB)

---

## í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ìƒì„¸

### 1. collect-daily-incidents-data.ts

**ìœ„ì¹˜**: `/www/ib-editor/my-app/script/collect-daily-incidents-data.ts`

**ëª©ì **: OpenSearchì™€ PostgreSQLì—ì„œ ì¸ì‹œë˜íŠ¸ ë°ì´í„° ìˆ˜ì§‘ ë° TI ìƒê´€ë¶„ì„

**ì£¼ìš” í•¨ìˆ˜**:

```typescript
// OpenSearch ì¿¼ë¦¬ í—¬í¼
function queryOpenSearch(index: string, query: any): any {
  const curlCmd = `curl -s -u "${OPENSEARCH_USER}:${OPENSEARCH_PASSWORD}" \
    -H "Content-Type: application/json" \
    -X POST "${OPENSEARCH_URL}/${index}/_search" \
    -d '${JSON.stringify(query)}'`;
  const result = execSync(curlCmd, { encoding: 'utf-8', maxBuffer: 50 * 1024 * 1024 });
  return JSON.parse(result);
}

// Benign Hash Cache + Vector Search TI ì¡°íšŒ
async function queryTI(hashes: string[]): Promise<any[]> {
  // 1. Benign Hash Cache ì´ˆê¸°í™”
  const benignCache = getBenignHashCache();
  await benignCache.init();

  // 2. ê° í•´ì‹œ ë¶„ì„
  for (const hash of hashes) {
    // Benign ì²´í¬
    const benignResult = benignCache.isBenignDetailed(hash);
    if (benignResult.isBenign) {
      // Whitelisted
      continue;
    }

    // 3. Vector Searchë¡œ ìœ„í˜‘ ì²´í¬
    const vectorResult = await hybridThreatIntelSearch(hash, {
      iocTopK: 3,
      iocIndices: ['malware'],
    });

    if (vectorResult.internal_results.count > 0) {
      // ìœ„í˜‘ ë°œê²¬
    }
  }
}

// MITRE ATT&CK ì¡°íšŒ
async function queryMitre(techniqueIds: string[]): Promise<any[]> {
  const client = new Client({ /* PostgreSQL config */ });
  await client.connect();

  const query = `
    SELECT * FROM mitre_attack
    WHERE technique_id = ANY($1)
  `;
  const result = await client.query(query, [techniqueIds]);

  await client.end();
  return result.rows;
}
```

**ì²˜ë¦¬ íë¦„**:
1. ë‚ ì§œ ë²”ìœ„ ê³„ì‚° (KST â†’ UTC ë³€í™˜)
2. OpenSearchì—ì„œ ì¸ì‹œë˜íŠ¸ ì¡°íšŒ
3. ê° ì¸ì‹œë˜íŠ¸ë³„ ìƒì„¸ ë°ì´í„° ìˆ˜ì§‘ (7ê°œ ì¸ë±ìŠ¤)
4. TI ìƒê´€ë¶„ì„ (Benign Cache + Vector Search)
5. MITRE ATT&CK ë§¤í•‘
6. í†µê³„ ì§‘ê³„
7. AI ë¶„ì„ìš© ë°ì´í„° êµ¬ì¡°í™”
8. JSON ì €ì¥

**ì¶œë ¥ êµ¬ì¡°**:
```json
{
  "report_date": "2025-11-10",
  "generated_at": "2025-11-11T...",
  "total_incidents": 17,
  "collected_data": {
    "incidents": [ /* 17ê°œ ì¸ì‹œë˜íŠ¸ */ ]
  },
  "ai_analysis_data": {
    "summary": {
      "total_incidents": 17,
      "critical_count": 3,
      "high_count": 5,
      "medium_count": 9,
      "low_count": 0
    },
    "top_incidents": [ /* ìƒìœ„ 10ê°œ */ ],
    "statistics": { /* í†µê³„ */ },
    "threat_intelligence": { /* TI ë¶„ì„ */ },
    "mitre_attack": { /* MITRE ê¸°ë²• */ }
  }
}
```

### 2. create-ai-analysis-prompt.ts

**ìœ„ì¹˜**: `/www/ib-editor/my-app/script/create-ai-analysis-prompt.ts`

**ëª©ì **: ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ AIê°€ ë¶„ì„í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ë¡œ ë³€í™˜

**í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿**:

```typescript
const prompt = `# ì¼ê°„ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë¶„ì„ ìš”ì²­

ë‹¹ì‹ ì€ ë³´ì•ˆ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì•„ë˜ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ì „ë¬¸ì ì¸ ë³´ì•ˆ íŒë‹¨ì„ ì œê³µí•´ì£¼ì„¸ìš”.

## ë¶„ì„ ë‚ ì§œ
**${reportDate}**

## ì „ì²´ ê°œìš”
- **ì´ ì¸ì‹œë˜íŠ¸**: ${aiData.summary.total_incidents}ê±´
- **Critical**: ${aiData.summary.critical_count}ê±´
- **High**: ${aiData.summary.high_count}ê±´
- **Medium**: ${aiData.summary.medium_count}ê±´
- **Low**: ${aiData.summary.low_count}ê±´

## ìƒìœ„ ìœ„í˜‘ ì¸ì‹œë˜íŠ¸ (Top 10)
${aiData.top_incidents.map((inc, idx) => `
### ${idx + 1}. [${inc.severity.toUpperCase()}] ì¸ì‹œë˜íŠ¸ #${inc.incident_id}

**ì„¤ëª…**: ${inc.description}
**ë¶„ì„ê°€ íŒë‹¨**: ${inc.resolve_comment || 'ì—†ìŒ'}

**íŒŒì¼ ë¶„ì„**:
- ì´ íŒŒì¼: ${inc.files_summary.total}ê°œ
- ìœ„í˜‘ íŒŒì¼: ${inc.files_summary.threat_count}ê°œ
- íŒŒì¼ ìœ í˜•: ${inc.files_summary.file_types.join(', ') || 'N/A'}

**ë„¤íŠ¸ì›Œí¬ ë¶„ì„**:
- ì´ ì—°ê²°: ${inc.network_summary.total}ê±´
- ê³ ìœ  IP: ${inc.network_summary.unique_ips.length}ê°œ
- ê³ ìœ  ë„ë©”ì¸: ${inc.network_summary.unique_domains.length}ê°œ
- êµ­ê°€: ${inc.network_summary.countries.join(', ') || 'N/A'}

**MITRE ATT&CK**:
- ê¸°ë²•: ${inc.mitre_techniques.join(', ') || 'ì—†ìŒ'}
- ì „ìˆ : ${inc.mitre_tactics.join(', ') || 'ì—†ìŒ'}

**ì—”ë“œí¬ì¸íŠ¸ CVE**: ${inc.endpoint_cves.slice(0, 5).join(', ') || 'ì—†ìŒ'}
**ì•ŒëŸ¿ ìˆ˜**: ${inc.alerts_count}ê°œ
`).join('\n---\n')}

## í†µê³„ ë¶„ì„

### ì‹¬ê°ë„ë³„ ë¶„í¬
${Object.entries(aiData.statistics.by_severity).map(([severity, count]) =>
  `- **${severity}**: ${count}ê±´`
).join('\n')}

### ìƒíƒœë³„ ë¶„í¬
${Object.entries(aiData.statistics.by_status).map(([status, count]) =>
  `- **${status}**: ${count}ê±´`
).join('\n')}

### ì£¼ìš” íƒì§€ ìœ í˜• (Top 10)
${Object.entries(aiData.statistics.by_detection_type)
  .sort(([, a], [, b]) => b - a)
  .slice(0, 10)
  .map(([type, count], idx) => `${idx + 1}. **${type}**: ${count}ê±´`)
  .join('\n')}

### ì£¼ìš” í˜¸ìŠ¤íŠ¸ (Top 10)
${Object.entries(aiData.statistics.by_host)
  .sort(([, a], [, b]) => b - a)
  .slice(0, 10)
  .map(([host, count], idx) => `${idx + 1}. **${host}**: ${count}ê±´`)
  .join('\n')}

## ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤ ë¶„ì„
- **ë¶„ì„ëœ í•´ì‹œ**: ${aiData.threat_intelligence.total_hashes_analyzed}ê°œ
- **ìœ„í˜‘ íŒŒì¼**: ${aiData.threat_intelligence.threat_files.length}ê°œ
- **ì˜ì‹¬ íŒŒì¼**: ${aiData.threat_intelligence.suspicious_files.length}ê°œ

### ìœ„í˜‘ íŒŒì¼ ìƒì„¸ (Top 10)
${aiData.threat_intelligence.threat_files.slice(0, 10).map((file, idx) => `
${idx + 1}. **${file.file_name || 'Unknown'}**
   - Hash: \`${file.hash.substring(0, 16)}...\`
   - ìœ„í˜‘ ë ˆë²¨: ${file.threat_level}
   - ë¶„ë¥˜: ${file.classification}
   - ì¶œì²˜: ${file.threat_intel_sources?.join(', ') || 'Unknown'}
`).join('\n')}

## MITRE ATT&CK ë¶„ì„
### íƒì§€ëœ ê¸°ë²• ìˆ˜
- **ì´ ${aiData.mitre_attack.techniques.length}ê°œ ê¸°ë²•**

### ì „ìˆ ë³„ ë¶„í¬
${Object.entries(aiData.mitre_attack.tactics_distribution)
  .sort(([, a], [, b]) => b - a)
  .map(([tactic, count], idx) => `${idx + 1}. **${tactic}**: ${count}ê±´`)
  .join('\n')}

### ì£¼ìš” ê¸°ë²• (Top 10)
${aiData.mitre_attack.techniques.slice(0, 10).map((tech, idx) => `
${idx + 1}. **${tech.technique_id}: ${tech.technique_name}**
   - ì „ìˆ : ${tech.tactic}
   - ì„¤ëª…: ${(tech.description || '').substring(0, 100)}...
`).join('\n')}

## ë„¤íŠ¸ì›Œí¬ ìœ„í˜‘ ë¶„ì„
- **ì´ ì—°ê²°**: ${aiData.statistics.network.total_connections}ê±´
- **ê³ ìœ  IP**: ${aiData.statistics.network.unique_ips.size}ê°œ
- **ê³ ìœ  ë„ë©”ì¸**: ${aiData.statistics.network.unique_domains.size}ê°œ

### êµ­ê°€ë³„ ë¶„í¬ (Top 10)
${Object.entries(aiData.statistics.network.countries)
  .sort(([, a], [, b]) => b - a)
  .slice(0, 10)
  .map(([country, count], idx) => `${idx + 1}. **${country}**: ${count}ê±´`)
  .join('\n')}

---

## ğŸ¤– ë¶„ì„ ìš”ì²­ì‚¬í•­

ìœ„ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒì„ ë¶„ì„í•˜ê³  **JSON í˜•ì‹**ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:

\`\`\`json
{
  "executive_summary": "ë‹¹ì¼ ë³´ì•ˆ ìƒí™© ì¢…í•© ìš”ì•½ (2-3ë¬¸ì¥)",

  "threat_assessment": {
    "overall_risk_level": "critical|high|medium|low",
    "risk_score": 0-100,
    "confidence": 0-100,
    "key_findings": [
      "ì£¼ìš” ë°œê²¬ì‚¬í•­ 1",
      "ì£¼ìš” ë°œê²¬ì‚¬í•­ 2",
      "ì£¼ìš” ë°œê²¬ì‚¬í•­ 3"
    ]
  },

  "incident_analysis": {
    "critical_incidents_summary": "Critical/High ì¸ì‹œë˜íŠ¸ ë¶„ì„",
    "false_positive_rate": "ì˜¤íƒë¥  ì¶”ì • (%)",
    "true_threats_count": "ì‹¤ì œ ìœ„í˜‘ìœ¼ë¡œ íŒë‹¨ë˜ëŠ” ê±´ìˆ˜",
    "patterns_detected": [
      "íƒì§€ëœ íŒ¨í„´ 1",
      "íƒì§€ëœ íŒ¨í„´ 2"
    ]
  },

  "threat_intelligence_insights": {
    "malware_families": ["ë°œê²¬ëœ ë©€ì›¨ì–´ íŒ¨ë°€ë¦¬"],
    "attack_vectors": ["ê³µê²© ë²¡í„°"],
    "threat_actors": ["ìœ„í˜‘ í–‰ìœ„ì (ì¶”ì •)"],
    "ioc_summary": "IOC ìš”ì•½"
  },

  "mitre_attack_analysis": {
    "primary_tactics": ["ì£¼ìš” ì „ìˆ  Top 3"],
    "primary_techniques": ["ì£¼ìš” ê¸°ë²• Top 5"],
    "attack_chain_analysis": "ê³µê²© ì²´ì¸ ë¶„ì„",
    "defense_gaps": ["ë°œê²¬ëœ ë°©ì–´ ê³µë°±"]
  },

  "network_threat_analysis": {
    "suspicious_countries": ["ì˜ì‹¬ìŠ¤ëŸ¬ìš´ êµ­ê°€"],
    "c2_indicators": ["C&C ì„œë²„ ì§•í›„"],
    "data_exfiltration_risk": "ë°ì´í„° ìœ ì¶œ ìœ„í—˜ë„",
    "lateral_movement": "ë‚´ë¶€ ì´ë™ ì§•í›„"
  },

  "recommendations": {
    "immediate_actions": [
      "ì¦‰ì‹œ ì¡°ì¹˜ì‚¬í•­ 1",
      "ì¦‰ì‹œ ì¡°ì¹˜ì‚¬í•­ 2"
    ],
    "short_term": [
      "ë‹¨ê¸° ê°œì„ ì‚¬í•­ 1",
      "ë‹¨ê¸° ê°œì„ ì‚¬í•­ 2"
    ],
    "long_term": [
      "ì¤‘ì¥ê¸° ê°œì„ ì‚¬í•­ 1",
      "ì¤‘ì¥ê¸° ê°œì„ ì‚¬í•­ 2"
    ]
  },

  "trending_analysis": {
    "increasing_threats": ["ì¦ê°€ ì¶”ì„¸ ìœ„í˜‘"],
    "decreasing_threats": ["ê°ì†Œ ì¶”ì„¸ ìœ„í˜‘"],
    "new_attack_patterns": ["ìƒˆë¡œìš´ ê³µê²© íŒ¨í„´"],
    "comparison_notes": "ì „ì¼/ì „ì£¼ ëŒ€ë¹„ ë¹„êµ ì˜ê²¬"
  },

  "security_posture_assessment": {
    "strengths": ["ê°•ì "],
    "weaknesses": ["ì•½ì "],
    "overall_grade": "A|B|C|D|F",
    "improvement_priority": ["ê°œì„  ìš°ì„ ìˆœìœ„"]
  }
}
\`\`\`

**ì¤‘ìš”**: ë°˜ë“œì‹œ ìœ„ JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”. ì¶”ê°€ ì„¤ëª…ì€ JSON ë‚´ë¶€ í•„ë“œì— í¬í•¨ì‹œì¼œì£¼ì„¸ìš”.
`;
```

**ì €ì¥**: `public/reports/data/ai_analysis_prompt_YYYY-MM-DD.txt`

### 3. run-ai-analysis.ts

**ìœ„ì¹˜**: `/www/ib-editor/my-app/script/run-ai-analysis.ts`

**ëª©ì **: claude --print ëª…ë ¹ì–´ë¡œ AI ë¶„ì„ ìë™ ì‹¤í–‰

**í•µì‹¬ ë¡œì§**:

```typescript
// 1. claude ëª…ë ¹ì–´ í™•ì¸
let claudeAvailable = false;
try {
  execSync('which claude', { encoding: 'utf-8' });
  claudeAvailable = true;
  console.log('âœ… claude ëª…ë ¹ì–´ ì‚¬ìš© ê°€ëŠ¥');
} catch (error) {
  console.log('âš ï¸  claude ëª…ë ¹ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
}

if (claudeAvailable) {
  console.log('ğŸ¤– Claude AI ë¶„ì„ ì‹¤í–‰ ì¤‘...');
  console.log('   (ì´ ì‘ì—…ì€ 1-2ë¶„ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤)');

  try {
    // 2. claude --print ì‹¤í–‰
    const result = execSync(`cat ${promptFile} | claude --print`, {
      encoding: 'utf-8',
      maxBuffer: 10 * 1024 * 1024, // 10MB
      timeout: 300000, // 5ë¶„
    });

    // 3. JSON ì‘ë‹µ ì¶”ì¶œ
    let jsonResult = result;

    // ```json ... ``` ë¸”ë¡ì—ì„œ ì¶”ì¶œ
    const jsonMatch = result.match(/```json\s*([\s\S]*?)\s*```/);
    if (jsonMatch) {
      jsonResult = jsonMatch[1];
    }

    // 4. JSON íŒŒì‹± ê²€ì¦
    let parsedResult;
    try {
      parsedResult = JSON.parse(jsonResult);
    } catch (parseError) {
      console.log('âš ï¸  JSON íŒŒì‹± ì‹¤íŒ¨, ì›ë³¸ ì‘ë‹µ ì €ì¥');
      parsedResult = {
        raw_response: jsonResult,
        parse_error: 'JSON íŒŒì‹± ì‹¤íŒ¨ - ìˆ˜ë™ í™•ì¸ í•„ìš”',
      };
    }

    // 5. ê²°ê³¼ ì €ì¥
    const outputFile = `public/reports/data/ai_analysis_${reportDate}.json`;
    writeFileSync(outputFile, JSON.stringify(parsedResult, null, 2));

    console.log('');
    console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    console.log('âœ… AI ë¶„ì„ ì™„ë£Œ!');
    console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    console.log('');
    console.log(`ğŸ“ ë¶„ì„ ê²°ê³¼: ${outputFile}`);

  } catch (error: any) {
    console.error('âŒ AI ë¶„ì„ ì‹¤í–‰ ì‹¤íŒ¨');
    console.error(error.message);
    process.exit(1);
  }
} else {
  // claude ëª…ë ¹ì–´ê°€ ì—†ëŠ” ê²½ìš° - ìˆ˜ë™ ì‹¤í–‰ ê°€ì´ë“œ
  console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
  console.log('âš ï¸  ìˆ˜ë™ ë¶„ì„ í•„ìš”');
  console.log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
  console.log('');
  console.log('ğŸ“‹ ë°©ë²• 1: claude ëª…ë ¹ì–´ ì„¤ì¹˜');
  console.log('  npm install -g @anthropic-ai/claude-cli');
  console.log('');
  console.log('ğŸ“‹ ë°©ë²• 2: ìˆ˜ë™ìœ¼ë¡œ í”„ë¡¬í”„íŠ¸ ì‹¤í–‰');
  console.log(`  cat ${promptFile} | claude --print > public/reports/data/ai_analysis_${reportDate}.json`);
  console.log('');
  console.log('ğŸ“‹ ë°©ë²• 3: Claude Codeì—ì„œ ì§ì ‘ ì‹¤í–‰');
  console.log('  1. ì•„ë˜ í”„ë¡¬í”„íŠ¸ë¥¼ ë³µì‚¬');
  console.log('  2. Claude Codeì— ë¶™ì—¬ë„£ê¸°');
  console.log('  3. JSON ì‘ë‹µì„ ë³µì‚¬í•˜ì—¬ íŒŒì¼ë¡œ ì €ì¥');
  console.log('');

  // í”„ë¡¬í”„íŠ¸ ì¶œë ¥
  const prompt = readFileSync(promptFile, 'utf-8');
  console.log(prompt);
}
```

**ì €ì¥**: `public/reports/data/ai_analysis_YYYY-MM-DD.json`

### 4. generate-final-report.ts

**ìœ„ì¹˜**: `/www/ib-editor/my-app/script/generate-final-report.ts`

**ëª©ì **: ë°ì´í„° + AI ë¶„ì„ì„ í†µí•©í•˜ì—¬ HTML/MD/JSON ë³´ê³ ì„œ ìƒì„±

**í•µì‹¬ í•¨ìˆ˜**:

```typescript
// HTML ë³´ê³ ì„œ ìƒì„±
function generateComprehensiveHTML(
  reportDate: string,
  data: any,
  aiAnalysis: any
): string {
  return `
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì¼ê°„ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë³´ê³ ì„œ - ${reportDate}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* OKLCH ìƒ‰ìƒ íŒ”ë ˆíŠ¸ */
    /* Dark mode ì§€ì› */
  </style>
</head>
<body class="bg-gray-50">
  <div class="container mx-auto px-4 py-8 max-w-7xl">
    ${generateHeader(reportDate, data, aiAnalysis)}
    ${generateSummary(data, aiAnalysis)}
    ${generateExecutiveSummary(aiAnalysis)}
    ${generateKeyFindings(aiAnalysis)}
    ${generateStatistics(data)}
    ${generateCriticalHighIncidents(data)}
    ${generateFileArtifacts(data)}
    ${generateNetworkArtifacts(data)}
    ${generateMitreAnalysis(data, aiAnalysis)}
    ${generateCVEAnalysis(data)}
    ${generateRecommendations(aiAnalysis)}
    ${generateSecurityPosture(aiAnalysis)}
    ${generateFooter()}
  </div>
</body>
</html>
  `;
}

// Markdown ë³´ê³ ì„œ ìƒì„±
function generateComprehensiveMarkdown(
  reportDate: string,
  data: any,
  aiAnalysis: any
): string {
  return `# ì¼ê°„ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë³´ê³ ì„œ

**ë‚ ì§œ**: ${reportDate}
**ìƒì„± ì‹œê°**: ${new Date().toLocaleString('ko-KR')}

---

## ğŸ“Š ìš”ì•½

- **ì´ ì¸ì‹œë˜íŠ¸**: ${data.ai_analysis_data.summary.total_incidents}ê±´
- **ìœ„í—˜ë„**: ${aiAnalysis.threat_assessment.overall_risk_level.toUpperCase()} (${aiAnalysis.threat_assessment.risk_score}/100)
- **ë³´ì•ˆ ë“±ê¸‰**: ${aiAnalysis.security_posture_assessment.overall_grade}
- **ì˜¤íƒë¥ **: ${aiAnalysis.incident_analysis.false_positive_rate}

---

## ğŸ“‹ ì¢…í•© ìš”ì•½

${aiAnalysis.executive_summary}

---

## ğŸ” ì£¼ìš” ë°œê²¬ì‚¬í•­

${aiAnalysis.threat_assessment.key_findings.map((finding, idx) => `${idx + 1}. ${finding}`).join('\n')}

---

## ğŸ“Š í†µê³„ ë¶„ì„

### ì‹¬ê°ë„ë³„ ë¶„í¬

${Object.entries(data.ai_analysis_data.statistics.by_severity)
  .map(([severity, count]) => `- **${severity}**: ${count}ê±´`)
  .join('\n')}

### ìƒíƒœë³„ ë¶„í¬

${Object.entries(data.ai_analysis_data.statistics.by_status)
  .map(([status, count]) => `- **${status}**: ${count}ê±´`)
  .join('\n')}

---

## âš ï¸ Critical/High ì¸ì‹œë˜íŠ¸

${data.ai_analysis_data.top_incidents
  .filter(inc => ['critical', 'high'].includes(inc.severity))
  .slice(0, 25)
  .map((inc, idx) => `
### ${idx + 1}. [${inc.severity.toUpperCase()}] #${inc.incident_id}

**ì„¤ëª…**: ${inc.description}

**ë¶„ì„ê°€ íŒë‹¨**: ${inc.resolve_comment || 'N/A'}

**í†µê³„**:
- ì•ŒëŸ¿: ${inc.alerts_count}ê°œ
- íŒŒì¼: ${inc.files_summary.total}ê°œ
- ë„¤íŠ¸ì›Œí¬: ${inc.network_summary.total}ê±´
`)
  .join('\n---\n')}

---

ìƒì„¸ ë‚´ìš©ì€ HTML ë³´ê³ ì„œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

---

**ğŸ¤– AI ë¶„ì„ ê¸°ë°˜ ì¼ê°„ ë³´ì•ˆ ë³´ê³ ì„œ**
`;
}
```

**ì €ì¥**:
- `public/reports/daily/daily_report_YYYY-MM-DD.html`
- `public/reports/daily/daily_report_YYYY-MM-DD.md`
- `public/reports/daily/daily_report_YYYY-MM-DD.json`

---

## ìë™í™” vs ìˆ˜ë™ í”„ë¡œì„¸ìŠ¤

### ë¹„êµí‘œ

| í•­ëª© | ìë™í™” (claude --print) | ìˆ˜ë™ (Claude Code) |
|------|------------------------|--------------------|
| **ì‹¤í–‰ ë°©ë²•** | `./script/generate-complete-daily-report.sh` | ë‹¨ê³„ë³„ ìˆ˜ë™ ì‹¤í–‰ |
| **claude CLI í•„ìš”** | âœ… í•„ìˆ˜ | âŒ ë¶ˆí•„ìš” |
| **ë°ì´í„° ìˆ˜ì§‘** | ìë™ (30ì´ˆ) | ìë™ (30ì´ˆ) |
| **í”„ë¡¬í”„íŠ¸ ìƒì„±** | ìë™ (1ì´ˆ) | ìë™ (1ì´ˆ) |
| **AI ë¶„ì„** | ìë™ (60-120ì´ˆ) | ìˆ˜ë™ (2-3ë¶„) |
| **ë³´ê³ ì„œ ìƒì„±** | ìë™ (5ì´ˆ) | ìë™ (5ì´ˆ) |
| **ì´ ì†Œìš” ì‹œê°„** | 2-3ë¶„ | 5ë¶„ (ìˆ˜ë™ ì‘ì—… í¬í•¨) |
| **ì‚¬ìš©ì ê°œì…** | ì—†ìŒ | AI ë¶„ì„ ë‹¨ê³„ì—ì„œ í•„ìš” |
| **Cron ìë™í™”** | âœ… ê°€ëŠ¥ | âŒ ë¶ˆê°€ |
| **ë¹„ìš©** | $0.01-0.05/report | $0 (ë¬´ë£Œ) |
| **í’ˆì§ˆ** | â­â­â­â­â­ (Claude Sonnet 4.5) | â­â­â­â­â­ (Claude Sonnet 4.5) |
| **ì—ëŸ¬ ì²˜ë¦¬** | Supabase ì•Œë¦¼ | ìˆ˜ë™ í™•ì¸ |
| **ë¡œê·¸** | ìë™ ì €ì¥ | í™”ë©´ ì¶œë ¥ |

### ìë™í™” í”„ë¡œì„¸ìŠ¤ (ê¶Œì¥)

```bash
# í•œ ì¤„ë¡œ ì™„ì „ ìë™í™”
./script/generate-complete-daily-report.sh 2025-11-10

# ì‹¤í–‰ ê³¼ì • (2-3ë¶„)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£ ë°ì´í„° ìˆ˜ì§‘ (30ì´ˆ)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ OpenSearch ì¸ì‹œë˜íŠ¸ ì¡°íšŒ                  â”‚
â”‚ â€¢ ìƒì„¸ ë°ì´í„° ìˆ˜ì§‘ (7ê°œ ì¸ë±ìŠ¤)              â”‚
â”‚ â€¢ TI ìƒê´€ë¶„ì„                                â”‚
â”‚ â€¢ MITRE ë§¤í•‘                                 â”‚
â”‚ â€¢ í†µê³„ ì§‘ê³„                                  â”‚
â”‚ âœ… daily_incidents_data_2025-11-10.json     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£ í”„ë¡¬í”„íŠ¸ ìƒì„± (1ì´ˆ)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ ìƒì„±                    â”‚
â”‚ â€¢ JSON ì‘ë‹µ ìŠ¤í‚¤ë§ˆ í¬í•¨                     â”‚
â”‚ âœ… ai_analysis_prompt_2025-11-10.txt        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£ AI ë¶„ì„ (60-120ì´ˆ) â† claude --print ìë™â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ cat prompt.txt | claude --print           â”‚
â”‚ â€¢ JSON ìë™ ì¶”ì¶œ ë° ê²€ì¦                    â”‚
â”‚ â€¢ í•œêµ­ì–´ ì „ë¬¸ ë³´ì•ˆ ë¶„ì„                     â”‚
â”‚ âœ… ai_analysis_2025-11-10.json              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ï¸âƒ£ ë³´ê³ ì„œ ìƒì„± (5ì´ˆ)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ HTML (Tailwind CSS)                       â”‚
â”‚ â€¢ Markdown (GitHub-flavored)                â”‚
â”‚ â€¢ JSON (êµ¬ì¡°í™”ëœ ë°ì´í„°)                    â”‚
â”‚ âœ… daily_report_2025-11-10.html (99KB)      â”‚
â”‚ âœ… daily_report_2025-11-10.md (4.9KB)       â”‚
â”‚ âœ… daily_report_2025-11-10.json (14KB)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìˆ˜ë™ í”„ë¡œì„¸ìŠ¤ (ë¬´ë£Œ)

```bash
# 1. ë°ì´í„° ìˆ˜ì§‘
npx tsx script/collect-daily-incidents-data.ts 2025-11-10

# 2. í”„ë¡¬í”„íŠ¸ ìƒì„±
npx tsx script/create-ai-analysis-prompt.ts 2025-11-10

# 3. í”„ë¡¬í”„íŠ¸ ë³µì‚¬
cat public/reports/data/ai_analysis_prompt_2025-11-10.txt

# 4. Claude Codeì— ë¶™ì—¬ë„£ê¸°
# (ì›¹ ë¸Œë¼ìš°ì € ë˜ëŠ” CLIì—ì„œ)

# 5. JSON ì‘ë‹µ ì €ì¥
# public/reports/data/ai_analysis_2025-11-10.json

# 6. ë³´ê³ ì„œ ìƒì„±
npx tsx script/generate-final-report.ts 2025-11-10
```

---

## Claude --print ë©”ì»¤ë‹ˆì¦˜

### ì„¤ì¹˜ ë° ì„¤ì •

```bash
# 1. claude CLI ì„¤ì¹˜
npm install -g @anthropic-ai/claude-cli

# 2. ì„¤ì •
claude configure
# API í‚¤ ì…ë ¥: sk-ant-...

# 3. ë²„ì „ í™•ì¸
claude --version
# 2.0.36 (Claude Code)

# 4. ì„¤ì¹˜ í™•ì¸
which claude
# /home/ubuntu/.nvm/versions/node/v22.16.0/bin/claude
```

### ë™ì‘ ì›ë¦¬

```mermaid
sequenceDiagram
    participant Script as run-ai-analysis.ts
    participant Shell as Bash Shell
    participant CLI as claude CLI
    participant API as Anthropic API
    participant File as JSON File

    Script->>Shell: execSync("cat prompt.txt | claude --print")
    Shell->>CLI: í”„ë¡¬í”„íŠ¸ ì „ë‹¬ (stdin)
    CLI->>API: HTTP POST /v1/messages
    Note over API: Claude Sonnet 4.5<br/>ë¶„ì„ ìˆ˜í–‰ (60-120ì´ˆ)
    API-->>CLI: ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ (JSON í¬í•¨)
    CLI-->>Shell: stdout ì¶œë ¥
    Shell-->>Script: result (ë¬¸ìì—´)
    Script->>Script: JSON ì¶”ì¶œ (```json ... ```)
    Script->>Script: JSON íŒŒì‹± ê²€ì¦
    Script->>File: writeFileSync(ai_analysis.json)
```

### ì‹¤ì œ ë™ì‘ (2025-11-10 ê²€ì¦)

**ì…ë ¥**:
```bash
cat public/reports/data/ai_analysis_prompt_2025-11-10.txt | claude --print
```

**í”„ë¡¬í”„íŠ¸ í¬ê¸°**: 9,282ì (9.3KB)

**API í˜¸ì¶œ**:
- ëª¨ë¸: Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)
- ì˜¨ë„: 0.3 (ì¼ê´€ì„± ìš°ì„ )
- Max tokens: 4096

**ì‘ë‹µ ì‹œê°„**: 60-120ì´ˆ

**ì¶œë ¥**:
```json
{
  "executive_summary": "2025-11-10 ì´ 17ê±´ì˜ ì¸ì‹œë˜íŠ¸ ë°œìƒ (Critical 3ê±´, High 5ê±´, Medium 9ê±´). ëŒ€ë¶€ë¶„ì´ False Positive(8ê±´)ë¡œ í™•ì¸ë˜ì—ˆìœ¼ë©°, Local Analysis Malware ì˜¤íƒì´ ì£¼ë¥¼ ì´ë¤˜ìŠµë‹ˆë‹¤. ì‹¤ì œ ìœ„í˜‘ì€ ì œí•œì ì´ë©°, XDR Agentê°€ ëŒ€ë¶€ë¶„ì˜ ì˜ì‹¬ í™œë™ì„ íš¨ê³¼ì ìœ¼ë¡œ ì°¨ë‹¨í–ˆìŠµë‹ˆë‹¤.",
  "threat_assessment": {
    "overall_risk_level": "low",
    "risk_score": 25,
    "confidence": 85,
    "key_findings": [
      "17ê±´ ì¤‘ 8ê±´(47%)ì´ False Positiveë¡œ í™•ì¸ë˜ì–´ ë†’ì€ ì˜¤íƒë¥  ì‹œì‚¬",
      "ì‹¤ì œ ìœ„í˜‘ ì‹œë„ëŠ” XDR Agentì— ì˜í•´ ëª¨ë‘ ì°¨ë‹¨ë˜ì–´ ì¹¨í•´ ì‚¬ê³  ì—†ìŒ",
      "ëŒ€ë¶€ë¶„ì´ ì •ìƒ ì—…ë¬´ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì •ìƒ ë™ì‘ìœ¼ë¡œ í™•ì¸"
    ]
  },
  "incident_analysis": {
    "critical_incidents_summary": "Critical/High ì´ 8ê±´ ì¤‘ ëŒ€ë¶€ë¶„ì´ ì •ìƒ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ë¡œ í™•ì¸. #888-000522ì˜ ì¸ì½”ë”©ëœ PowerShell ëª…ë ¹ì´ ìœ ì¼í•œ ì‹¤ì œ ìœ„í˜‘ ì‹œë„ì˜€ìœ¼ë‚˜ Agentê°€ ì°¨ë‹¨. beahh[.]com ë„ë©”ì¸ í†µì‹  ì‹œë„ê°€ í™•ì¸ë˜ì—ˆìœ¼ë‚˜ ë°©ì–´ ì„±ê³µ.",
    "false_positive_rate": "47% (8/17ê±´)",
    "true_threats_count": "1ê±´ (ì‹¤ì œ ì°¨ë‹¨ëœ ê³µê²©)",
    "patterns_detected": [
      "Local Analysis Malware ì˜¤íƒ íŒ¨í„´ ë°˜ë³µ (5ê±´ ì´ìƒ)",
      "WPS Office ì—…ë°ì´íŠ¸ í”„ë¡œì„¸ìŠ¤ì˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìˆ˜ì •ì´ íƒì§€ íŠ¸ë¦¬ê±°",
      "ì •ìƒ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ Native API í˜¸ì¶œ ë° Process Injection ì˜¤íƒ",
      "ìŠ¤ì¼€ì¤„ ì‘ì—… í†µí•œ ì¸ì½”ë”© PowerShell ì•…ìš© ì‹œë„ (ì°¨ë‹¨ë¨)"
    ]
  },
  "threat_intelligence_insights": {
    "malware_families": [
      "ì•Œë ¤ì§„ ë©€ì›¨ì–´ íŒ¨ë°€ë¦¬ ì—†ìŒ - WildFire ë¶„ì„ ê²°ê³¼ ëª¨ë‘ Benign"
    ],
    "attack_vectors": [
      "Scheduled Taskë¥¼ í†µí•œ ì¸ì½”ë”© PowerShell ì‹¤í–‰",
      "C&C í†µì‹  ì‹œë„ (beahh[.]com)"
    ],
    "threat_actors": [
      "ë¯¸ì‹ë³„ - ìë™í™”ëœ ê³µê²© ì‹œë„ë¡œ ì¶”ì •"
    ],
    "ioc_summary": "ë¶„ì„ëœ í•´ì‹œ 28ê°œ ì¤‘ ìœ„í˜‘ íŒŒì¼ 0ê±´. ë„¤íŠ¸ì›Œí¬ IOC: beahh[.]com ë„ë©”ì¸ ì°¨ë‹¨ í™•ì¸. ì´ 150ê±´ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì¤‘ ì˜ì‹¬ í™œë™ ìµœì†Œ."
  },
  "mitre_attack_analysis": {
    "primary_tactics": [
      "TA0002 - Execution (ê°€ì¥ ë¹ˆë²ˆ)",
      "TA0005 - Defense Evasion",
      "TA0004 - Privilege Escalation"
    ],
    "primary_techniques": [
      "T1112 - Modify Registry (ì •ìƒ ì—…ë°ì´íŠ¸ í”„ë¡œì„¸ìŠ¤)",
      "T1106 - Native API (ì •ìƒ ì• í”Œë¦¬ì¼€ì´ì…˜ ë™ì‘)",
      "T1055 - Process Injection (ì°¨ë‹¨ë¨)",
      "T1068 - Exploitation for Privilege Escalation (ì˜¤íƒ)",
      "T1014 - Rootkit (ì˜¤íƒ)"
    ],
    "attack_chain_analysis": "ì™„ì „í•œ ê³µê²© ì²´ì¸ì€ ê´€ì°°ë˜ì§€ ì•ŠìŒ. #888-000522ì—ì„œ Initial Access â†’ Execution ë‹¨ê³„ê¹Œì§€ ì§„í–‰ë˜ì—ˆìœ¼ë‚˜ Agentê°€ C&C í†µì‹ ì„ ì°¨ë‹¨í•˜ì—¬ ê³µê²© ì²´ì¸ ì¤‘ë‹¨. ë‚˜ë¨¸ì§€ëŠ” ì •ìƒ í”„ë¡œì„¸ìŠ¤ì˜ ì˜¤íƒ.",
    "defense_gaps": [
      "Local Analysis Malware ì—”ì§„ì˜ ì˜¤íƒë¥  ê°œì„  í•„ìš”",
      "ì •ìƒ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ í™•ëŒ€ (WPS Office, Lenovo Service ë“±)",
      "ìŠ¤ì¼€ì¤„ ì‘ì—… í†µí•œ PowerShell ì‹¤í–‰ ëª¨ë‹ˆí„°ë§ ê°•í™”"
    ]
  },
  "network_threat_analysis": {
    "suspicious_countries": [
      "ë¶„ì„ ëŒ€ìƒ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì¤‘ ëª…í™•í•œ ê³ ìœ„í—˜ êµ­ê°€ ë°œê²¬ë˜ì§€ ì•ŠìŒ"
    ],
    "c2_indicators": [
      "beahh[.]com ë„ë©”ì¸ í†µì‹  ì‹œë„ í™•ì¸ (ì°¨ë‹¨ë¨)"
    ],
    "data_exfiltration_risk": "LOW - C&C í†µì‹ ì´ ì°¨ë‹¨ë˜ì–´ ë°ì´í„° ìœ ì¶œ ì§•í›„ ì—†ìŒ",
    "lateral_movement": "ì—†ìŒ - ë‚´ë¶€ ì´ë™ ì§•í›„ ë¯¸ë°œê²¬"
  },
  "recommendations": {
    "immediate_actions": [
      "#888-000522 ì¸ì‹œë˜íŠ¸ ì¶”ê°€ ì¡°ì‚¬ ë° ì—”ë“œí¬ì¸íŠ¸ ê²©ë¦¬ ìœ ì§€",
      "beahh[.]com ë„ë©”ì¸ ì „ì‚¬ ì°¨ë‹¨ í™•ì¸ ë° ìœ ì§€",
      "ìŠ¤ì¼€ì¤„ ì‘ì—… í†µí•œ ì¸ì½”ë”© PowerShell ì‹¤í–‰ ëª¨ë‹ˆí„°ë§ ê°•í™”"
    ],
    "short_term": [
      "Local Analysis Malware ì—”ì§„ ì˜¤íƒë¥  ê°œì„  (WPS Office, Lenovo Service ë“± í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)",
      "ì •ìƒ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ì˜ Native API í˜¸ì¶œ íŒ¨í„´ í•™ìŠµ ë° ë£° ì¡°ì •",
      "ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìˆ˜ì • íƒì§€ ë£° íŠœë‹ (ì •ìƒ ì—…ë°ì´íŠ¸ í”„ë¡œì„¸ìŠ¤ ì œì™¸)"
    ],
    "long_term": [
      "ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ ì˜¤íƒ ìë™ í•„í„°ë§ ì‹œìŠ¤í…œ ë„ì…",
      "ì •ìƒ ì—…ë¬´ ì• í”Œë¦¬ì¼€ì´ì…˜ ë² ì´ìŠ¤ë¼ì¸ í”„ë¡œíŒŒì¼ë§",
      "PowerShell ì‹¤í–‰ íŒ¨í„´ ë¶„ì„ ë° ì´ìƒ íƒì§€ ê°•í™”"
    ]
  },
  "trending_analysis": {
    "increasing_threats": [
      "ì¸ì½”ë”©ëœ PowerShellì„ í†µí•œ ê³µê²© ì‹œë„ (ìƒˆë¡œìš´ íŒ¨í„´)"
    ],
    "decreasing_threats": [
      "ì „í†µì ì¸ ë©€ì›¨ì–´ íŒŒì¼ ê¸°ë°˜ ê³µê²© ê°ì†Œ"
    ],
    "new_attack_patterns": [
      "ìŠ¤ì¼€ì¤„ ì‘ì—…(schtasks)ì„ í†µí•œ ì¸ì½”ë”© PowerShell ì•…ìš©"
    ],
    "comparison_notes": "ì „ì¼ ë°ì´í„° ì—†ì–´ ë¹„êµ ë¶ˆê°€. í–¥í›„ ì¼ê°„ ë³´ê³ ì„œ ëˆ„ì  ì‹œ íŠ¸ë Œë“œ ë¶„ì„ ê°€ëŠ¥."
  },
  "security_posture_assessment": {
    "strengths": [
      "XDR Agentì˜ ì‹¤ì‹œê°„ ì°¨ë‹¨ ê¸°ëŠ¥ íš¨ê³¼ì  (ì‹¤ì œ ìœ„í˜‘ 100% ì°¨ë‹¨)",
      "MITRE ATT&CK ê¸°ë²• ë§¤í•‘ì„ í†µí•œ ê³µê²© íŒ¨í„´ ê°€ì‹œì„± í™•ë³´",
      "TI ìƒê´€ë¶„ì„ì„ í†µí•œ ìœ„í˜‘ íŒŒì¼ ì‹ ì† ì‹ë³„",
      "MDR íŒ€ì˜ False Positive ì‹ ì† íŒì •"
    ],
    "weaknesses": [
      "Local Analysis Malware ì—”ì§„ì˜ ë†’ì€ ì˜¤íƒë¥  (47%)",
      "ì •ìƒ ì—…ë¬´ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°˜ë³µì  ì˜¤íƒ ë°œìƒ",
      "PowerShell ê¸°ë°˜ ê³µê²© íƒì§€ ë£° ë¯¸í¡",
      "ìŠ¤ì¼€ì¤„ ì‘ì—… ë‚¨ìš© íƒì§€ ë¶€ì¡±"
    ],
    "overall_grade": "B+",
    "improvement_priority": [
      "1ìˆœìœ„: Local Analysis Malware ì˜¤íƒë¥  ê°œì„  (ì •ìƒ ì• í”Œë¦¬ì¼€ì´ì…˜ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)",
      "2ìˆœìœ„: PowerShell ì‹¤í–‰ íŒ¨í„´ ë¶„ì„ ë° ì´ìƒ íƒì§€ ê°•í™”",
      "3ìˆœìœ„: ìŠ¤ì¼€ì¤„ ì‘ì—… ë‚¨ìš© ëª¨ë‹ˆí„°ë§ ë£° ì¶”ê°€",
      "4ìˆœìœ„: ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ ì˜¤íƒ í•„í„°ë§ ì‹œìŠ¤í…œ ë„ì…"
    ]
  }
}
```

**ì €ì¥**: `public/reports/data/ai_analysis_2025-11-10.json` (4.2KB)

### ì—ëŸ¬ ì²˜ë¦¬

```typescript
// 1. JSON íŒŒì‹± ì‹¤íŒ¨
try {
  parsedResult = JSON.parse(jsonResult);
} catch (parseError) {
  console.log('âš ï¸  JSON íŒŒì‹± ì‹¤íŒ¨, ì›ë³¸ ì‘ë‹µ ì €ì¥');
  parsedResult = {
    raw_response: jsonResult,
    parse_error: 'JSON íŒŒì‹± ì‹¤íŒ¨ - ìˆ˜ë™ í™•ì¸ í•„ìš”',
  };
}

// 2. claude ëª…ë ¹ì–´ ì‹¤í–‰ ì‹¤íŒ¨
catch (error: any) {
  console.error('âŒ AI ë¶„ì„ ì‹¤í–‰ ì‹¤íŒ¨');
  console.error(error.message);
  console.log('');
  console.log('ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•˜ë ¤ë©´:');
  console.log(`  cat ${promptFile} | claude --print > ${outputFile}`);
  console.log('');
  process.exit(1);
}

// 3. Timeout (5ë¶„)
// maxBuffer: 10 * 1024 * 1024 (10MB)
// timeout: 300000 (5ë¶„)
```

---

## MCP ì„œë²„ í†µí•©

### 12ê°œ MCP ì„œë²„ ìƒì„¸

#### 1. next-devtools

**ëª…ë ¹ì–´**: `npx -y next-devtools-mcp@latest`

**ê¸°ëŠ¥**:
- Next.js 16 ê°œë°œ ë„êµ¬
- init, docs ê²€ìƒ‰, runtime ì¡°íšŒ
- ì—…ê·¸ë ˆì´ë“œ, cache components

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// Next.js ë¬¸ì„œ ê²€ìƒ‰
mcp__next_devtools__nextjs_docs({ action: 'search', query: 'middleware' })

// Runtime ì •ë³´ ì¡°íšŒ
mcp__next_devtools__nextjs_runtime({ action: 'list_tools' })
```

#### 2. chrome-devtools

**ëª…ë ¹ì–´**: `npx -y chrome-devtools-mcp@latest`

**ê¸°ëŠ¥**:
- ë¸Œë¼ìš°ì € ìë™í™” (Playwright)
- í˜ì´ì§€ íƒìƒ‰, ìŠ¤í¬ë¦°ìƒ·, ì„±ëŠ¥ ë¶„ì„
- ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§, ì½˜ì†” ë¡œê·¸

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// ë¸Œë¼ìš°ì € ì‹œì‘
mcp__chrome_devtools__browser_eval({ action: 'start', headless: false })

// í˜ì´ì§€ ì´ë™
mcp__chrome_devtools__navigate_page({ url: 'http://localhost:40017/reports/daily/daily_report_2025-11-10.html' })

// ìŠ¤í¬ë¦°ìƒ·
mcp__chrome_devtools__take_screenshot({ fullPage: true })
```

#### 3. context7

**ëª…ë ¹ì–´**: `npx -y @upstash/context7-mcp`

**ê¸°ëŠ¥**:
- ìµœì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì„œ ì¡°íšŒ
- Next.js, React, TypeScript, OpenSearch, Prisma ë“±

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// ë¼ì´ë¸ŒëŸ¬ë¦¬ ID í•´ì„
mcp__context7__resolve_library_id({ libraryName: 'Next.js' })

// ë¬¸ì„œ ì¡°íšŒ
mcp__context7__get_library_docs({
  context7CompatibleLibraryID: '/vercel/next.js',
  topic: 'middleware'
})
```

#### 4. postgres-siem, postgres-editor, postgres-n8n

**ëª…ë ¹ì–´**: `npx -y @modelcontextprotocol/server-postgres`

**ì—°ê²° ì •ë³´**:
- **postgres-siem**: `postgresql://opensearch:opensearch123@localhost:5432/siem_db`
- **postgres-editor**: `postgresql://postgres:postgres@localhost:5432/postgres`
- **postgres-n8n**: `postgresql://postgres:postgres@postgres:5432/n8n?schema=ioclog`

**ê¸°ëŠ¥**:
- SQL ì¿¼ë¦¬ ì‹¤í–‰
- í…Œì´ë¸” ì¡°íšŒ
- ìŠ¤í‚¤ë§ˆ ì •ë³´

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// TI ë°ì´í„° ì¡°íšŒ
mcp__postgres_n8n__query({
  sql: "SELECT * FROM ioclog.threat_intel_feeds WHERE hash = 'abc123' LIMIT 10"
})

// MITRE ê¸°ë²• ì¡°íšŒ
mcp__postgres_n8n__query({
  sql: "SELECT * FROM ioclog.mitre_attack WHERE technique_id = 'T1112'"
})
```

#### 5. memory

**ëª…ë ¹ì–´**: `npx -y @modelcontextprotocol/server-memory`

**ê¸°ëŠ¥**:
- ì§€ì‹ ê·¸ë˜í”„ ì €ì¥ì†Œ
- Entities, Relations, Observations CRUD

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// ì—”í‹°í‹° ìƒì„±
mcp__memory__create_entities({
  entities: [{
    name: 'ì¸ì‹œë˜íŠ¸ #888-000527',
    entityType: 'ë³´ì•ˆ ì¸ì‹œë˜íŠ¸',
    observations: ['Critical ì‹¬ê°ë„', 'False Positive íŒì •']
  }]
})

// ê´€ê³„ ìƒì„±
mcp__memory__create_relations({
  relations: [{
    from: 'ì¸ì‹œë˜íŠ¸ #888-000527',
    to: 'WPS Office',
    relationType: 'ê´€ë ¨ ì• í”Œë¦¬ì¼€ì´ì…˜'
  }]
})
```

#### 6. shadcn

**ëª…ë ¹ì–´**: `npx shadcn@latest mcp`

**ê¸°ëŠ¥**:
- shadcn/ui ì»´í¬ë„ŒíŠ¸ ê´€ë¦¬
- ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¡°íšŒ, ì»´í¬ë„ŒíŠ¸ ì„¤ì¹˜

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// ì»´í¬ë„ŒíŠ¸ ê²€ìƒ‰
mcp__shadcn__search_items_in_registries({
  registries: ['@shadcn'],
  query: 'button'
})

// ì»´í¬ë„ŒíŠ¸ ìƒì„¸
mcp__shadcn__view_items_in_registries({
  items: ['@shadcn/button']
})
```

#### 7. opensearch

**ëª…ë ¹ì–´**: `opensearch-mcp-inbridge`

**í™˜ê²½ë³€ìˆ˜**: `MCP_SERVER_URL=http://20.41.120.173:8099`

**ê¸°ëŠ¥**:
- OpenSearch ì¸ë±ìŠ¤ ì¡°íšŒ
- ê²€ìƒ‰ ì¿¼ë¦¬ ì‹¤í–‰
- í†µê³„ ì§‘ê³„

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// ì¸ë±ìŠ¤ ëª©ë¡
mcp__opensearch__Index_Lister({ include_detail: false })

// ì¸ì‹œë˜íŠ¸ ê²€ìƒ‰
mcp__opensearch__Index_Searcher({
  index: 'logs-cortex_xdr-incidents-*',
  query: {
    query: {
      range: {
        '@timestamp': {
          gte: '2025-11-10T00:00:00Z',
          lt: '2025-11-11T00:00:00Z'
        }
      }
    },
    size: 10
  }
})
```

#### 8. incident-analysis

**ëª…ë ¹ì–´**: `incident-analysis-inbridge`

**í™˜ê²½ë³€ìˆ˜**: `MCP_SERVER_URL=http://20.41.120.173:8100`

**5ê°œ í•¨ìˆ˜**:
1. **get_incident_statistics**: ì¸ì‹œë˜íŠ¸ í†µê³„ (ì‹¬ê°ë„ë³„, ìƒíƒœë³„)
2. **create_incident_trend_chart**: íŠ¸ë Œë“œ ì°¨íŠ¸ (ì‹œê°„ë³„, ì¼ë³„)
3. **analyze_top_threats**: ìƒìœ„ ìœ„í˜‘ ë¶„ì„ (Top 10)
4. **analyze_geographic_distribution**: ì§€ë¦¬ì  ë¶„í¬ ë¶„ì„
5. **generate_incident_report**: ì™„ì „í•œ ë³´ê³ ì„œ ìƒì„±

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// ì¼ê°„ í†µê³„
mcp__incident_analysis__get_incident_statistics({
  days: 1,
  index_pattern: 'logs-cortex_xdr-incidents-*'
})

// íŠ¸ë Œë“œ ì°¨íŠ¸
mcp__incident_analysis__create_incident_trend_chart({
  days: 7,
  interval: '1d'
})

// ì™„ì „ ë³´ê³ ì„œ
mcp__incident_analysis__generate_incident_report({
  days: 1,
  report_title: 'ì¼ê°„ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë³´ê³ ì„œ'
})
```

#### 9. nl-query

**ëª…ë ¹ì–´**: `npx tsx /www/ib-editor/my-app/script/nl-query-mcp.js`

**í™˜ê²½ë³€ìˆ˜**:
```bash
AZURE_OPENAI_ENDPOINT=https://etech-openai.openai.azure.com/
AZURE_OPENAI_DEPLOYMENT=gpt-4o-mini
OPENSEARCH_URL=http://opensearch:9200
```

**2ê°œ í•¨ìˆ˜**:
1. **nl_query**: ìì—°ì–´ â†’ OpenSearch DSL ë³€í™˜ + ì‹¤í–‰
2. **test_parse**: íŒŒì‹±ë§Œ í…ŒìŠ¤íŠ¸ (ì‹¤í–‰ ì•ˆ í•¨)

**ì§€ì› ëª¨ë¸**:
- azure-gpt-4o-mini (ê¸°ë³¸)
- claude-3-5-sonnet
- gemini-2.0-flash
- azure-gpt-35-turbo
- claude-3-haiku
- gemini-2.5-pro

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// í•œêµ­ì–´ ìì—°ì–´ ì¿¼ë¦¬
mcp__nl_query__nl_query({
  query: 'ì§€ë‚œ 7ì¼ê°„ critical ì‹¬ê°ë„ ì¸ì‹œë˜íŠ¸ë¥¼ í˜¸ìŠ¤íŠ¸ë³„ë¡œ ì§‘ê³„í•´ì¤˜',
  model: 'azure-gpt-4o-mini',
  format: ['markdown', 'json'],
  execute: true
})

// ê²°ê³¼ (Markdown):
// | í˜¸ìŠ¤íŠ¸ | ì¸ì‹œë˜íŠ¸ ìˆ˜ |
// |--------|------------|
// | rnd-d308242 | 2 |
// | win-cva58dk5gp3 | 1 |

// íŒŒì‹±ë§Œ í…ŒìŠ¤íŠ¸
mcp__nl_query__test_parse({
  query: 'ì˜¤ëŠ˜ ë°œìƒí•œ ì¸ì‹œë˜íŠ¸ ê°œìˆ˜',
  model: 'azure-gpt-4o-mini'
})

// ê²°ê³¼ (OpenSearch DSL):
// {
//   "query": {
//     "range": {
//       "@timestamp": {
//         "gte": "2025-11-11T00:00:00Z",
//         "lt": "2025-11-12T00:00:00Z"
//       }
//     }
//   },
//   "size": 0,
//   "aggs": {
//     "incident_count": {
//       "value_count": { "field": "incident.incident_id" }
//     }
//   }
// }
```

**30+ ë‚ ì§œ í‘œí˜„ ì§€ì›**:
- ì˜¤ëŠ˜, ì–´ì œ, ì´ë²ˆ ì£¼, ì§€ë‚œ ì£¼
- ìµœê·¼ 7ì¼, 30ì¼, 90ì¼
- YYYY-MM-DD í˜•ì‹
- ìƒëŒ€ì  ë‚ ì§œ (3ì¼ ì „, 2ì£¼ ì „)

**8ê°œ ë°ì´í„° íƒ€ì… ì§€ì›**:
- ì¸ì‹œë˜íŠ¸, ì•ŒëŸ¿, íŒŒì¼, ë„¤íŠ¸ì›Œí¬
- í”„ë¡œì„¸ìŠ¤, ì—”ë“œí¬ì¸íŠ¸, CVE, MITRE

**5ê°€ì§€ ì¿¼ë¦¬ íƒ€ì…**:
- ê°œìˆ˜ ì„¸ê¸° (count)
- ì§‘ê³„ (aggregation)
- ê²€ìƒ‰ (search)
- ìƒìœ„ Nê°œ (top N)
- í†µê³„ (statistics)

#### 10. claude-investigation

**ëª…ë ¹ì–´**: `npx tsx /www/ib-editor/my-app/script/claude-investigation-mcp.js`

**í™˜ê²½ë³€ìˆ˜**:
```bash
OPENSEARCH_URL=http://opensearch:9200
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/n8n?schema=ioclog
```

**2ê°œ í•¨ìˆ˜**:
1. **collect_incident_data**: ì¸ì‹œë˜íŠ¸ ë°ì´í„° ìˆ˜ì§‘ (AI ë¶„ì„ ì—†ì´)
2. **save_analysis_and_generate_report**: AI ë¶„ì„ ì €ì¥ + HTML ìƒì„±

**ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤**:
```typescript
// 1. ë°ì´í„° ìˆ˜ì§‘
const data = await mcp__claude_investigation__collect_incident_data({
  incident_id: '888-000527'
})

// ë°˜í™˜:
// {
//   incident: { /* ì¸ì‹œë˜íŠ¸ ìƒì„¸ */ },
//   alerts: [ /* ì•ŒëŸ¿ ëª©ë¡ */ ],
//   file_artifacts: [ /* íŒŒì¼ */ ],
//   network_artifacts: [ /* ë„¤íŠ¸ì›Œí¬ */ ],
//   mitre_techniques: [ /* MITRE */ ],
//   endpoint_cves: [ /* CVE */ ]
// }

// 2. Claude Codeê°€ AI ë¶„ì„ ìˆ˜í–‰
const analysis = {
  incident_detail: "ì¸ì‹œë˜íŠ¸ ìƒì„¸ ë¶„ì„ ì˜ê²¬ (í•œê¸€)",
  endpoint_analysis: "ì—”ë“œí¬ì¸íŠ¸ ë¶„ì„ ì˜ê²¬ (í•œê¸€)",
  file_artifacts: "íŒŒì¼ ì•„í‹°íŒ©íŠ¸ ë¶„ì„ ì˜ê²¬ (í•œê¸€)",
  network_artifacts: "ë„¤íŠ¸ì›Œí¬ ì•„í‹°íŒ©íŠ¸ ë¶„ì„ ì˜ê²¬ (í•œê¸€)",
  mitre_analysis: "MITRE ATT&CK ë¶„ì„ ì˜ê²¬ (í•œê¸€)",
  final_verdict: {
    verdict: "true_positive", // or "false_positive", "needs_investigation"
    risk_score: 75,
    confidence: 85,
    summary: "ì¢…í•© ë¶„ì„ ìš”ì•½ (í•œê¸€)",
    key_findings: ["ë°œê²¬ì‚¬í•­ 1", "ë°œê²¬ì‚¬í•­ 2"]
  }
}

// 3. ë¶„ì„ ê²°ê³¼ ì €ì¥ + HTML ìƒì„±
await mcp__claude_investigation__save_analysis_and_generate_report({
  incident_id: '888-000527',
  analysis
})

// ê²°ê³¼:
// 1. public/reports/incident_888-000527_korean_analysis.json
// 2. public/reports/incident_888-000527_korean_report.html
```

**ìƒì„±ëœ ë³´ê³ ì„œ**:
- **JSON**: `public/reports/incident_888-000527_korean_analysis.json`
- **HTML**: `public/reports/incident_888-000527_korean_report.html`
- **URL**: `http://localhost:40017/reports/incident_888-000527_korean_report.html`

---

## ì†ŒìŠ¤ì½”ë“œ ë¶„ì„

### Shell ìŠ¤í¬ë¦½íŠ¸

#### generate-complete-daily-report.sh

**ìœ„ì¹˜**: `/www/ib-editor/my-app/script/generate-complete-daily-report.sh`

**í•µì‹¬ ë¡œì§**:
```bash
# ë‚ ì§œ ì„¤ì •
if [ -z "$1" ]; then
    REPORT_DATE=$(date -d "yesterday" '+%Y-%m-%d')
else
    REPORT_DATE=$1
fi

# 1ë‹¨ê³„: ë°ì´í„° ìˆ˜ì§‘
npx tsx script/collect-daily-incidents-data.ts "$REPORT_DATE"

# 2ë‹¨ê³„: í”„ë¡¬í”„íŠ¸ ìƒì„±
npx tsx script/create-ai-analysis-prompt.ts "$REPORT_DATE"

# 3ë‹¨ê³„: AI ë¶„ì„ ì‹¤í–‰
if command -v claude &> /dev/null; then
    echo "âœ… claude ëª…ë ¹ì–´ ë°œê²¬ - ìë™ ì‹¤í–‰"
    npx tsx script/run-ai-analysis.ts "$REPORT_DATE"
else
    echo "âš ï¸  claude ëª…ë ¹ì–´ ì—†ìŒ - ìˆ˜ë™ ì‹¤í–‰ í•„ìš”"
    # í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì¶œë ¥
    head -30 "/tmp/ai_analysis_prompt_${REPORT_DATE}.txt"
    # ì‚¬ìš©ì Enter ëŒ€ê¸°
    read -r
    # AI ë¶„ì„ íŒŒì¼ í™•ì¸
    if [ ! -f "/tmp/ai_analysis_${REPORT_DATE}.json" ]; then
        echo "âŒ AI ë¶„ì„ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
        exit 1
    fi
fi

# 4ë‹¨ê³„: ìµœì¢… ë³´ê³ ì„œ ìƒì„±
npx tsx script/generate-final-report.ts "$REPORT_DATE"

# AI ë¶„ì„ ìš”ì•½ ì¶œë ¥ (jq ì‚¬ìš©)
if command -v jq &> /dev/null; then
    echo "ì¢…í•© ìš”ì•½:"
    jq -r '.executive_summary' "/tmp/ai_analysis_${REPORT_DATE}.json"

    echo "ìœ„í—˜ë„:"
    echo "  - ë ˆë²¨: $(jq -r '.threat_assessment.overall_risk_level' ...)"
    echo "  - ì ìˆ˜: $(jq -r '.threat_assessment.risk_score' ...)/100"

    echo "ì£¼ìš” ë°œê²¬ì‚¬í•­:"
    jq -r '.threat_assessment.key_findings[]' ... | while read -r finding; do
        echo "  â€¢ $finding"
    done
fi
```

**íŠ¹ì§•**:
- 4ë‹¨ê³„ íŒŒì´í”„ë¼ì¸ ìˆœì°¨ ì‹¤í–‰
- claude ëª…ë ¹ì–´ ìë™ ê°ì§€
- ìˆ˜ë™ ì‹¤í–‰ ì‹œ í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸°
- AI ë¶„ì„ ìš”ì•½ ì¶œë ¥ (jq ì‚¬ìš©)
- ì—ëŸ¬ ì‹œ ì¤‘ë‹¨

#### auto-daily-report.sh

**ìœ„ì¹˜**: `/www/ib-editor/my-app/script/auto-daily-report.sh`

**í•µì‹¬ ë¡œì§**:
```bash
# ë¡œê·¸ íŒŒì¼
LOG_FILE="/tmp/auto-daily-report-${REPORT_DATE}.log"

# 1ë‹¨ê³„: ë°ì´í„° ìˆ˜ì§‘
npx tsx script/collect-daily-incidents-data.ts "$REPORT_DATE" 2>&1 | tee -a "$LOG_FILE"

if [ $? -ne 0 ]; then
    ERROR_MESSAGE="ì¸ì‹œë˜íŠ¸ ë°ì´í„° ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"

    # Supabase ì—ëŸ¬ ì•Œë¦¼ ì „ì†¡
    npx tsx script/send-error-notification.ts \
        "data_collection_failed" \
        "critical" \
        "$REPORT_DATE" \
        "$ERROR_MESSAGE" \
        2>&1 | tee -a "$LOG_FILE"

    exit 1
fi

# ë°ì´í„° íŒŒì¼ í™•ì¸
DATA_FILE="public/reports/data/daily_incidents_data_${REPORT_DATE}.json"
if [ ! -f "$DATA_FILE" ]; then
    echo "âŒ ë°ì´í„° íŒŒì¼ ìƒì„± ì‹¤íŒ¨" | tee -a "$LOG_FILE"
    # Supabase ì•Œë¦¼
    exit 1
fi

# ë°ì´í„° íŒŒì¼ ìœ íš¨ì„± ê²€ì¦ (jq)
if ! jq empty "$DATA_FILE" 2>/dev/null; then
    echo "âŒ ë°ì´í„° íŒŒì¼ì´ ìœ íš¨í•˜ì§€ ì•Šì€ JSON í˜•ì‹ì…ë‹ˆë‹¤" | tee -a "$LOG_FILE"
    # Supabase ì•Œë¦¼
    exit 1
fi

INCIDENT_COUNT=$(cat "$DATA_FILE" | jq '.collected_data.incidents | length')
echo "âœ… ìˆ˜ì§‘ëœ ì¸ì‹œë˜íŠ¸: ${INCIDENT_COUNT}ê±´" | tee -a "$LOG_FILE"

# 2ë‹¨ê³„: AI ë¶„ì„ í™•ì¸
AI_FILE="public/reports/data/ai_analysis_${REPORT_DATE}.json"

if [ ! -f "$AI_FILE" ]; then
    echo "âŒ AI ë¶„ì„ ì‹¤íŒ¨" | tee -a "$LOG_FILE"

    echo "í•„ìˆ˜ ì¡°ì¹˜:" | tee -a "$LOG_FILE"
    echo "  â†’ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ AI ë¶„ì„ í”„ë¡¬í”„íŠ¸ ìƒì„±:" | tee -a "$LOG_FILE"
    echo "    npx tsx script/create-ai-analysis-prompt.ts ${REPORT_DATE}" | tee -a "$LOG_FILE"
    echo "" | tee -a "$LOG_FILE"
    echo "  â†’ ìƒì„±ëœ í”„ë¡¬í”„íŠ¸ë¥¼ Claude Codeì— ë¶™ì—¬ë„£ê¸°:" | tee -a "$LOG_FILE"
    echo "    cat public/reports/data/ai_analysis_prompt_${REPORT_DATE}.txt" | tee -a "$LOG_FILE"
    echo "" | tee -a "$LOG_FILE"
    echo "  â†’ AI ì‘ë‹µì„ ë‹¤ìŒ ê²½ë¡œì— ì €ì¥:" | tee -a "$LOG_FILE"
    echo "    ${AI_FILE}" | tee -a "$LOG_FILE"

    # Supabase ì—ëŸ¬ ì•Œë¦¼
    npx tsx script/send-error-notification.ts \
        "ai_analysis_failed" \
        "critical" \
        "$REPORT_DATE" \
        "$ERROR_MESSAGE" \
        2>&1 | tee -a "$LOG_FILE"

    # ì—ëŸ¬ ìƒíƒœ íŒŒì¼ ìƒì„±
    ERROR_STATE_FILE="/tmp/daily_report_error_${REPORT_DATE}.flag"
    cat > "$ERROR_STATE_FILE" << EOF
{
  "error_type": "ai_analysis_failed",
  "report_date": "$REPORT_DATE",
  "error_message": "$ERROR_MESSAGE",
  "timestamp": "$(date -Iseconds)",
  "hostname": "$(hostname)",
  "log_file": "$LOG_FILE"
}
EOF

    echo "âš ï¸  ë³´ê³ ì„œ ìƒì„±ì„ ì¤‘ë‹¨í•©ë‹ˆë‹¤." | tee -a "$LOG_FILE"
    echo "âš ï¸  AI ë¶„ì„ ì™„ë£Œ í›„ ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”." | tee -a "$LOG_FILE"

    exit 1
else
    echo "âœ… AI ë¶„ì„ íŒŒì¼ ë°œê²¬: ${AI_FILE}" | tee -a "$LOG_FILE"

    # AI ë¶„ì„ íŒŒì¼ ìœ íš¨ì„± ê²€ì¦
    if ! jq empty "$AI_FILE" 2>/dev/null; then
        echo "âŒ AI ë¶„ì„ íŒŒì¼ì´ ìœ íš¨í•˜ì§€ ì•Šì€ JSON í˜•ì‹ì…ë‹ˆë‹¤" | tee -a "$LOG_FILE"
        # Supabase ì•Œë¦¼
        exit 1
    fi

    echo "âœ… AI ë¶„ì„ íŒŒì¼ ìœ íš¨ì„± ê²€ì¦ í†µê³¼" | tee -a "$LOG_FILE"
fi

# 3ë‹¨ê³„: ë³´ê³ ì„œ ìƒì„±
npx tsx script/generate-final-report.ts "$REPORT_DATE" 2>&1 | tee -a "$LOG_FILE"

if [ $? -ne 0 ]; then
    echo "âŒ ë³´ê³ ì„œ ìƒì„± ì‹¤íŒ¨" | tee -a "$LOG_FILE"
    exit 1
fi

# ì™„ë£Œ
echo "âœ… ìë™ ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ!" | tee -a "$LOG_FILE"
echo "ğŸ“ ìƒì„±ëœ íŒŒì¼:" | tee -a "$LOG_FILE"
echo "  âœ“ public/reports/data/daily_incidents_data_${REPORT_DATE}.json" | tee -a "$LOG_FILE"
echo "  âœ“ public/reports/data/ai_analysis_${REPORT_DATE}.json" | tee -a "$LOG_FILE"
echo "  âœ“ public/reports/daily/daily_report_${REPORT_DATE}.html" | tee -a "$LOG_FILE"
echo "  âœ“ public/reports/daily/daily_report_${REPORT_DATE}.md" | tee -a "$LOG_FILE"
echo "  âœ“ public/reports/daily/daily_report_${REPORT_DATE}.json" | tee -a "$LOG_FILE"

echo "ğŸ“‹ ë¡œê·¸ íŒŒì¼: ${LOG_FILE}" | tee -a "$LOG_FILE"
echo "ğŸŒ ì›¹ ì ‘ê·¼: http://localhost:3000/reports/daily/daily_report_${REPORT_DATE}.html" | tee -a "$LOG_FILE"
```

**íŠ¹ì§•**:
- ì™„ì „ ìë™í™” (ì‚¬ìš©ì ì…ë ¥ ë¶ˆí•„ìš”)
- AI ë¶„ì„ íŒŒì¼ í•„ìˆ˜ ì²´í¬
- ì—ëŸ¬ ë°œìƒ ì‹œ Supabase ì•Œë¦¼ ì „ì†¡
- ë¡œê·¸ íŒŒì¼ ìë™ ì €ì¥
- ë°ì´í„° íŒŒì¼ ìœ íš¨ì„± ê²€ì¦ (jq)
- ì—ëŸ¬ ìƒíƒœ íŒŒì¼ ìƒì„±

**Cron ì„¤ì •**:
```bash
# ë§¤ì¼ ì˜¤ì „ 8ì‹œ ìë™ ì‹¤í–‰
0 8 * * * cd /www/ib-editor/my-app && ./script/auto-daily-report.sh >> /var/log/daily-report.log 2>&1
```

---

## ì‹¤ì „ ê°€ì´ë“œ

### ë¹ ë¥¸ ì‹œì‘ (ìë™í™”)

```bash
# 1. í”„ë¡œì íŠ¸ë¡œ ì´ë™
cd /www/ib-editor/my-app

# 2. claude CLI ì„¤ì¹˜ í™•ì¸
which claude
# /home/ubuntu/.nvm/versions/node/v22.16.0/bin/claude (ì´ë¯¸ ì„¤ì¹˜ë¨ âœ…)

# 3. ì™„ì „ ìë™í™” íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ (í•œ ì¤„ë¡œ ë)
./script/generate-complete-daily-report.sh 2025-11-10

# 4. ê²°ê³¼ í™•ì¸ (2-3ë¶„ í›„)
ls -lh public/reports/daily/daily_report_2025-11-10.*
# âœ“ HTML (99KB) - Tailwind CSS ìŠ¤íƒ€ì¼
# âœ“ MD (4.9KB) - Markdown ìš”ì•½
# âœ“ JSON (14KB) - êµ¬ì¡°í™”ëœ ë°ì´í„°

# 5. ì›¹ ë¸Œë¼ìš°ì €ë¡œ ë³´ê¸°
xdg-open public/reports/daily/daily_report_2025-11-10.html
# ë˜ëŠ” http://localhost:40017/reports/daily/daily_report_2025-11-10.html
```

### Cron ìë™í™” ì„¤ì •

```bash
# 1. Cron í¸ì§‘
crontab -e

# 2. ë§¤ì¼ ì˜¤ì „ 8ì‹œ ì‹¤í–‰ ì„¤ì •
0 8 * * * cd /www/ib-editor/my-app && ./script/auto-daily-report.sh >> /var/log/daily-report.log 2>&1

# 3. Cron ìƒíƒœ í™•ì¸
systemctl status cron

# 4. ë¡œê·¸ í™•ì¸
tail -f /var/log/daily-report.log
```

### ìˆ˜ë™ ì‹¤í–‰ (ë¬´ë£Œ)

```bash
# 1. ë°ì´í„° ìˆ˜ì§‘
npx tsx script/collect-daily-incidents-data.ts 2025-11-10

# 2. í”„ë¡¬í”„íŠ¸ ìƒì„±
npx tsx script/create-ai-analysis-prompt.ts 2025-11-10

# 3. í”„ë¡¬í”„íŠ¸ ë³µì‚¬
cat public/reports/data/ai_analysis_prompt_2025-11-10.txt | pbcopy  # macOS
cat public/reports/data/ai_analysis_prompt_2025-11-10.txt | xclip   # Linux

# 4. Claude Codeì— ë¶™ì—¬ë„£ê¸°
# (ì›¹ ë¸Œë¼ìš°ì € ë˜ëŠ” CLIì—ì„œ)

# 5. JSON ì‘ë‹µ ì €ì¥
# Claude Code ì‘ë‹µì—ì„œ JSON ë¶€ë¶„ë§Œ ë³µì‚¬í•˜ì—¬:
nano public/reports/data/ai_analysis_2025-11-10.json
# ë¶™ì—¬ë„£ê¸° í›„ ì €ì¥

# 6. ë³´ê³ ì„œ ìƒì„±
npx tsx script/generate-final-report.ts 2025-11-10

# 7. ê²°ê³¼ í™•ì¸
ls -lh public/reports/daily/daily_report_2025-11-10.*
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: claude ëª…ë ¹ì–´ ì—†ìŒ

**ì¦ìƒ**:
```bash
âš ï¸  claude ëª…ë ¹ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
```

**í•´ê²°**:
```bash
# ë°©ë²• A: claude CLI ì„¤ì¹˜
npm install -g @anthropic-ai/claude-cli
claude configure

# ë°©ë²• B: Claude Code ìˆ˜ë™ ì‚¬ìš© (ë¬´ë£Œ)
# (ì‹¤ì „ ê°€ì´ë“œ ì°¸ì¡°)

# ë°©ë²• C: Azure OpenAI ì‚¬ìš©
# (í™˜ê²½ë³€ìˆ˜ ì„¤ì • í›„ script/run-ai-analysis-azure.ts ì‹¤í–‰)
```

### ë¬¸ì œ 2: ai_analysis íŒŒì¼ ì—†ìŒ

**ì¦ìƒ**:
```bash
âŒ AI ë¶„ì„ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: public/reports/data/ai_analysis_2025-11-10.json
```

**í•´ê²°**:
```bash
# 1. í”„ë¡¬í”„íŠ¸ ìƒì„± í™•ì¸
ls -lh public/reports/data/ai_analysis_prompt_2025-11-10.txt

# 2. í”„ë¡¬í”„íŠ¸ê°€ ìˆìœ¼ë©´ AI ë¶„ì„ ì‹¤í–‰
# ë°©ë²• A: claude CLI
npx tsx script/run-ai-analysis.ts 2025-11-10

# ë°©ë²• B: Claude Code ìˆ˜ë™
cat public/reports/data/ai_analysis_prompt_2025-11-10.txt
# â†’ Claude Codeì— ë¶™ì—¬ë„£ê¸° â†’ JSON ì €ì¥

# 3. íŒŒì¼ ìƒì„± í™•ì¸
ls -lh public/reports/data/ai_analysis_2025-11-10.json
```

### ë¬¸ì œ 3: OpenSearch ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ**:
```bash
Error: connect ECONNREFUSED 20.41.120.173:9200
```

**í•´ê²°**:
```bash
# 1. OpenSearch ì„œë²„ ìƒíƒœ í™•ì¸
curl http://opensearch:9200

# 2. /etc/hosts í™•ì¸
cat /etc/hosts | grep opensearch
# opensearch â†’ 20.41.120.173

# 3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
ping opensearch

# 4. í™˜ê²½ë³€ìˆ˜ í™•ì¸
cat .env.local | grep OPENSEARCH
```

### ë¬¸ì œ 4: JSON íŒŒì‹± ì‹¤íŒ¨

**ì¦ìƒ**:
```bash
âš ï¸  JSON íŒŒì‹± ì‹¤íŒ¨, ì›ë³¸ ì‘ë‹µ ì €ì¥
```

**í•´ê²°**:
```bash
# 1. ai_analysis JSON íŒŒì¼ í™•ì¸
cat public/reports/data/ai_analysis_2025-11-10.json

# 2. JSON ìœ íš¨ì„± ê²€ì‚¬
jq . public/reports/data/ai_analysis_2025-11-10.json

# 3. ì—ëŸ¬ í™•ì¸
jq . public/reports/data/ai_analysis_2025-11-10.json 2>&1 | head

# 4. ìˆ˜ë™ ìˆ˜ì •
nano public/reports/data/ai_analysis_2025-11-10.json

# 5. ì¬ì‹œë„
npx tsx script/generate-final-report.ts 2025-11-10
```

---

## ê²°ë¡ 

### í•µì‹¬ ì„±ê³¼

1. âœ… **ì™„ì „ ìë™í™” ê²€ì¦ ì™„ë£Œ**: claude --printë¥¼ í†µí•œ 2-3ë¶„ ì™„ì „ ìë™í™” (2025-11-10)
2. âœ… **3ê°€ì§€ AI ë°©ë²• ì§€ì›**: claude CLI (ìë™), Claude Code (ë¬´ë£Œ), Azure OpenAI (ëŒ€ì²´)
3. âœ… **12ê°œ MCP ì„œë²„ í†µí•©**: ì‹¤ì‹œê°„ ë°ì´í„° ì¡°íšŒ ë° ë¶„ì„ í™•ì¥
4. âœ… **ì „ë¬¸ í•œêµ­ì–´ ë³´ê³ ì„œ**: HTML/Markdown/JSON 3ê°œ í¬ë§·
5. âœ… **Cron ìë™í™” ì¤€ë¹„**: Supabase ì—ëŸ¬ ì•Œë¦¼ í¬í•¨

### í”„ë¡œë•ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] claude CLI ì„¤ì¹˜ í™•ì¸ (v2.0.36)
- [x] OpenSearch ì—°ê²° í™•ì¸ (20.41.120.173:9200)
- [x] PostgreSQL ì—°ê²° í™•ì¸ (postgres:5432/n8n)
- [x] í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env.local)
- [x] ë°ì´í„° ìˆ˜ì§‘ í…ŒìŠ¤íŠ¸ (17ê±´ ì„±ê³µ)
- [x] AI ë¶„ì„ ìë™ ì‹¤í–‰ í…ŒìŠ¤íŠ¸ (60-120ì´ˆ ì„±ê³µ)
- [x] ë³´ê³ ì„œ ìƒì„± í…ŒìŠ¤íŠ¸ (3ê°œ íŒŒì¼ ìƒì„± ì„±ê³µ)
- [x] Cron ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ì¤€ë¹„ (auto-daily-report.sh)
- [ ] Cron ë“±ë¡ (í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì‹¤í–‰)
- [ ] Supabase ì•Œë¦¼ ì„¤ì • (send-error-notification.ts)

### ë‹¤ìŒ ë‹¨ê³„

1. **Cron ë“±ë¡**: ë§¤ì¼ ì˜¤ì „ 8ì‹œ ìë™ ì‹¤í–‰
2. **ëª¨ë‹ˆí„°ë§ ì„¤ì •**: ë¡œê·¸ íŒŒì¼ ë° ì—ëŸ¬ ì•Œë¦¼ í™•ì¸
3. **ì£¼ê°„ ë³´ê³ ì„œ**: 7ì¼ì¹˜ ë°ì´í„° í†µí•© ë³´ê³ ì„œ ìƒì„±
4. **ì›”ê°„ ë³´ê³ ì„œ**: 30ì¼ì¹˜ íŠ¸ë Œë“œ ë¶„ì„
5. **REST API**: ì™¸ë¶€ ì‹œìŠ¤í…œ í†µí•© (Slack, Teams)

---

**ë¬¸ì„œ ë²„ì „**: 2.0
**ìµœì´ˆ ì‘ì„±**: 2025-11-10
**ì‹¤ì œ ê²€ì¦**: 2025-11-11 âœ…
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: Cron ìë™í™” ìš´ì˜ í›„
