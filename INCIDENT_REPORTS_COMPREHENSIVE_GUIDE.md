# ğŸ” ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë³´ê³ ì„œ ì‹œìŠ¤í…œ - ì™„ì „ ê°€ì´ë“œ

> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-10
> **ë²„ì „**: 2.0
> **ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ìš´ì˜ ì¤‘

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬ ì‹œìŠ¤í…œ](#ì¸ì‹œë˜íŠ¸-ì¡°ì‚¬-ì‹œìŠ¤í…œ)
3. [ì¼ê°„ ë³´ê³ ì„œ ì‹œìŠ¤í…œ](#ì¼ê°„-ë³´ê³ ì„œ-ì‹œìŠ¤í…œ)
4. [ì£¼ê°„ ë³´ê³ ì„œ ì‹œìŠ¤í…œ](#ì£¼ê°„-ë³´ê³ ì„œ-ì‹œìŠ¤í…œ)
5. [Claude Code í†µí•©](#claude-code-í†µí•©)
6. [ìë™í™” ë° ìŠ¤ì¼€ì¤„ë§](#ìë™í™”-ë°-ìŠ¤ì¼€ì¤„ë§)
7. [ì•„í‚¤í…ì²˜](#ì•„í‚¤í…ì²˜)
8. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ì‹œìŠ¤í…œ ê°œìš”

ì´ ì‹œìŠ¤í…œì€ **Cortex XDR ë³´ì•ˆ ì¸ì‹œë˜íŠ¸**ë¥¼ ìë™ìœ¼ë¡œ ì¡°ì‚¬í•˜ê³  ë¶„ì„í•˜ì—¬ ë‹¤ì–‘í•œ í˜•ì‹ì˜ ë³´ê³ ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ ê¸°ëŠ¥

#### 1ï¸âƒ£ ë‹¨ì¼ ì¸ì‹œë˜íŠ¸ ì‹¬ì¸µ ì¡°ì‚¬
- **7ê°œ OpenSearch ì¸ë±ìŠ¤** í†µí•© ì¡°íšŒ
- **PostgreSQL TI ë°ì´í„°ë² ì´ìŠ¤** ìƒê´€ë¶„ì„
- **7ê°œ ë³‘ë ¬ AI ë¶„ì„ê¸°** (Azure OpenAI gpt-4o-mini)
- **ì‹¤í–‰ ì‹œê°„**: 8-16ì´ˆ
- **ì¶œë ¥ í˜•ì‹**: JSON + Markdown + HTML

#### 2ï¸âƒ£ ì¼ê°„ ë³´ì•ˆ ë³´ê³ ì„œ
- **í•˜ë£¨ ì „ì²´ ì¸ì‹œë˜íŠ¸** ì§‘ê³„ ë° ë¶„ì„
- **Claude AI ì „ë¬¸ê°€ ë¶„ì„** (ì„ íƒ)
- **ìœ„í—˜ë„ í‰ê°€ ë° ê¶Œì¥ì‚¬í•­**
- **ì‹¤í–‰ ì£¼ê¸°**: ë§¤ì¼ ìƒˆë²½ 1ì‹œ (Cron)
- **ì¶œë ¥ í˜•ì‹**: HTML + Markdown + JSON

#### 3ï¸âƒ£ ì£¼ê°„ ë³´ì•ˆ ë³´ê³ ì„œ
- **7ì¼ê°„ íŠ¸ë Œë“œ ë¶„ì„**
- **ê²½ì˜ì§„ìš© Executive Summary**
- **ë³´ì•ˆ íƒœì„¸ í‰ê°€**
- **ì‹¤í–‰ ì£¼ê¸°**: ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œ
- **ì¶œë ¥ í˜•ì‹**: HTML + PDF (ì„ íƒ)

#### 4ï¸âƒ£ Claude Code ê³ í’ˆì§ˆ ë³´ê³ ì„œ
- **Claude Sonnet 4.5** ì‹¬ì¸µ ë¶„ì„
- **Tailwind CSS + Chart.js** ì‹œê°í™”
- **ì¸í„°ë™í‹°ë¸Œ HTML** ë³´ê³ ì„œ
- **ì‹¤í–‰ ë°©ë²•**: ìˆ˜ë™ (Claude Code UI)
- **ì¶œë ¥ í˜•ì‹**: HTML (ê³ í’ˆì§ˆ)

---

## ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬ ì‹œìŠ¤í…œ

### ğŸ“Š ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Input Methods                             â”‚
â”‚   MCP Tool â”‚ CLI Script â”‚ REST API â”‚ File Watcher           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Investigation Pipeline                          â”‚
â”‚                                                              â”‚
â”‚  1ï¸âƒ£ OpenSearch Query (7 indices)                           â”‚
â”‚     â€¢ logs-cortex_xdr-incidents-*                           â”‚
â”‚     â€¢ logs-cortex_xdr-alerts-*                              â”‚
â”‚     â€¢ logs-cortex_xdr-files-*                               â”‚
â”‚     â€¢ logs-cortex_xdr-networks-*                            â”‚
â”‚     â€¢ logs-cortex_xdr-processes-*                           â”‚
â”‚     â€¢ logs-cortex_xdr-endpoints-*                           â”‚
â”‚     â€¢ logs-cortex_xdr-causality_chains-*                    â”‚
â”‚                                                              â”‚
â”‚  2ï¸âƒ£ TI Correlation (PostgreSQL)                            â”‚
â”‚     â€¢ File hashes â†’ ioclog.ioc_log (Threat/Unknown/Benign) â”‚
â”‚     â€¢ IP addresses â†’ GeoIP + Threat Intel                   â”‚
â”‚     â€¢ MITRE techniques â†’ ioclog.mitre_techniques            â”‚
â”‚     â€¢ CVEs â†’ ioclog.cve_details (CVSS + Description)        â”‚
â”‚                                                              â”‚
â”‚  3ï¸âƒ£ Parallel AI Analysis (Azure OpenAI)                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚     â”‚ Analyst Verifier                    â”‚ â”€â”             â”‚
â”‚     â”‚ File Hash Analyzer                  â”‚  â”‚             â”‚
â”‚     â”‚ Network Analyzer                    â”‚  â”‚             â”‚
â”‚     â”‚ MITRE Analyzer                      â”‚  â”œâ”€â†’ Promise.allâ”‚
â”‚     â”‚ CVE Analyzer                        â”‚  â”‚             â”‚
â”‚     â”‚ Endpoint Analyzer                   â”‚ â”€â”˜             â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                   â†“                                          â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚     â”‚ Synthesizer (Final Verdict)         â”‚                â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚     â€¢ Token optimization (68% reduction)                    â”‚
â”‚     â€¢ Execution time: 5-10 seconds                          â”‚
â”‚                                                              â”‚
â”‚  4ï¸âƒ£ Result Storage                                          â”‚
â”‚     â€¢ JSON (full data, ~140KB)                              â”‚
â”‚     â€¢ Markdown (human-readable report, ~50KB)               â”‚
â”‚     â€¢ HTML (Korean report, ~80KB)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸš€ ì‚¬ìš© ë°©ë²•

#### ë°©ë²• 1: CLI ìŠ¤í¬ë¦½íŠ¸

```bash
# ë‹¨ì¼ ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬
npx tsx script/investigate-incident-cli.ts --incident-id 414186

# ìºì‹œ ë¬´ì‹œ (ê°•ì œ ì¬ì¡°ì‚¬)
npx tsx script/investigate-incident-cli.ts --incident-id 414186 --force

# ë°°ì¹˜ ì²˜ë¦¬
echo "414186\n414187\n414188" > incidents.txt
npx tsx script/investigate-incident-cli.ts --batch incidents.txt

# ìµœê·¼ 24ì‹œê°„ ë‚´ ì‹ ê·œ ì¸ì‹œë˜íŠ¸ ìë™ ë°œê²¬
npx tsx script/investigate-incident-cli.ts --auto-new --since 24h
```

#### ë°©ë²• 2: Claude Code (MCP)

```
Investigate incident 414186
```

#### ë°©ë²• 3: REST API

**ë™ê¸° ëª¨ë“œ** (ê²°ê³¼ ì¦‰ì‹œ ë°˜í™˜):
```bash
curl -X POST http://localhost:40017/api/investigate \
  -H "Content-Type: application/json" \
  -d '{"incident_id": "414186"}'
```

**ë¹„ë™ê¸° ëª¨ë“œ** (ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰):
```bash
# ì¡°ì‚¬ ì‹œì‘
curl -X POST http://localhost:40017/api/investigate \
  -H "Content-Type: application/json" \
  -d '{"incident_id": "414186", "async": true}'
# ì‘ë‹µ: {"job_id": "abc-123", "status": "pending"}

# ìƒíƒœ í™•ì¸
curl "http://localhost:40017/api/investigate?job_id=abc-123"

# ì‘ì—… ì·¨ì†Œ
curl -X DELETE "http://localhost:40017/api/investigate?job_id=abc-123"
```

#### ë°©ë²• 4: File Watcher (ì´ë²¤íŠ¸ ê¸°ë°˜)

```bash
# Watcher ì‹œì‘
npx tsx script/watch-incidents.ts

# ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ íŠ¸ë¦¬ê±° íŒŒì¼ ìƒì„±
echo "414186" > data/watch/incident-414186.txt

# ìë™ìœ¼ë¡œ ì¡°ì‚¬ ì‹œì‘ â†’ ì™„ë£Œ ì‹œ íŒŒì¼ ì‚­ì œ
```

#### ë°©ë²• 5: Cron Job (ìë™í™”)

```bash
# Foreground (í…ŒìŠ¤íŠ¸)
npx tsx script/cron-investigate.ts --once

# Background (Production)
sudo systemctl start incident-investigation
```

### ğŸ“ ì¶œë ¥ íŒŒì¼

**ìœ„ì¹˜**: `public/reports/`

```bash
public/reports/
â”œâ”€â”€ incident_414186_2025-11-10T14-35-57.json         # ì „ì²´ ë°ì´í„° (~140KB)
â”œâ”€â”€ incident_414186_2025-11-10T14-35-57.md           # ë§ˆí¬ë‹¤ìš´ ë¦¬í¬íŠ¸ (~50KB)
â””â”€â”€ incident_414186_korean_2025-11-10T14-35-57.html  # í•œê¸€ HTML ë³´ê³ ì„œ (~80KB)
```

### ğŸ¤– AI ë¶„ì„ ê²°ê³¼ ì˜ˆì‹œ

```json
{
  "final_verdict": "needs_investigation",
  "overall_risk_score": 65,
  "confidence": 0.85,
  "executive_summary": "ì´ ì¸ì‹œë˜íŠ¸ëŠ” ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìˆ˜ì • ë° ì•…ì„±ì½”ë“œ íšë“ í–‰ìœ„ë¥¼ í¬í•¨í•˜ë©°, 10ê°œì˜ ìœ„í˜‘ íŒŒì¼ê³¼ 2ê°œì˜ MITRE ê¸°ë²•ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì¶”ê°€ ì¡°ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
  "key_findings": [
    "10ê°œì˜ ìœ„í˜‘ íŒŒì¼ ê°ì§€ (threat_level >= 50)",
    "MITRE T1112 (Modify Registry) ê°ì§€",
    "MITRE T1588.001 (Obtain Capabilities: Malware) ê°ì§€",
    "100ê°œì˜ CVE ë§¤ì¹­ (ëŒ€ë¶€ë¶„ fuzzy match)"
  ],
  "recommendations": [
    "ìœ„í˜‘ íŒŒì¼ ê²©ë¦¬ ë° ìƒì„¸ ë¶„ì„ ìˆ˜í–‰",
    "ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë³€ê²½ ì‚¬í•­ ê²€í† ",
    "ì—”ë“œí¬ì¸íŠ¸ CVE íŒ¨ì¹­ ì§„í–‰",
    "ë„¤íŠ¸ì›Œí¬ ì—°ê²° ëª¨ë‹ˆí„°ë§ ê°•í™”"
  ],
  "reasoning": "ë¶„ì„ê°€ê°€ false positiveë¡œ íŒë‹¨í–ˆìœ¼ë‚˜, ë‹¤ìˆ˜ì˜ ìœ„í˜‘ íŒŒì¼ê³¼ MITRE ê¸°ë²•ì´ ê°ì§€ë˜ì–´ ì¶”ê°€ ì¡°ì‚¬ê°€ ê¶Œì¥ë©ë‹ˆë‹¤."
}
```

### ğŸ“Š ì„±ëŠ¥ ì§€í‘œ

| í•­ëª© | ê°’ | ë¹„ê³  |
|------|------|------|
| **ì‹¤í–‰ ì‹œê°„** | 8-16ì´ˆ | ì „ì²´ íŒŒì´í”„ë¼ì¸ |
| **í† í° ì‚¬ìš©** | ~5.2K | ë¶„ì„ë‹¹ (68% ì ˆê°) |
| **ë¹„ìš©** | ~$0.001 | gpt-4o-mini ê¸°ì¤€ |
| **ë³‘ë ¬ ì²˜ë¦¬** | 6ê°œ ë™ì‹œ | 3-5x ì†ë„ í–¥ìƒ |
| **JSON í¬ê¸°** | ~140KB | ì „ì²´ ë°ì´í„° |
| **Markdown í¬ê¸°** | ~50KB | ë¦¬í¬íŠ¸ |

---

## ì¼ê°„ ë³´ê³ ì„œ ì‹œìŠ¤í…œ

### ğŸ“… ê°œìš”

ë§¤ì¼ ë°œìƒí•œ ì „ì²´ ì¸ì‹œë˜íŠ¸ë¥¼ ì§‘ê³„í•˜ê³  ë¶„ì„í•˜ì—¬ ì¼ì¼ ë³´ì•ˆ í˜„í™© ë³´ê³ ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

### ğŸš€ ë¹ ë¥¸ ì‹œì‘

```bash
# ì–´ì œ ë‚ ì§œë¡œ ë³´ê³ ì„œ ìƒì„±
./daily-report.sh

# íŠ¹ì • ë‚ ì§œë¡œ ë³´ê³ ì„œ ìƒì„±
./daily-report.sh 2025-11-10

# ìë™í™” ìŠ¤í¬ë¦½íŠ¸ (AI ë¶„ì„ ìë™ í¬í•¨/ì œì™¸)
./script/auto-daily-report.sh

# íŠ¹ì • ë‚ ì§œ ìë™ ë³´ê³ ì„œ
./script/auto-daily-report.sh 2025-11-10
```

### ğŸ“Š íŒŒì´í”„ë¼ì¸

```
daily-report.sh
    â”‚
    â”œâ”€ 1ë‹¨ê³„: collect-daily-incidents-data.ts (ë°ì´í„° ìˆ˜ì§‘)
    â”‚   â”œâ”€ OpenSearch 7ê°œ ì¸ë±ìŠ¤ ì¿¼ë¦¬
    â”‚   â”œâ”€ PostgreSQL TI/MITRE ë§¤ì¹­
    â”‚   â””â”€ ì¶œë ¥: daily_incidents_data_[ë‚ ì§œ].json
    â”‚
    â”œâ”€ 2ë‹¨ê³„: create-ai-analysis-prompt.ts (í”„ë¡¬í”„íŠ¸ ìƒì„±)
    â”‚   â”œâ”€ ë°ì´í„° êµ¬ì¡°í™”
    â”‚   â”œâ”€ JSON í…œí”Œë¦¿ í¬í•¨
    â”‚   â””â”€ ì¶œë ¥: ai_analysis_prompt_[ë‚ ì§œ].txt
    â”‚
    â”œâ”€ 3ë‹¨ê³„: run-ai-analysis.ts (AI ë¶„ì„) [ì„ íƒì ]
    â”‚   â”œâ”€ claude --print ì‹¤í–‰ ë˜ëŠ”
    â”‚   â”œâ”€ ê¸°ë³¸ í…œí”Œë¦¿ ì‚¬ìš©
    â”‚   â””â”€ ì¶œë ¥: ai_analysis_[ë‚ ì§œ].json â˜…
    â”‚
    â””â”€ 4ë‹¨ê³„: generate-final-report.ts (ë³´ê³ ì„œ ìƒì„±)
        â”œâ”€ HTML ë³´ê³ ì„œ (Tailwind CSS)
        â”œâ”€ Markdown ë³´ê³ ì„œ
        â””â”€ JSON í†µí•© ë³´ê³ ì„œ
```

### ğŸ“ ìƒì„± íŒŒì¼

```bash
public/reports/data/
â”œâ”€â”€ daily_incidents_data_2025-11-10.json  # ìˆ˜ì§‘ëœ ì›ë³¸ ë°ì´í„° (~500KB)
â””â”€â”€ ai_analysis_2025-11-10.json            # AI ë¶„ì„ ê²°ê³¼ (~20KB)

public/reports/daily/
â”œâ”€â”€ daily_report_2025-11-10.html           # HTML ë³´ê³ ì„œ (~150KB)
â”œâ”€â”€ daily_report_2025-11-10.md             # Markdown ë³´ê³ ì„œ (~80KB)
â””â”€â”€ daily_report_2025-11-10.json           # JSON í†µí•© ë³´ê³ ì„œ (~520KB)

/tmp/
â””â”€â”€ auto-daily-report-2025-11-10.log       # ì‹¤í–‰ ë¡œê·¸
```

### ğŸ¯ AI ë¶„ì„ ê²°ê³¼ êµ¬ì¡°

```json
{
  "executive_summary": "2025-11-10 ë°œìƒí•œ 61ê±´ì˜ ì¸ì‹œë˜íŠ¸ ì¤‘ 44.3%ê°€ False Positiveë¡œ íŒë‹¨ë˜ì—ˆìœ¼ë©°, 4-6ê±´ì˜ ì‹¤ì œ ìœ„í˜‘ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.",

  "threat_assessment": {
    "overall_risk_level": "low",
    "risk_score": 25,
    "confidence": 85,
    "key_findings": [
      "Critical ì‹¬ê°ë„: 0ê±´",
      "High ì‹¬ê°ë„: 8ê±´ (ì£¼ë¡œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìˆ˜ì •)",
      "Medium ì‹¬ê°ë„: 35ê±´",
      "Low ì‹¬ê°ë„: 18ê±´",
      "False Positive ë¹„ìœ¨: 44.3%"
    ]
  },

  "incident_analysis": {
    "critical_incidents_summary": "Critical ì‹¬ê°ë„ ì¸ì‹œë˜íŠ¸ ì—†ìŒ",
    "false_positive_rate": "44.3%",
    "true_threats_count": "4-6ê±´",
    "patterns_detected": [
      "ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìˆ˜ì • (MITRE T1112) - 8ê±´",
      "ì•…ì„±ì½”ë“œ íšë“ (MITRE T1588.001) - 3ê±´",
      "í”„ë¡œì„¸ìŠ¤ ì¸ì ì…˜ ì˜ì‹¬ - 2ê±´"
    ]
  },

  "recommendations": {
    "immediate_actions": [
      "High ì‹¬ê°ë„ 8ê±´ ì¤‘ False Positiveê°€ ì•„ë‹Œ 2-3ê±´ ìš°ì„  ê²€í† ",
      "MITRE T1112 íŒ¨í„´ì˜ ì •ìƒ í–‰ìœ„ whitelist ì¶”ê°€",
      "CVE íŒ¨ì¹­ ìš°ì„ ìˆœìœ„: CVE-2023-XXXX (CVSS 9.8)"
    ],
    "short_term": [
      "False Positive íŒ¨í„´ íŠœë‹ (í˜„ì¬ 44.3% â†’ ëª©í‘œ 30%)",
      "EDR ë£° ìµœì í™” (ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìˆ˜ì • ê´€ë ¨)",
      "ì—”ë“œí¬ì¸íŠ¸ ì—ì´ì „íŠ¸ ì—…ë°ì´íŠ¸ í™•ì¸"
    ],
    "long_term": [
      "MITRE ATT&CK ì»¤ë²„ë¦¬ì§€ í™•ëŒ€",
      "TI ë°ì´í„°ë² ì´ìŠ¤ ì£¼ê¸°ì  ì—…ë°ì´íŠ¸",
      "ìë™í™”ëœ í”Œë ˆì´ë¶ êµ¬ì¶•"
    ]
  },

  "security_posture_assessment": {
    "overall_grade": "B",
    "strengths": [
      "EDR ì»¤ë²„ë¦¬ì§€ ì–‘í˜¸ (29,578 incidents ìˆ˜ì§‘)",
      "TI ìƒê´€ë¶„ì„ í™œë°œ (PostgreSQL í†µí•©)",
      "ìë™í™” ì‹œìŠ¤í…œ ì•ˆì •ì  ìš´ì˜"
    ],
    "weaknesses": [
      "False Positive ë¹„ìœ¨ ë†’ìŒ (44.3%)",
      "Critical ì¸ì‹œë˜íŠ¸ ëŒ€ì‘ í”„ë¡œì„¸ìŠ¤ ë¯¸ê²€ì¦",
      "ì£¼ê°„/ì›”ê°„ íŠ¸ë Œë“œ ë¶„ì„ ë¶€ì¬"
    ],
    "improvement_priority": [
      "1ìˆœìœ„: False Positive íŠœë‹",
      "2ìˆœìœ„: ê³ ì‹¬ê°ë„ ì¸ì‹œë˜íŠ¸ í”Œë ˆì´ë¶",
      "3ìˆœìœ„: íŠ¸ë Œë“œ ë¶„ì„ ëŒ€ì‹œë³´ë“œ"
    ]
  }
}
```

### ğŸ”§ ì‹¤í–‰ ì˜ˆì‹œ

```bash
$ ./daily-report.sh 2025-11-10

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ğŸ“Š ì¼ê°„ ë³´ì•ˆ ë³´ê³ ì„œ ìƒì„± ì‹œì‘
  ë‚ ì§œ: 2025-11-10
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ë‹¨ê³„: ë°ì´í„° ìˆ˜ì§‘
âœ… 61ê±´ì˜ ì¸ì‹œë˜íŠ¸ ì¡°íšŒ ì™„ë£Œ
âœ… 20ê°œ ì¸ì‹œë˜íŠ¸ ìƒì„¸ ë¶„ì„ ì™„ë£Œ

2ë‹¨ê³„: AI ë¶„ì„ í”„ë¡¬í”„íŠ¸ ìƒì„±
âœ… í”„ë¡¬í”„íŠ¸ ìƒì„± ì™„ë£Œ (9,197ì)

3ë‹¨ê³„: Claude AI ë¶„ì„ ì‹¤í–‰
ğŸ¤– Claude AI ë¶„ì„ ì‹¤í–‰ ì¤‘...
âœ… AI ë¶„ì„ ì™„ë£Œ!

4ë‹¨ê³„: ìµœì¢… ë³´ê³ ì„œ ìƒì„±
âœ… HTML ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ!
âœ… Markdown ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ!
âœ… JSON ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ!

ğŸ“‹ AI ë¶„ì„ ë¯¸ë¦¬ë³´ê¸°:
  ìœ„í—˜ë„: LOW (25/100)
  ë³´ì•ˆ ë“±ê¸‰: B
  False Positive: 44.3%

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“„ ìƒì„±ëœ íŒŒì¼:
  â€¢ public/reports/daily/daily_report_2025-11-10.html
  â€¢ public/reports/daily/daily_report_2025-11-10.md
  â€¢ public/reports/daily/daily_report_2025-11-10.json

ğŸŒ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸:
  http://localhost:40017/reports/daily/daily_report_2025-11-10.html
```

---

## ì£¼ê°„ ë³´ê³ ì„œ ì‹œìŠ¤í…œ

### ğŸ“… ê°œìš”

7ì¼ê°„ì˜ ì¸ì‹œë˜íŠ¸ íŠ¸ë Œë“œë¥¼ ë¶„ì„í•˜ì—¬ ì£¼ê°„ ë³´ì•ˆ í˜„í™© ë³´ê³ ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

### ğŸš€ ì‚¬ìš© ë°©ë²•

```bash
# ì§€ë‚œ 7ì¼ ì£¼ê°„ ë³´ê³ ì„œ
./script/generate-weekly-report.sh

# íŠ¹ì • ë‚ ì§œ ê¸°ì¤€ 7ì¼ ë³´ê³ ì„œ
./script/generate-weekly-report.sh 2025-11-10

# MCP ë²„ì „
./script/generate-weekly-report-mcp.sh
```

### ğŸ“ ìƒì„± íŒŒì¼

```bash
public/reports/weekly/
â”œâ”€â”€ weekly_report_2025-W45.html           # HTML ë³´ê³ ì„œ
â”œâ”€â”€ weekly_report_2025-W45.md             # Markdown ë³´ê³ ì„œ
â””â”€â”€ weekly_report_2025-W45.json           # JSON ë°ì´í„°
```

### ğŸ“Š ì£¼ê°„ ë³´ê³ ì„œ ë‚´ìš©

1. **Executive Summary**
   - ì£¼ê°„ ì´ ì¸ì‹œë˜íŠ¸ ìˆ˜
   - ì „ì£¼ ëŒ€ë¹„ ì¦ê°ìœ¨
   - ì£¼ìš” ìœ„í˜‘ íŠ¸ë Œë“œ

2. **ì¼ë³„ íŠ¸ë Œë“œ ì°¨íŠ¸**
   - ì¼ë³„ ì¸ì‹œë˜íŠ¸ ë°œìƒ ê±´ìˆ˜
   - ì‹¬ê°ë„ë³„ ë¶„í¬

3. **Top 10 ìœ„í˜‘**
   - MITRE ATT&CK ê¸°ë²•
   - ê³µê²© ë²¡í„°
   - ì˜í–¥ë°›ì€ ì—”ë“œí¬ì¸íŠ¸

4. **ë³´ì•ˆ ë©”íŠ¸ë¦­**
   - í‰ê·  ëŒ€ì‘ ì‹œê°„
   - False Positive ë¹„ìœ¨
   - í•´ê²°ë¥ 

5. **ê¶Œì¥ ì‚¬í•­**
   - ì¦‰ì‹œ ì¡°ì¹˜ì‚¬í•­
   - ì¤‘ì¥ê¸° ê°œì„ ì‚¬í•­

---

## Claude Code í†µí•©

### ğŸ¯ ê³ í’ˆì§ˆ ë³´ê³ ì„œ ìƒì„±

Claude Sonnet 4.5ì˜ ê°•ë ¥í•œ ì¶”ë¡  ëŠ¥ë ¥ì„ í™œìš©í•œ ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œì…ë‹ˆë‹¤.

### ğŸš€ ì‚¬ìš© ë°©ë²•

```bash
# ë‹¨ì¼ ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬
claude --print "Investigate incident 414186"

# ì—¬ëŸ¬ ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬
claude --print "Investigate incidents 414186, 414187, 414188"

# ì£¼ê°„ ë³´ê³ ì„œ
claude --print "Generate weekly security report for last 7 days"

# False Positive ê²€ì¦
claude --print "Investigate incident 414186 and evaluate the likelihood of this being a false positive"
```

### ğŸ“Š í”„ë¡œì„¸ìŠ¤

```
ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸
    â†“
Claude Code
    â†“
MCP: collect_report_data
    â†“
ë°ì´í„° ìˆ˜ì§‘ (OpenSearch + TI)
    â†“
Claude Codeë¡œ ë°ì´í„° ë°˜í™˜
    â†“
Claude Sonnet 4.5 ë¶„ì„
    â†“
HTML ë³´ê³ ì„œ ìƒì„±
    â†“
íŒŒì¼ ì €ì¥ + ì•Œë¦¼
```

### ğŸ¨ ë³´ê³ ì„œ íŠ¹ì§•

- **Tailwind CSS** ìŠ¤íƒ€ì¼ë§
- **Chart.js** íƒ€ì„ë¼ì¸ ì°¨íŠ¸
- **ì¸í„°ë™í‹°ë¸Œ** ìš”ì†Œ (ì ‘ê¸°/í¼ì¹˜ê¸°)
- **ì¸ì‡„ ìµœì í™”**
- **ë‹¤í¬ëª¨ë“œ** ì§€ì›

### ğŸ“ ì¶œë ¥

```bash
data/reports/
â”œâ”€â”€ incident_414186_2025-11-10T16-30-00.html  # Claude ë¶„ì„ í¬í•¨ (~200KB)
â””â”€â”€ incident_414186_2025-11-10T16-30-00.json  # ì›ë³¸ ë°ì´í„° (~140KB)
```

### ğŸ“Š ê¸°ì¡´ ì‹œìŠ¤í…œ vs Claude Code ì‹œìŠ¤í…œ

| ê¸°ëŠ¥ | CLI ìë™í™” | Claude Code |
|------|-----------|---------------------|
| **AI ëª¨ë¸** | Azure gpt-4o-mini | Claude Sonnet 4.5 |
| **ë¶„ì„ ê¹Šì´** | ì–•ìŒ (500 í† í°) | ê¹ŠìŒ (ì „ì²´ ì»¨í…ìŠ¤íŠ¸) |
| **ë³´ê³ ì„œ í˜•ì‹** | ë§ˆí¬ë‹¤ìš´ | HTML (Tailwind + Charts) |
| **ì‹œê°í™”** | ì—†ìŒ | ì°¨íŠ¸, íƒ€ì„ë¼ì¸, ë§¤íŠ¸ë¦­ìŠ¤ |
| **ì†ë„** | ë¹ ë¦„ (8-16ì´ˆ) | ëŠë¦¼ (30-60ì´ˆ) |
| **ë¹„ìš©** | ì €ë ´ ($0.001) | ë¹„ìŒˆ ($0.02) |
| **ìš©ë„** | ìë™í™”, íŠ¸ë¦¬ì•„ì§€ | ê²½ì˜ì§„ ë³´ê³ , ì‹¬ì¸µ ë¶„ì„ |
| **ìƒíƒœ** | âœ… ìœ ì§€ë¨ | âœ… ì¶”ê°€ë¨ |

**ê²°ë¡ **: ë‘ ì‹œìŠ¤í…œ ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥í•˜ë©°, ìƒí™©ì— ë”°ë¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ìë™í™” ë° ìŠ¤ì¼€ì¤„ë§

### ğŸ• Cron Job ì„¤ì •

#### ì˜µì…˜ 1: ì¼ê°„ ë³´ê³ ì„œ (ë§¤ì¼ ìƒˆë²½ 1ì‹œ)

```bash
# crontab í¸ì§‘
crontab -e

# ì•„ë˜ ë¼ì¸ ì¶”ê°€
0 1 * * * cd /www/ib-editor/my-app && ./script/auto-daily-report.sh >> /var/log/daily-report.log 2>&1
```

#### ì˜µì…˜ 2: ì£¼ê°„ ë³´ê³ ì„œ (ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œ)

```bash
# ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œì— ì§€ë‚œì£¼ ë³´ê³ ì„œ ìƒì„±
0 9 * * 1 cd /www/ib-editor/my-app && ./script/generate-weekly-report.sh >> /var/log/weekly-report.log 2>&1
```

#### ì˜µì…˜ 3: ì¸ì‹œë˜íŠ¸ ìë™ ì¡°ì‚¬ (ë§¤ì‹œê°„)

```bash
# ë§¤ì‹œ ì •ê° ì‹¤í–‰
0 * * * * cd /www/ib-editor/my-app && npx tsx script/cron-investigate.ts --once >> /var/log/incident-cron.log 2>&1
```

#### ì˜µì…˜ 4: ì£¼ë§ ì œì™¸ (ì›”-ê¸ˆë§Œ ì‹¤í–‰)

```bash
# ì›”-ê¸ˆ ì˜¤ì „ 8ì‹œì— ì‹¤í–‰
0 8 * * 1-5 cd /www/ib-editor/my-app && ./script/auto-daily-report.sh >> /var/log/daily-report.log 2>&1
```

### âœ… Cron Job ê²€ì¦

```bash
# í˜„ì¬ cron job ëª©ë¡ í™•ì¸
crontab -l

# ì‹¤í–‰ ë¡œê·¸ í™•ì¸
tail -f /var/log/daily-report.log

# ìˆ˜ë™ í…ŒìŠ¤íŠ¸
cd /www/ib-editor/my-app && ./script/auto-daily-report.sh
```

### ğŸ”” ì•Œë¦¼ ì„¤ì • (ì„ íƒì )

#### Supabase

```bash
# .env.local
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
```

**í…Œì´ë¸” ìƒì„±**:
```sql
CREATE TABLE incident_reports (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  incident_id TEXT NOT NULL,
  report_type TEXT NOT NULL,
  report_path TEXT NOT NULL,
  risk_score INTEGER,
  verdict TEXT,
  generated_at TIMESTAMP WITH TIME ZONE NOT NULL,
  generated_by TEXT NOT NULL,
  incident_count INTEGER,
  status TEXT DEFAULT 'completed',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### Slack

```bash
# .env.local
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
```

#### Discord

```bash
# .env.local
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...
```

---

## ì•„í‚¤í…ì²˜

### ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
/www/ib-editor/my-app/
â”œâ”€â”€ script/                                # 47+ ìë™í™” ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ investigate-incident-cli.ts        # CLI ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬
â”‚   â”œâ”€â”€ cron-investigate.ts                # Cron Job ìë™ ì¡°ì‚¬
â”‚   â”œâ”€â”€ watch-incidents.ts                 # File Watcher
â”‚   â”‚
â”‚   â”œâ”€â”€ collect-daily-incidents-data.ts    # ì¼ê°„ ë°ì´í„° ìˆ˜ì§‘
â”‚   â”œâ”€â”€ create-ai-analysis-prompt.ts       # AI í”„ë¡¬í”„íŠ¸ ìƒì„±
â”‚   â”œâ”€â”€ run-ai-analysis.ts                 # AI ë¶„ì„ ì‹¤í–‰
â”‚   â”œâ”€â”€ generate-final-report.ts           # ìµœì¢… ë³´ê³ ì„œ ìƒì„±
â”‚   â”‚
â”‚   â”œâ”€â”€ auto-daily-report.sh               # ì¼ê°„ ë³´ê³ ì„œ ìë™í™”
â”‚   â”œâ”€â”€ generate-weekly-report.sh          # ì£¼ê°„ ë³´ê³ ì„œ
â”‚   â”‚
â”‚   â”œâ”€â”€ nl-query-parser.ts                 # ìì—°ì–´ â†’ DSL ë³€í™˜
â”‚   â”œâ”€â”€ nl-query-mcp.js                    # NL Query MCP ì„œë²„
â”‚   â”œâ”€â”€ incident-report-mcp.js             # Incident Report MCP ì„œë²„
â”‚   â”œâ”€â”€ claude-investigation-mcp.js        # Claude Investigation MCP ì„œë²„
â”‚   â”‚
â”‚   â”œâ”€â”€ opensearch-executor.ts             # OpenSearch ì¿¼ë¦¬ ì—”ì§„
â”‚   â”œâ”€â”€ ti-correlator.ts                   # TI ìƒê´€ ë¶„ì„ (PostgreSQL)
â”‚   â”œâ”€â”€ investigation-cache.ts             # ê²°ê³¼ ì €ì¥/ë¡œë“œ
â”‚   â”œâ”€â”€ ai-data-filter.ts                  # í† í° ìµœì í™” í•„í„°
â”‚   â”œâ”€â”€ ai-parallel-analyzer.ts            # AI ë³‘ë ¬ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°
â”‚   â”‚
â”‚   â””â”€â”€ ai-analyzers/                      # 7ê°œ AI ë¶„ì„ê¸°
â”‚       â”œâ”€â”€ analyst-verifier.ts            # ë¶„ì„ê°€ ê²€ì¦
â”‚       â”œâ”€â”€ file-hash-analyzer.ts          # íŒŒì¼ ìœ„í˜‘ ë¶„ì„
â”‚       â”œâ”€â”€ network-analyzer.ts            # ë„¤íŠ¸ì›Œí¬ ë¶„ì„
â”‚       â”œâ”€â”€ mitre-analyzer.ts              # MITRE ë¶„ì„
â”‚       â”œâ”€â”€ cve-analyzer.ts                # CVE ê²€ì¦
â”‚       â”œâ”€â”€ endpoint-analyzer.ts           # ì—”ë“œí¬ì¸íŠ¸ ë¶„ì„
â”‚       â””â”€â”€ synthesizer.ts                 # ì¢…í•© íŒë‹¨
â”‚
â”œâ”€â”€ public/reports/                        # ìƒì„±ëœ ë³´ê³ ì„œ
â”‚   â”œâ”€â”€ data/                              # ì›ë³¸ ë°ì´í„° (JSON)
â”‚   â”œâ”€â”€ daily/                             # ì¼ê°„ ë³´ê³ ì„œ (HTML/MD/JSON)
â”‚   â”œâ”€â”€ weekly/                            # ì£¼ê°„ ë³´ê³ ì„œ
â”‚   â””â”€â”€ incident_*/                        # ê°œë³„ ì¸ì‹œë˜íŠ¸ ë¶„ì„
â”‚
â”œâ”€â”€ test/                                  # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ quick-test.sh                      # ë¹ ë¥¸ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ test-azure.sh                      # Azure OpenAI í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ test-mcp-*.sh                      # MCP ì„œë²„ í…ŒìŠ¤íŠ¸
â”‚
â”œâ”€â”€ .mcp.json                              # MCP ì„œë²„ ì„¤ì • (11ê°œ)
â”œâ”€â”€ .env.local                             # í™˜ê²½ ë³€ìˆ˜
â”‚
â”œâ”€â”€ daily-report.sh                        # ì¼ê°„ ë³´ê³ ì„œ ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
â”‚
â””â”€â”€ ë¬¸ì„œ/
    â”œâ”€â”€ README_INVESTIGATION.md            # ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬ ì‹œìŠ¤í…œ
    â”œâ”€â”€ README-DAILY-REPORT.md             # ì¼ê°„ ë³´ê³ ì„œ
    â”œâ”€â”€ CRON_SETUP.md                      # Cron Job ì„¤ì •
    â”œâ”€â”€ CLAUDE_REPORTS_README.md           # Claude Code ë³´ê³ ì„œ
    â””â”€â”€ INCIDENT_REPORTS_COMPREHENSIVE_GUIDE.md  # ì´ íŒŒì¼ â˜…
```

### ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤

#### 1. OpenSearch (`opensearch:9200` â†’ `20.41.120.173:9200`)

**ì¸ë±ìŠ¤**:
- `logs-cortex_xdr-incidents-*` - ì¸ì‹œë˜íŠ¸ (~29,578ê±´)
- `logs-cortex_xdr-alerts-*` - ì•ŒëŸ¿
- `logs-cortex_xdr-files-*` - íŒŒì¼
- `logs-cortex_xdr-networks-*` - ë„¤íŠ¸ì›Œí¬ ì—°ê²°
- `logs-cortex_xdr-processes-*` - í”„ë¡œì„¸ìŠ¤
- `logs-cortex_xdr-endpoints-*` - ì—”ë“œí¬ì¸íŠ¸
- `logs-cortex_xdr-causality_chains-*` - ì¸ê³¼ê´€ê³„ ì²´ì¸

**ì¸ì¦**: `admin:Admin@123456`

#### 2. PostgreSQL n8n (`postgres:5432/n8n` â†’ `20.41.120.173`)

**ìŠ¤í‚¤ë§ˆ**: `ioclog`

**í…Œì´ë¸”**:
- `ioclog.ioc_log` - IOC ë¡œê·¸ (íŒŒì¼ í•´ì‹œ, IP ì£¼ì†Œ)
- `ioclog.mitre_techniques` - MITRE ATT&CK ê¸°ë²•
- `ioclog.cve_details` - CVE ìƒì„¸ ì •ë³´

#### 3. PostgreSQL Editor (`localhost:5432/postgres`)

**í…Œì´ë¸”**:
- `users` - ì‚¬ìš©ì ê´€ë¦¬
- `dashboard_config` - ëŒ€ì‹œë³´ë“œ ì„¤ì •
- `saved_queries` - ì €ì¥ëœ ì¿¼ë¦¬

### ğŸ”§ MCP ì„œë²„ (12ê°œ)

**í‘œì¤€ ì„œë²„**:
1. `next-devtools` - Next.js ê°œë°œ ë„êµ¬
2. `chrome-devtools` - ë¸Œë¼ìš°ì € ë””ë²„ê¹…
3. `context7` - ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì„œ
4. `shadcn` - shadcn/ui ì»´í¬ë„ŒíŠ¸
5. `memory` - ì§€ì†ì  ì§€ì‹ ê·¸ë˜í”„

**ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„**:
6. `postgres-editor` - ë¡œì»¬ ì—ë””í„° DB (`localhost:5432/postgres`)
7. `postgres-siem` - SIEM DB (`localhost:5432/siem_db`)
8. `postgres-n8n` - n8n TI DB (`postgres:5432/n8n`)

**ì»¤ìŠ¤í…€ ë³´ì•ˆ ì„œë²„** â­:
9. `opensearch` - OpenSearch ì¿¼ë¦¬ ì¸í„°í˜ì´ìŠ¤ (í¬íŠ¸ 8099)
10. `incident-analysis` - í†µê³„, íŠ¸ë Œë“œ, ìœ„í˜‘ ë¶„ì„ (í¬íŠ¸ 8100)
11. `nl-query` - ìì—°ì–´ â†’ OpenSearch DSL ë³€í™˜ê¸°
12. `claude-investigation` - Claude ê¸°ë°˜ í•œê¸€ ë³´ê³ ì„œ ìƒì„±

---

### ğŸ“˜ MCP ì„œë²„ ìƒì„¸ ì„¤ëª…

#### 1. `next-devtools` MCP
**ì„¤ëª…**: Next.js 16+ ê°œë°œ ë„êµ¬ (MCPëŠ” ê¸°ë³¸ í™œì„±í™”)

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"Show me the Next.js runtime information"
"List all Next.js routes"
"Get Next.js build diagnostics"
```

**ë„êµ¬**:
- `discover_servers` - ì‹¤í–‰ ì¤‘ì¸ Next.js ì„œë²„ ì°¾ê¸°
- `list_tools` - ì‚¬ìš© ê°€ëŠ¥í•œ MCP ë„êµ¬ ëª©ë¡
- `call_tool` - Next.js ëŸ°íƒ€ì„ ë„êµ¬ í˜¸ì¶œ

#### 2. `chrome-devtools` MCP
**ì„¤ëª…**: Chrome DevTools Protocol - ë¸Œë¼ìš°ì € ë””ë²„ê¹… ë° ì„±ëŠ¥ ë¶„ì„

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"Take a screenshot of the page"
"Get console messages"
"Analyze network requests"
"Start performance trace"
```

**ë„êµ¬**:
- `navigate_page` - í˜ì´ì§€ ì´ë™
- `take_screenshot` - ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜
- `list_console_messages` - ì½˜ì†” ë¡œê·¸ ì¡°íšŒ
- `list_network_requests` - ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì¡°íšŒ
- `performance_start_trace` - ì„±ëŠ¥ ì¶”ì  ì‹œì‘

#### 3. `context7` MCP
**ì„¤ëª…**: ìµœì‹  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì„œ (Next.js, React, TypeScript, OpenSearch, Prisma ë“±)

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"use context7: Show me Next.js App Router documentation"
"use context7: How do I use React hooks?"
"use context7: OpenSearch query DSL examples"
```

**ë„êµ¬**:
- `resolve-library-id` - ë¼ì´ë¸ŒëŸ¬ë¦¬ ID ê²€ìƒ‰
- `get-library-docs` - ë¬¸ì„œ ê°€ì ¸ì˜¤ê¸°

#### 4. `shadcn` MCP
**ì„¤ëª…**: shadcn/ui ì»´í¬ë„ŒíŠ¸ ê´€ë¦¬

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"List available shadcn components"
"Show me the button component example"
"Add shadcn dialog component"
```

**ë„êµ¬**:
- `get_project_registries` - ë ˆì§€ìŠ¤íŠ¸ë¦¬ ëª©ë¡
- `search_items_in_registries` - ì»´í¬ë„ŒíŠ¸ ê²€ìƒ‰
- `view_items_in_registries` - ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ì •ë³´
- `get_item_examples_from_registries` - ì‚¬ìš© ì˜ˆì‹œ
- `get_add_command_for_items` - ì„¤ì¹˜ ëª…ë ¹ì–´

#### 5. `memory` MCP
**ì„¤ëª…**: ì§€ì†ì  ì§€ì‹ ê·¸ë˜í”„ - ëŒ€í™” ê°„ ì •ë³´ ê¸°ì–µ

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"Remember that incident 414186 is a false positive"
"What do you know about user john_doe?"
"Create a knowledge graph for this project"
```

**ë„êµ¬**:
- `create_entities` - ì—”í‹°í‹° ìƒì„±
- `create_relations` - ê´€ê³„ ìƒì„±
- `add_observations` - ê´€ì°° ì¶”ê°€
- `search_nodes` - ë…¸ë“œ ê²€ìƒ‰
- `read_graph` - ì „ì²´ ê·¸ë˜í”„ ì½ê¸°

#### 6-8. PostgreSQL MCP ì„œë²„
**ì„¤ëª…**: PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬

**ì‚¬ìš© ì˜ˆì‹œ**:
```sql
-- postgres-n8n ì˜ˆì‹œ
"Query the n8n database: SELECT COUNT(*) FROM ioclog.ioc_log WHERE threat_verdict = 'threat'"
"Show me recent IOC logs from PostgreSQL"
```

**ë„êµ¬**:
- `query` - SQL ì¿¼ë¦¬ ì‹¤í–‰ (ì½ê¸° ì „ìš©)

#### 9. `opensearch` MCP â­
**ì„¤ëª…**: OpenSearch MCP - ë³´ì•ˆ ë¡œê·¸ ê²€ìƒ‰ ë° ì¿¼ë¦¬ (ì›ê²© ì„œë²„ í¬íŠ¸ 8099)

**ì—°ê²° ì •ë³´**:
- URL: `http://20.41.120.173:8099`
- ì¸ë±ìŠ¤: `logs-cortex_xdr-*`

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"Search OpenSearch for high severity incidents"
"Get incident 414186 from OpenSearch"
"Count alerts from last 7 days"
```

**ë„êµ¬**:
- `Index_Lister` - ì¸ë±ìŠ¤ ëª©ë¡ ì¡°íšŒ
- `IndexMappingTool` - ì¸ë±ìŠ¤ ë§¤í•‘ ì •ë³´
- `Index_Searcher` - Query DSL ê²€ìƒ‰
- `Cluster_Health_Checker` - í´ëŸ¬ìŠ¤í„° ìƒíƒœ
- `CountTool` - ë¬¸ì„œ ì¹´ìš´íŠ¸
- `MsearchTool` - ë‹¤ì¤‘ ê²€ìƒ‰

**ì˜ˆì œ**:
```json
{
  "tool": "Index_Searcher",
  "parameters": {
    "index": "logs-cortex_xdr-incidents-*",
    "query": {
      "query": {
        "bool": {
          "must": [
            {"match": {"incident_id": "414186"}}
          ]
        }
      }
    }
  }
}
```

#### 10. `incident-analysis` MCP â­
**ì„¤ëª…**: ì¸ì‹œë˜íŠ¸ ë¶„ì„ MCP - í†µê³„, íŠ¸ë Œë“œ, ì°¨íŠ¸, ìœ„í˜‘ ë¶„ì„, ë³´ê³ ì„œ ìƒì„± (ì›ê²© ì„œë²„ í¬íŠ¸ 8100)

**ì—°ê²° ì •ë³´**:
- URL: `http://20.41.120.173:8100`
- ì–¸ì–´: í•œêµ­ì–´ ì¶œë ¥

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"Show me incident statistics for last 7 days"
"Create incident trend chart"
"Analyze top threats"
"Generate comprehensive incident report"
```

**ë„êµ¬**:
1. **get_incident_statistics**
   - ì¸ì‹œë˜íŠ¸ í†µê³„ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ìƒì„±
   - íŒŒë¼ë¯¸í„°:
     - `index_pattern` (ê¸°ë³¸: `logs-cortex_xdr-incidents-*`)
     - `days` (ê¸°ë³¸: 7ì¼)
     - `severity_field` (ê¸°ë³¸: `severity`)

2. **create_incident_trend_chart**
   - ì‹œê°„ë³„/ì¼ë³„ íŠ¸ë Œë“œ ì°¨íŠ¸ ìƒì„±
   - íŒŒë¼ë¯¸í„°:
     - `index_pattern`
     - `days` (ê¸°ë³¸: 7ì¼)
     - `interval` (`1h` ë˜ëŠ” `1d`)

3. **analyze_top_threats**
   - ìƒìœ„ ìœ„í˜‘ ìœ í˜• ë¶„ì„ ë° ì°¨íŠ¸ ìƒì„±
   - íŒŒë¼ë¯¸í„°:
     - `index_pattern`
     - `days` (ê¸°ë³¸: 7ì¼)
     - `threat_field` (ê¸°ë³¸: `threat_type`)
     - `top_count` (ê¸°ë³¸: 10ê°œ)

4. **generate_incident_report**
   - ì¢…í•© ì¸ì‹œë˜íŠ¸ ë¶„ì„ ë³´ê³ ì„œ ìƒì„±
   - íŒŒë¼ë¯¸í„°:
     - `index_pattern`
     - `days` (ê¸°ë³¸: 7ì¼)
     - `report_title` (ê¸°ë³¸: "ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë¶„ì„ ë³´ê³ ì„œ")

5. **analyze_geographic_distribution**
   - ì§€ë¦¬ì  ë¶„í¬ ë¶„ì„ ë° ì‹œê°í™”
   - íŒŒë¼ë¯¸í„°:
     - `index_pattern`
     - `days` (ê¸°ë³¸: 7ì¼)
     - `geo_field` (ê¸°ë³¸: `geoip.country_name`)

**ì˜ˆì œ**:
```json
{
  "tool": "get_incident_statistics",
  "parameters": {
    "index_pattern": "logs-cortex_xdr-incidents-*",
    "days": 7,
    "severity_field": "severity"
  }
}
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```markdown
# ì¸ì‹œë˜íŠ¸ í†µê³„ (ìµœê·¼ 7ì¼)

| ì‹¬ê°ë„ | ê±´ìˆ˜ | ë¹„ìœ¨ |
|--------|------|------|
| Critical | 0 | 0.0% |
| High | 8 | 13.1% |
| Medium | 35 | 57.4% |
| Low | 18 | 29.5% |
| **ì´ê³„** | **61** | **100%** |
```

#### 11. `nl-query` MCP â­
**ì„¤ëª…**: NL-Query MCP - ìì—°ì–´ ì§ˆë¬¸ì„ OpenSearch ì¿¼ë¦¬ë¡œ ë³€í™˜í•˜ê³  ì‹¤í–‰

**ì—°ê²° ì •ë³´**:
- ìŠ¤í¬ë¦½íŠ¸: `/www/ib-editor/my-app/script/nl-query-mcp.js`
- AI ëª¨ë¸: Azure OpenAI `gpt-4o-mini` (ê¸°ë³¸)

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"ìµœê·¼ 7ì¼ê°„ Critical ì‹¬ê°ë„ ì¸ì‹œë˜íŠ¸ ê°œìˆ˜"
"ì–´ì œ ë°œìƒí•œ ì•ŒëŸ¿ ëª©ë¡ ë³´ì—¬ì¤˜"
"ì´ë²ˆ ë‹¬ ì¸ì‹œë˜íŠ¸ ë³´ê³ ì„œ"
"ì§€ë‚œì£¼ High ì‹¬ê°ë„ Microsoft Defender ì¸ì‹œë˜íŠ¸"
```

**ë„êµ¬**:
1. **nl_query**
   - ìì—°ì–´ ì§ˆë¬¸ì„ OpenSearch ì¿¼ë¦¬ë¡œ ë³€í™˜í•˜ê³  ì‹¤í–‰
   - íŒŒë¼ë¯¸í„°:
     - `query` (í•„ìˆ˜) - ìì—°ì–´ ì§ˆë¬¸ (í•œêµ­ì–´ ë˜ëŠ” ì˜ì–´)
     - `model` (ì„ íƒ) - AI ëª¨ë¸ (ê¸°ë³¸: `azure-gpt-4o-mini`)
       - `azure-gpt-4o-mini` (ê¶Œì¥)
       - `claude-3-5-sonnet`
       - `gemini-2.0-flash`
       - `azure-gpt-35-turbo`
       - `claude-3-haiku`
       - `gemini-2.5-pro`
     - `execute` (ì„ íƒ) - ì¿¼ë¦¬ ì‹¤í–‰ ì—¬ë¶€ (ê¸°ë³¸: `true`)
     - `format` (ì„ íƒ) - ê²°ê³¼ í˜•ì‹ (ê¸°ë³¸: `["markdown", "json"]`)

2. **test_parse**
   - íŒŒì‹±ë§Œ í…ŒìŠ¤íŠ¸ (ì¿¼ë¦¬ ì‹¤í–‰ ì•ˆ í•¨)
   - íŒŒë¼ë¯¸í„°:
     - `query` (í•„ìˆ˜) - ìì—°ì–´ ì§ˆë¬¸
     - `model` (ì„ íƒ) - AI ëª¨ë¸

**ì§€ì› ê¸°ëŠ¥**:
- **30+ ë‚ ì§œ í‘œí˜„**: "ì–´ì œ", "ì§€ë‚œì£¼", "ìµœê·¼ 7ì¼", "3ì¼ ì „", "ì´ë²ˆ ë‹¬"
- **8ê°€ì§€ ë°ì´í„° íƒ€ì…**: incidents, alerts, files, networks, processes, endpoints, causality_chains, cves
- **5ê°€ì§€ ì¿¼ë¦¬ íƒ€ì…**: search, aggregation, filter, range, stats

**ì˜ˆì œ**:
```json
{
  "tool": "nl_query",
  "parameters": {
    "query": "ìµœê·¼ 7ì¼ê°„ Critical ì‹¬ê°ë„ ì¸ì‹œë˜íŠ¸ ê°œìˆ˜",
    "model": "azure-gpt-4o-mini",
    "execute": true,
    "format": ["markdown", "json"]
  }
}
```

**íŒŒì‹± ê²°ê³¼ ì˜ˆì‹œ**:
```json
{
  "queryType": "aggregation",
  "dataTypes": ["incidents"],
  "indexPattern": "logs-cortex_xdr-incidents-*",
  "filters": [
    {
      "field": "severity",
      "operator": "equals",
      "value": "critical"
    }
  ],
  "dateRange": {
    "from": "now-7d",
    "to": "now"
  }
}
```

**ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ**:
```markdown
# ì¿¼ë¦¬ ê²°ê³¼

**ì´ ê±´ìˆ˜**: 0ê±´

## ì¸ë±ìŠ¤
- logs-cortex_xdr-incidents-*

## í•„í„°
- severity = critical
- @timestamp: ìµœê·¼ 7ì¼

## ì‹¤í–‰ ì‹œê°„
23ms
```

#### 12. `claude-investigation` MCP â­
**ì„¤ëª…**: Claude Investigation - Claude Codeê°€ ì§ì ‘ ì¸ì‹œë˜íŠ¸ë¥¼ ë¶„ì„í•˜ê³  í•œê¸€ ë³´ê³ ì„œ ìƒì„±

**ì—°ê²° ì •ë³´**:
- ìŠ¤í¬ë¦½íŠ¸: `/www/ib-editor/my-app/script/claude-investigation-mcp.js`
- ì¶œë ¥: í•œê¸€ HTML ë³´ê³ ì„œ

**ì‚¬ìš© í”„ë¡œì„¸ìŠ¤**:
```
1. collect_incident_dataë¡œ ë°ì´í„° ìˆ˜ì§‘
   â†“
2. Claude Codeê°€ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  AI ì˜ê²¬ ì‘ì„±
   â†“
3. save_analysis_and_generate_reportë¡œ ë³´ê³ ì„œ ìƒì„±
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```
"Investigate incident 414186 using claude-investigation MCP"
```

**ë„êµ¬**:
1. **collect_incident_data**
   - ì¸ì‹œë˜íŠ¸ ë°ì´í„° ìˆ˜ì§‘ (AI ë¶„ì„ ì—†ì´ ì›ë³¸ ë°ì´í„°ë§Œ)
   - íŒŒë¼ë¯¸í„°:
     - `incident_id` (í•„ìˆ˜) - ì¸ì‹œë˜íŠ¸ ID
   - ì¶œë ¥:
     - ì¸ì‹œë˜íŠ¸ ìƒì„¸ ì •ë³´
     - ì•ŒëŸ¿, íŒŒì¼, ë„¤íŠ¸ì›Œí¬, í”„ë¡œì„¸ìŠ¤, ì—”ë“œí¬ì¸íŠ¸
     - TI ìƒê´€ë¶„ì„ ê²°ê³¼
     - MITRE ATT&CK ë§¤í•‘
     - CVE ìƒì„¸ ì •ë³´

2. **save_analysis_and_generate_report**
   - Claudeê°€ ì‘ì„±í•œ AI ë¶„ì„ ì˜ê²¬ì„ ì €ì¥í•˜ê³  í•œê¸€ HTML ë³´ê³ ì„œ ìƒì„±
   - íŒŒë¼ë¯¸í„°:
     - `incident_id` (í•„ìˆ˜)
     - `analysis` (í•„ìˆ˜) - Claudeê°€ ì‘ì„±í•œ ë¶„ì„ ê°ì²´
       - `incident_detail` - ì¸ì‹œë˜íŠ¸ ìƒì„¸ ë¶„ì„ (í•œê¸€)
       - `endpoint_analysis` - ì—”ë“œí¬ì¸íŠ¸ ë¶„ì„ (í•œê¸€)
       - `file_artifacts` - íŒŒì¼ ì•„í‹°íŒ©íŠ¸ ë¶„ì„ (í•œê¸€)
       - `network_artifacts` - ë„¤íŠ¸ì›Œí¬ ë¶„ì„ (í•œê¸€)
       - `mitre_analysis` - MITRE ATT&CK ë¶„ì„ (í•œê¸€)
       - `final_verdict` - ìµœì¢… ì¢…í•© ì˜ê²¬
         - `verdict` - íŒì • (`false_positive`, `true_positive`, `needs_investigation`)
         - `risk_score` - ìœ„í—˜ ì ìˆ˜ (0-100)
         - `confidence` - ì‹ ë¢°ë„ (0-100)
         - `summary` - ì¢…í•© ìš”ì•½ (í•œê¸€)
         - `key_findings` - ì£¼ìš” ë°œê²¬ì‚¬í•­ ëª©ë¡

**ì˜ˆì œ**:
```json
// 1ë‹¨ê³„: ë°ì´í„° ìˆ˜ì§‘
{
  "tool": "collect_incident_data",
  "parameters": {
    "incident_id": "414186"
  }
}

// 2ë‹¨ê³„: Claudeê°€ ë¶„ì„ ì‘ì„± (í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ)
"ìœ„ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ í•œê¸€ ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:
- incident_detail: ì¸ì‹œë˜íŠ¸ ìƒì„¸ ë¶„ì„
- endpoint_analysis: ì—”ë“œí¬ì¸íŠ¸ ë¶„ì„
- file_artifacts: íŒŒì¼ ì•„í‹°íŒ©íŠ¸ ë¶„ì„
- network_artifacts: ë„¤íŠ¸ì›Œí¬ ë¶„ì„
- mitre_analysis: MITRE ATT&CK ë¶„ì„
- final_verdict: ìµœì¢… íŒì • (verdict, risk_score, confidence, summary, key_findings)"

// 3ë‹¨ê³„: ë³´ê³ ì„œ ìƒì„±
{
  "tool": "save_analysis_and_generate_report",
  "parameters": {
    "incident_id": "414186",
    "analysis": {
      "incident_detail": "ì´ ì¸ì‹œë˜íŠ¸ëŠ”...",
      "endpoint_analysis": "ì—”ë“œí¬ì¸íŠ¸ ktc-d111783ì—ì„œ...",
      "file_artifacts": "10ê°œì˜ ìœ„í˜‘ íŒŒì¼ì´ ê°ì§€...",
      "network_artifacts": "87ê°œì˜ ë„¤íŠ¸ì›Œí¬ ì—°ê²°...",
      "mitre_analysis": "MITRE T1112 (ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìˆ˜ì •)...",
      "final_verdict": {
        "verdict": "needs_investigation",
        "risk_score": 65,
        "confidence": 85,
        "summary": "ì¶”ê°€ ì¡°ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
        "key_findings": ["10ê°œì˜ ìœ„í˜‘ íŒŒì¼ ê°ì§€", "MITRE T1112 ê°ì§€"]
      }
    }
  }
}
```

**ì¶œë ¥ íŒŒì¼**:
```bash
public/reports/
â””â”€â”€ incident_414186_korean_2025-11-10T14-35-57.html  # í•œê¸€ HTML ë³´ê³ ì„œ (~80KB)
```

---

### ğŸ”§ MCP ì„œë²„ ì„¤ì • (.mcp.json)

ì „ì²´ MCP ì„œë²„ ì„¤ì •ì€ `/www/ib-editor/my-app/.mcp.json` íŒŒì¼ì— ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

**ì£¼ìš” í™˜ê²½ ë³€ìˆ˜**:
```json
{
  "nl-query": {
    "env": {
      "AZURE_OPENAI_ENDPOINT": "https://etech-openai.openai.azure.com/",
      "AZURE_OPENAI_DEPLOYMENT": "gpt-4o-mini",
      "OPENSEARCH_URL": "http://opensearch:9200",
      "OPENSEARCH_USER": "admin",
      "OPENSEARCH_PASSWORD": "Admin@123456"
    }
  },
  "claude-investigation": {
    "env": {
      "OPENSEARCH_URL": "http://opensearch:9200",
      "OPENSEARCH_USER": "admin",
      "OPENSEARCH_PASSWORD": "Admin@123456",
      "DATABASE_URL": "postgresql://postgres:postgres@postgres:5432/n8n?schema=ioclog"
    }
  }
}
```

**MCP ì„œë²„ ì¬ì‹œì‘**:
`.mcp.json` íŒŒì¼ì„ ìˆ˜ì •í•œ í›„ì—ëŠ” **Claude Codeë¥¼ ì™„ì „íˆ ì¬ì‹œì‘**í•´ì•¼ í•©ë‹ˆë‹¤ (ë‹¨ìˆœ ìƒˆ ëŒ€í™”ê°€ ì•„ë‹ˆë¼ ì•± ìì²´ë¥¼ ì¢…ë£Œí–ˆë‹¤ê°€ ì¬ì‹œì‘).

---

### ğŸ“š MCP ì‚¬ìš© ì˜ˆì‹œ

#### ì˜ˆì‹œ 1: ìì—°ì–´ ì¿¼ë¦¬ â†’ ê²°ê³¼

```
"ìµœê·¼ 7ì¼ê°„ Critical ì‹¬ê°ë„ ì¸ì‹œë˜íŠ¸ ê°œìˆ˜"
```

**ì²˜ë¦¬ ê³¼ì •**:
1. Claude Codeê°€ `nl-query` MCP ë„êµ¬ ì¸ì‹
2. `nl_query` ë„êµ¬ í˜¸ì¶œ
3. ìì—°ì–´ â†’ OpenSearch DSL ë³€í™˜ (Azure OpenAI)
4. OpenSearch ì¿¼ë¦¬ ì‹¤í–‰
5. Markdown + JSON ê²°ê³¼ ë°˜í™˜

#### ì˜ˆì‹œ 2: ì¸ì‹œë˜íŠ¸ í†µê³„ + ì°¨íŠ¸

```
"Show me incident statistics and trend chart for last 7 days"
```

**ì²˜ë¦¬ ê³¼ì •**:
1. `incident-analysis` MCP ë„êµ¬ ì¸ì‹
2. `get_incident_statistics` í˜¸ì¶œ â†’ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”
3. `create_incident_trend_chart` í˜¸ì¶œ â†’ ì°¨íŠ¸ ìƒì„±
4. í†µí•© ê²°ê³¼ ë°˜í™˜

#### ì˜ˆì‹œ 3: Claude ì‹¬ì¸µ ë¶„ì„

```
"Investigate incident 414186 using claude-investigation"
```

**ì²˜ë¦¬ ê³¼ì •**:
1. `collect_incident_data` í˜¸ì¶œ â†’ ì›ë³¸ ë°ì´í„° ìˆ˜ì§‘
2. Claudeê°€ ë°ì´í„° ë¶„ì„ ë° AI ì˜ê²¬ ì‘ì„±
3. `save_analysis_and_generate_report` í˜¸ì¶œ â†’ í•œê¸€ HTML ë³´ê³ ì„œ ìƒì„±
4. íŒŒì¼ ê²½ë¡œ ë°˜í™˜

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### âŒ ì¼ë°˜ì ì¸ ë¬¸ì œ

#### 1. "Incident not found"

```bash
# OpenSearch ì—°ê²° í™•ì¸
curl -u admin:Admin@123456 "http://opensearch:9200/_cat/indices/logs-cortex_xdr-incidents-*"

# ì¸ì‹œë˜íŠ¸ ì¡´ì¬ í™•ì¸
curl -u admin:Admin@123456 "http://opensearch:9200/logs-cortex_xdr-incidents-*/_search" \
  -H 'Content-Type: application/json' \
  -d '{"query":{"match":{"incident_id":"414186"}}}'
```

#### 2. "TI correlation failed"

```bash
# PostgreSQL ì—°ê²° í™•ì¸
psql -U postgres -h postgres -d n8n -c "SELECT COUNT(*) FROM ioclog.ioc_log;"

# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
echo $DATABASE_URL
```

#### 3. "AI analysis failed"

```bash
# Azure OpenAI API í‚¤ í™•ì¸
env | grep AZURE_OPENAI

# API ì—°ê²° í…ŒìŠ¤íŠ¸
curl -H "api-key: $AZURE_OPENAI_API_KEY" "$AZURE_OPENAI_ENDPOINT/openai/deployments?api-version=2023-05-15"
```

#### 4. "Disk full"

```bash
# 30ì¼ ì´ìƒ ëœ íŒŒì¼ ì‚­ì œ
find public/reports/ -name "*.json" -mtime +30 -delete
find public/reports/ -name "*.md" -mtime +30 -delete

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ í™•ì¸
du -sh public/reports/*
```

#### 5. "cron jobì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ"

```bash
# cron ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status cron

# cron ë¡œê·¸ í™•ì¸
sudo tail -f /var/log/syslog | grep CRON

# ìˆ˜ë™ ì‹¤í–‰ìœ¼ë¡œ ì—ëŸ¬ í™•ì¸
cd /www/ib-editor/my-app && ./script/auto-daily-report.sh
```

#### 6. "ê¶Œí•œ ë¬¸ì œ"

```bash
# ì‹¤í–‰ ê¶Œí•œ í™•ì¸
ls -la /www/ib-editor/my-app/script/*.sh

# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x /www/ib-editor/my-app/script/*.sh
```

#### 7. "OpenSearch connection refused"

```bash
# OpenSearch ìƒíƒœ í™•ì¸
curl -u "admin:Admin@123456" "http://opensearch:9200/_cluster/health?v"

# í˜¸ìŠ¤íŠ¸ ë§¤í•‘ í™•ì¸
cat /etc/hosts | grep opensearch
```

#### 8. "MCP ë„êµ¬ê°€ ì¸ì‹ë˜ì§€ ì•ŠìŒ"

```bash
# Claude Code ì™„ì „ ì¬ì‹œì‘ í•„ìš”
# (ë‹¨ìˆœ ìƒˆ ëŒ€í™”ê°€ ì•„ë‹ˆë¼ ì•± ìì²´ë¥¼ ì¢…ë£Œí–ˆë‹¤ê°€ ì¬ì‹œì‘)

# .mcp.json ê²½ë¡œ í™•ì¸
cat /www/ib-editor/my-app/.mcp.json | grep nl-query -A 10

# ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ì¡´ì¬ í™•ì¸
ls -la /www/ib-editor/my-app/script/nl-query-mcp.js
```

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- **README_INVESTIGATION.md** - ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬ ì‹œìŠ¤í…œ ìƒì„¸ ë¬¸ì„œ
- **README-DAILY-REPORT.md** - ì¼ê°„ ë³´ê³ ì„œ ìƒì„± ê°€ì´ë“œ
- **CRON_SETUP.md** - ìë™í™” ìŠ¤ì¼€ì¤„ë§ ì„¤ì •
- **CLAUDE_REPORTS_README.md** - Claude Code ê³ í’ˆì§ˆ ë³´ê³ ì„œ
- **NEXT_CONVERSATION.md** - ë‹¤ìŒ ëŒ€í™” ì¬ê°œ ê°€ì´ë“œ
- **CLAUDE.md** - Claude Code í”„ë¡œì íŠ¸ ê°€ì´ë“œ

---

## ğŸ“ ì‚¬ìš© ì‚¬ë¡€

### ì‚¬ë¡€ 1: SOC ë¶„ì„ê°€ (Interactive)

**ìƒí™©**: ë³´ì•ˆíŒ€ì´ ì¸ì‹œë˜íŠ¸ 414186ì„ False Positiveë¡œ ì˜ì‹¬

**í•´ê²°**:
```bash
# Claude Codeì—ì„œ
"Investigate incident 414186"

# ë˜ëŠ” CLIë¡œ
npx tsx script/investigate-incident-cli.ts --incident-id 414186
```

**ê²°ê³¼**: 8-16ì´ˆ ë‚´ì— JSON + Markdown + HTML ë³´ê³ ì„œ ìƒì„±

### ì‚¬ë¡€ 2: ìë™í™”ëœ SIEM (Production)

**ìƒí™©**: ë§¤ì¼ ìƒˆë²½ 1ì‹œì— ì „ë‚  ì¸ì‹œë˜íŠ¸ ìë™ ë¶„ì„

**í•´ê²°**:
```bash
# Crontab ë“±ë¡
0 1 * * * cd /www/ib-editor/my-app && ./script/auto-daily-report.sh >> /var/log/daily-report.log 2>&1
```

**ê²°ê³¼**: HTML + Markdown + JSON ë³´ê³ ì„œ ìë™ ìƒì„±

### ì‚¬ë¡€ 3: ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ (API)

**ìƒí™©**: í‹°ì¼“íŒ… ì‹œìŠ¤í…œì—ì„œ ì‹ ê·œ ì¸ì‹œë˜íŠ¸ ìˆ˜ì‹  ì‹œ ìë™ ì¡°ì‚¬

**í•´ê²°**:
```python
import requests

# í‹°ì¼“íŒ… ì‹œìŠ¤í…œì—ì„œ ì‹ ê·œ ì¸ì‹œë˜íŠ¸ ìˆ˜ì‹  ì‹œ
response = requests.post('http://localhost:40017/api/investigate', json={
    'incident_id': ticket.incident_id,
    'async': True
})

# ê²°ê³¼ë¥¼ í‹°ì¼“ì— ìë™ ì²¨ë¶€
```

### ì‚¬ë¡€ 4: íŒŒì¼ ê¸°ë°˜ íŠ¸ë¦¬ê±° (Watcher)

**ìƒí™©**: SIEMì´ CSV ë‚´ë³´ë‚´ê¸° â†’ ìë™ ì¡°ì‚¬

**í•´ê²°**:
```bash
# SIEMì´ CSV ë‚´ë³´ë‚´ê¸° â†’ ìŠ¤í¬ë¦½íŠ¸ê°€ incident ID ì¶”ì¶œ â†’ íŒŒì¼ ìƒì„±
cat incidents_export.csv | awk -F',' '{print $1}' | while read id; do
    echo "$id" > data/watch/incident-$id.txt
done

# File Watcherê°€ ìë™ìœ¼ë¡œ ëª¨ë“  ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬
```

### ì‚¬ë¡€ 5: ê²½ì˜ì§„ ì£¼ê°„ ë³´ê³  (Executive)

**ìƒí™©**: ë§¤ì£¼ ì›”ìš”ì¼ ê²½ì˜ì§„ì—ê²Œ ì£¼ê°„ ë³´ì•ˆ í˜„í™© ë³´ê³ 

**í•´ê²°**:
```bash
# Crontab ë“±ë¡
0 9 * * 1 cd /www/ib-editor/my-app && ./script/generate-weekly-report.sh >> /var/log/weekly-report.log 2>&1
```

**ê²°ê³¼**: Executive Summary + íŠ¸ë Œë“œ ì°¨íŠ¸ + ê¶Œì¥ì‚¬í•­

---

## ğŸš€ ë¹ ë¥¸ ì°¸ì¡°

### ëª…ë ¹ì–´ ì¹˜íŠ¸ì‹œíŠ¸

```bash
# ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬
npx tsx script/investigate-incident-cli.ts --incident-id 414186

# ì¼ê°„ ë³´ê³ ì„œ (ì–´ì œ)
./daily-report.sh

# ì¼ê°„ ë³´ê³ ì„œ (íŠ¹ì • ë‚ ì§œ)
./daily-report.sh 2025-11-10

# ì£¼ê°„ ë³´ê³ ì„œ
./script/generate-weekly-report.sh

# ìë™í™” ì¼ê°„ ë³´ê³ ì„œ
./script/auto-daily-report.sh

# ë¹ ë¥¸ í…ŒìŠ¤íŠ¸
./test/quick-test.sh

# Cron Job (í…ŒìŠ¤íŠ¸)
npx tsx script/cron-investigate.ts --once

# File Watcher
npx tsx script/watch-incidents.ts
```

### ì›¹ ë¸Œë¼ìš°ì € ì ‘ê·¼

```
# ì¼ê°„ ë³´ê³ ì„œ
http://localhost:40017/reports/daily/daily_report_2025-11-10.html

# ì£¼ê°„ ë³´ê³ ì„œ
http://localhost:40017/reports/weekly/weekly_report_2025-W45.html

# ê°œë³„ ì¸ì‹œë˜íŠ¸
http://localhost:40017/reports/incident_414186_2025-11-10T14-35-57.html
```

### ë¡œê·¸ í™•ì¸

```bash
# ì¼ê°„ ë³´ê³ ì„œ ë¡œê·¸
tail -f /var/log/daily-report.log

# ì£¼ê°„ ë³´ê³ ì„œ ë¡œê·¸
tail -f /var/log/weekly-report.log

# ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬ ë¡œê·¸
tail -f /var/log/incident-cron.log

# ìƒì„¸ ë¡œê·¸ (ë‚ ì§œë³„)
tail -f /tmp/auto-daily-report-2025-11-10.log
```

---

## ğŸ“Š ì„±ëŠ¥ ìš”ì•½

| ì‹œìŠ¤í…œ | ì‹¤í–‰ ì‹œê°„ | ë¹„ìš© | ì¶œë ¥ í˜•ì‹ | ìë™í™” |
|--------|----------|------|----------|--------|
| **ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬** | 8-16ì´ˆ | $0.001 | JSON + MD + HTML | âœ… Cron/API/Watcher |
| **ì¼ê°„ ë³´ê³ ì„œ** | 30-60ì´ˆ | $0.02 (AI í¬í•¨) | HTML + MD + JSON | âœ… Cron |
| **ì£¼ê°„ ë³´ê³ ì„œ** | 2-3ë¶„ | $0.10 (AI í¬í•¨) | HTML + MD + JSON | âœ… Cron |
| **Claude Code ë³´ê³ ì„œ** | 30-60ì´ˆ | $0.02 | HTML (ê³ í’ˆì§ˆ) | âŒ ìˆ˜ë™ |

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì´ˆê¸° ì„¤ì •

- [ ] `.env.local` íŒŒì¼ ìƒì„± ë° í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- [ ] OpenSearch ì—°ê²° í…ŒìŠ¤íŠ¸
- [ ] PostgreSQL ì—°ê²° í…ŒìŠ¤íŠ¸
- [ ] Azure OpenAI API í‚¤ ì„¤ì •
- [ ] ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬ (`chmod +x script/*.sh`)

### ìˆ˜ë™ í…ŒìŠ¤íŠ¸

- [ ] ë‹¨ì¼ ì¸ì‹œë˜íŠ¸ ì¡°ì‚¬ ì„±ê³µ
- [ ] ì¼ê°„ ë³´ê³ ì„œ ìƒì„± ì„±ê³µ
- [ ] ì£¼ê°„ ë³´ê³ ì„œ ìƒì„± ì„±ê³µ
- [ ] Claude Code MCP ë„êµ¬ ì¸ì‹

### ìë™í™” ì„¤ì •

- [ ] Cron job ë“±ë¡ (ì¼ê°„ ë³´ê³ ì„œ)
- [ ] Cron job ë“±ë¡ (ì£¼ê°„ ë³´ê³ ì„œ)
- [ ] Cron job ë“±ë¡ (ì¸ì‹œë˜íŠ¸ ìë™ ì¡°ì‚¬)
- [ ] ë¡œê·¸ ë””ë ‰í† ë¦¬ ìƒì„± (`/var/log/`)
- [ ] ë””ìŠ¤í¬ ê³µê°„ ëª¨ë‹ˆí„°ë§ ì„¤ì •

### ì•Œë¦¼ ì„¤ì • (ì„ íƒ)

- [ ] Supabase í…Œì´ë¸” ìƒì„±
- [ ] Slack ì›¹í›… ì„¤ì •
- [ ] Discord ì›¹í›… ì„¤ì •
- [ ] ì´ë©”ì¼ SMTP ì„¤ì •

---

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:

1. **ë¡œê·¸ í™•ì¸**:
   ```bash
   # CLI
   npx tsx script/investigate-incident-cli.ts --incident-id 414186 2>&1 | tee debug.log

   # ì¼ê°„ ë³´ê³ ì„œ
   tail -f /var/log/daily-report.log

   # Cron
   sudo journalctl -u cron -f
   ```

2. **í™˜ê²½ ë³€ìˆ˜ í™•ì¸**:
   ```bash
   cat .env.local | grep -E "OPENSEARCH|AZURE|DATABASE"
   ```

3. **ìƒíƒœ íŒŒì¼ í™•ì¸**:
   ```bash
   ls -lh public/reports/ | tail -20
   ```

---

**êµ¬ì¶• ì¼ì**: 2025-11-10
**ë²„ì „**: 2.0.0
**ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ìš´ì˜ ì¤‘
**ì‘ì„±ì**: Claude Code AI Assistant
