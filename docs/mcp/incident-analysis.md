# Incident Analysis MCP

ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ í†µê³„, íŠ¸ë Œë“œ, ìœ„í˜‘ ìœ í˜• ë¶„ì„, ì¢…í•© ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ëŠ” MCP ì„œë²„ì…ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨

- [ê°œìš”](#ê°œìš”)
- [ì•„í‚¤í…ì²˜](#ì•„í‚¤í…ì²˜)
- [ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬](#ì‚¬ìš©-ê°€ëŠ¥í•œ-ë„êµ¬)
- [ì„¤ì • ë°©ë²•](#ì„¤ì •-ë°©ë²•)
- [ì‚¬ìš©ë²•](#ì‚¬ìš©ë²•)
- [ê²€ì¦ í…ŒìŠ¤íŠ¸ ê²°ê³¼](#ê²€ì¦-í…ŒìŠ¤íŠ¸-ê²°ê³¼)
- [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

---

## ê°œìš”

**Incident Analysis MCP**ëŠ” OpenSearchì— ì €ì¥ëœ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

- ğŸ“Š **ì¸ì‹œë˜íŠ¸ í†µê³„ ë¶„ì„**: ì‹¬ê°ë„ë³„, ì¼ë³„ ì¸ì‹œë˜íŠ¸ ë¶„í¬
- ğŸ“ˆ **íŠ¸ë Œë“œ ì°¨íŠ¸ ìƒì„±**: ì‹œê°„ë³„/ì¼ë³„ ì¸ì‹œë˜íŠ¸ ì¶”ì´ ì‹œê°í™”
- ğŸ¯ **ìœ„í˜‘ ìœ í˜• ë¶„ì„**: ìƒìœ„ ìœ„í˜‘ ìœ í˜• Top 10 ë¶„ì„
- ğŸŒ **ì§€ë¦¬ì  ë¶„í¬ ë¶„ì„**: êµ­ê°€ë³„ ì¸ì‹œë˜íŠ¸ ë°œìƒ í˜„í™©
- ğŸ“‹ **ì¢…í•© ë³´ê³ ì„œ ìƒì„±**: ëª¨ë“  ë¶„ì„ì„ í†µí•©í•œ ë§ˆí¬ë‹¤ìš´ ë³´ê³ ì„œ

### ì£¼ìš” íŠ¹ì§•

- âœ… **ì‹¤ì‹œê°„ ë°ì´í„° ë¶„ì„**: OpenSearchì—ì„œ ì§ì ‘ ì¿¼ë¦¬
- âœ… **ì°¨íŠ¸ ìë™ ìƒì„±**: Chart.js + Canvasë¡œ PNG ì´ë¯¸ì§€ ìƒì„±
- âœ… **ë§ˆí¬ë‹¤ìš´ ì¶œë ¥**: Claude Desktopì—ì„œ ë°”ë¡œ í™•ì¸ ê°€ëŠ¥
- âœ… **ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ëŠ¥**: ì¸ë±ìŠ¤ íŒ¨í„´, ê¸°ê°„, í•„ë“œëª… ììœ  ì„¤ì •

---

## ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì¡°

```
Claude Desktop (Windows/macOS/Linux)
    â†“ STDIO (JSON-RPC)
incident-analysis-inbridge (í”„ë¡ì‹œ í´ë¼ì´ì–¸íŠ¸)
    â†“ HTTP POST
http://20.41.120.173:8100/tools/{tool_name}
    â†“
Incident Analysis MCP Server (Express HTTP Server)
    â†“ OpenSearch Query DSL
OpenSearch (http://opensearch:9200)
    User: admin
    Pass: Admin@123456
    â†“
logs-cortex_xdr-incidents-* (ì¸ë±ìŠ¤)
```

### ì»´í¬ë„ŒíŠ¸ ì„¤ëª…

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ìœ„ì¹˜ | ê¸°ìˆ  ìŠ¤íƒ |
|---------|------|------|-----------|
| **incident-analysis-inbridge** | HTTP í”„ë¡ì‹œ í´ë¼ì´ì–¸íŠ¸ | Windows/macOS | Node.js + axios |
| **incident-analysis-mcp-server** | ë¶„ì„ ë¡œì§ + OpenSearch ì—°ë™ | Linux (20.41.120.173:8100) | Express + Chart.js + Canvas |
| **OpenSearch** | ì¸ì‹œë˜íŠ¸ ë°ì´í„° ì €ì¥ì†Œ | 20.41.120.173:9200 | OpenSearch 3.5 |

---

## ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬

### 1. get_incident_statistics

ì¸ì‹œë˜íŠ¸ í†µê³„ ë°ì´í„°ë¥¼ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

**ì…ë ¥ íŒŒë¼ë¯¸í„°:**
```json
{
  "index_pattern": "logs-cortex_xdr-incidents-*",  // ê²€ìƒ‰í•  ì¸ë±ìŠ¤ íŒ¨í„´
  "days": 7,                                       // ë¶„ì„í•  ì¼ìˆ˜ (ê¸°ë³¸: 7ì¼)
  "severity_field": "severity"                     // ì‹¬ê°ë„ í•„ë“œëª… (ê¸°ë³¸: severity)
}
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```markdown
# ì¸ì‹œë˜íŠ¸ í†µê³„ ë¶„ì„ (ìµœê·¼ 7ì¼)

## ì „ì²´ ìš”ì•½
- **ì´ ì¸ì‹œë˜íŠ¸ ìˆ˜**: 388ê±´
- **ì¼í‰ê·  ì¸ì‹œë˜íŠ¸**: 55ê±´
- **ë¶„ì„ ê¸°ê°„**: 2025-11-01 ~ 2025-11-08

## ì‹¬ê°ë„ë³„ ë¶„í¬
| ì‹¬ê°ë„      | ê±´ìˆ˜  | ë¹„ìœ¨    |
| -------- | --- | ----- |
| medium   | 290 | 74.7% |
| low      | 77  | 19.8% |
| high     | 16  | 4.1%  |
| critical | 5   | 1.3%  |

## ì¼ë³„ ì¸ì‹œë˜íŠ¸ ë°œìƒ í˜„í™©
| ë‚ ì§œ         | ì¸ì‹œë˜íŠ¸ ìˆ˜ |
| ---------- | ------ |
| 2025-11-01 | 41     |
| 2025-11-02 | 17     |
| 2025-11-03 | 330    |
```

---

### 2. create_incident_trend_chart

ì¸ì‹œë˜íŠ¸ íŠ¸ë Œë“œë¥¼ ì‹œê°„ë³„/ì¼ë³„ë¡œ ì°¨íŠ¸ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

**ì…ë ¥ íŒŒë¼ë¯¸í„°:**
```json
{
  "index_pattern": "logs-cortex_xdr-incidents-*",
  "days": 7,
  "interval": "1d"  // "1h" (ì‹œê°„ë³„) ë˜ëŠ” "1d" (ì¼ë³„)
}
```

**ì¶œë ¥:**
- ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸”
- PNG ì°¨íŠ¸ ì´ë¯¸ì§€ (ì„ í˜• ê·¸ë˜í”„)

---

### 3. analyze_top_threats

ìƒìœ„ ìœ„í˜‘ ìœ í˜•ì„ ë¶„ì„í•˜ê³  í…Œì´ë¸”ê³¼ íŒŒì´ ì°¨íŠ¸ë¡œ ìƒì„±í•©ë‹ˆë‹¤.

**ì…ë ¥ íŒŒë¼ë¯¸í„°:**
```json
{
  "index_pattern": "logs-cortex_xdr-incidents-*",
  "days": 7,
  "threat_field": "threat_type",  // ìœ„í˜‘ ìœ í˜• í•„ë“œëª…
  "top_count": 10                 // ìƒìœ„ ëª‡ ê°œ í‘œì‹œ (ê¸°ë³¸: 10)
}
```

**ì¶œë ¥:**
- ìˆœìœ„ë³„ ìœ„í˜‘ ìœ í˜• í…Œì´ë¸”
- PNG íŒŒì´ ì°¨íŠ¸ (ìœ„í˜‘ ë¶„í¬)

---

### 4. analyze_geographic_distribution

êµ­ê°€ë³„ ì¸ì‹œë˜íŠ¸ ë°œìƒ í˜„í™©ì„ ë¶„ì„í•©ë‹ˆë‹¤.

**ì…ë ¥ íŒŒë¼ë¯¸í„°:**
```json
{
  "index_pattern": "logs-cortex_xdr-incidents-*",
  "days": 7,
  "geo_field": "geoip.country_name"  // ì§€ë¦¬ ì •ë³´ í•„ë“œëª…
}
```

**ì¶œë ¥:**
- êµ­ê°€ë³„ ì¸ì‹œë˜íŠ¸ í…Œì´ë¸”
- PNG ë§‰ëŒ€ ì°¨íŠ¸ (ìƒìœ„ 10ê°œêµ­)

---

### 5. generate_incident_report

ëª¨ë“  ë¶„ì„ ê²°ê³¼ë¥¼ í†µí•©í•œ ì¢…í•© ë³´ê³ ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

**ì…ë ¥ íŒŒë¼ë¯¸í„°:**
```json
{
  "index_pattern": "logs-cortex_xdr-incidents-*",
  "days": 7,
  "report_title": "ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë¶„ì„ ë³´ê³ ì„œ"
}
```

**ì¶œë ¥:**
- í†µê³„ ë¶„ì„
- ìœ„í˜‘ ìœ í˜• ë¶„ì„
- ì§€ë¦¬ì  ë¶„í¬ ë¶„ì„
- ê¶Œì¥ì‚¬í•­
- ë‹¤ìŒ ë‹¨ê³„

---

## ì„¤ì • ë°©ë²•

### .mcp.json ì„¤ì •

```json
{
  "mcpServers": {
    "incident-analysis": {
      "command": "incident-analysis-inbridge",
      "env": {
        "MCP_SERVER_URL": "http://20.41.120.173:8100"
      },
      "description": "Incident Analysis MCP - Generate statistics, trends, charts, threat analysis, and comprehensive reports from security incidents"
    }
  }
}
```

### í”„ë¡ì‹œ í´ë¼ì´ì–¸íŠ¸ ì„¤ì¹˜ (ì„ íƒì‚¬í•­)

ì „ì—­ ì„¤ì¹˜:
```bash
npm install -g git+https://github.com/jijuta/incident-analysis-inbridge.git
```

ë¡œì»¬ ê²½ë¡œ ì‚¬ìš©:
```json
{
  "command": "/www/ib-editor/incident-analysis-inbridge/index.js"
}
```

---

## ì‚¬ìš©ë²•

### ê¸°ë³¸ í†µê³„ ë¶„ì„

**ì§ˆë¬¸:**
```
"ìµœê·¼ 7ì¼ê°„ ì¸ì‹œë˜íŠ¸ í†µê³„ë¥¼ ë¶„ì„í•´ì¤˜"
```

**Claudeê°€ ìë™ìœ¼ë¡œ:**
1. `get_incident_statistics` ë„êµ¬ í˜¸ì¶œ
2. ì¸ë±ìŠ¤: `logs-cortex_xdr-incidents-*`
3. ê¸°ê°„: 7ì¼
4. ì‹¬ê°ë„ë³„ ë¶„í¬ + ì¼ë³„ í˜„í™© í…Œì´ë¸” ë°˜í™˜

---

### íŠ¸ë Œë“œ ë¶„ì„

**ì§ˆë¬¸:**
```
"ìµœê·¼ 14ì¼ê°„ ì¸ì‹œë˜íŠ¸ íŠ¸ë Œë“œë¥¼ ì¼ë³„ë¡œ ì°¨íŠ¸ë¡œ ë³´ì—¬ì¤˜"
```

**ê²°ê³¼:**
- ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” (ë‚ ì§œë³„ ì¸ì‹œë˜íŠ¸ ìˆ˜)
- PNG ì„ í˜• ì°¨íŠ¸ (800x400px)

---

### ìœ„í˜‘ ìœ í˜• ë¶„ì„

**ì§ˆë¬¸:**
```
"ìƒìœ„ 10ê°œ ìœ„í˜‘ ìœ í˜•ì„ ë¶„ì„í•´ì„œ íŒŒì´ì°¨íŠ¸ë¡œ ë³´ì—¬ì¤˜"
```

**ê²°ê³¼:**
- ìˆœìœ„ë³„ í…Œì´ë¸” (ìœ„í˜‘ ìœ í˜•, ê±´ìˆ˜, ë¹„ìœ¨)
- PNG íŒŒì´ ì°¨íŠ¸ (600x600px)

---

### ì¢…í•© ë³´ê³ ì„œ ìƒì„±

**ì§ˆë¬¸:**
```
"ìµœê·¼ 30ì¼ê°„ ì¢…í•©ì ì¸ ë³´ì•ˆ ì¸ì‹œë˜íŠ¸ ë¶„ì„ ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ì¤˜"
```

**ê²°ê³¼:**
- ì „ì²´ í†µê³„
- ì‹¬ê°ë„ë³„ ë¶„í¬
- ìœ„í˜‘ ìœ í˜• Top 10
- ì§€ë¦¬ì  ë¶„í¬
- ê¶Œì¥ì‚¬í•­ ë° ë‹¤ìŒ ë‹¨ê³„

---

### ì»¤ìŠ¤í…€ ë¶„ì„

**ì§ˆë¬¸:**
```
"logs-security-* ì¸ë±ìŠ¤ì—ì„œ ìµœê·¼ 14ì¼ê°„ alert_category í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìœ„í˜‘ì„ ë¶„ì„í•´ì¤˜"
```

**íŒŒë¼ë¯¸í„° ìë™ ì„¤ì •:**
```json
{
  "index_pattern": "logs-security-*",
  "days": 14,
  "threat_field": "alert_category"
}
```

---

## ê²€ì¦ í…ŒìŠ¤íŠ¸ ê²°ê³¼

### í…ŒìŠ¤íŠ¸ í™˜ê²½

- **í…ŒìŠ¤íŠ¸ ì¼ì‹œ**: 2025-11-08
- **MCP ì„œë²„**: http://20.41.120.173:8100
- **OpenSearch**: http://opensearch:9200
- **ì¸ë±ìŠ¤**: logs-cortex_xdr-incidents-*
- **ë°ì´í„° ê¸°ê°„**: 2025-11-01 ~ 2025-11-08 (7ì¼)

---

### âœ… í…ŒìŠ¤íŠ¸ 1: ì„œë²„ í—¬ìŠ¤ì²´í¬

**ëª…ë ¹:**
```bash
curl http://20.41.120.173:8100/health
```

**ê²°ê³¼:**
```json
{
  "status": "healthy",
  "service": "incident-analysis-mcp-server",
  "version": "1.0.0",
  "chart_support": true,
  "opensearch_url": "http://localhost:9200"
}
```

**ìƒíƒœ**: âœ… PASS
- ì„œë²„ ì •ìƒ ë™ì‘
- ì°¨íŠ¸ ì§€ì› í™œì„±í™”ë¨
- OpenSearch ì—°ê²° ê°€ëŠ¥

---

### âœ… í…ŒìŠ¤íŠ¸ 2: ì¸ì‹œë˜íŠ¸ í†µê³„ ë¶„ì„

**ëª…ë ¹:**
```bash
curl -X POST http://20.41.120.173:8100/tools/get_incident_statistics \
  -H "Content-Type: application/json" \
  -d '{
    "index_pattern": "logs-cortex_xdr-incidents-*",
    "days": 7,
    "severity_field": "severity"
  }'
```

**ê²°ê³¼:**
```markdown
# ì¸ì‹œë˜íŠ¸ í†µê³„ ë¶„ì„ (ìµœê·¼ 7ì¼)

## ì „ì²´ ìš”ì•½
- **ì´ ì¸ì‹œë˜íŠ¸ ìˆ˜**: 388ê±´
- **ì¼í‰ê·  ì¸ì‹œë˜íŠ¸**: 55ê±´
- **ë¶„ì„ ê¸°ê°„**: 2025-11-01 ~ 2025-11-08

## ì‹¬ê°ë„ë³„ ë¶„í¬
| ì‹¬ê°ë„      | ê±´ìˆ˜  | ë¹„ìœ¨    |
| -------- | --- | ----- |
| medium   | 290 | 74.7% |
| low      | 77  | 19.8% |
| high     | 16  | 4.1%  |
| critical | 5   | 1.3%  |
```

**ìƒíƒœ**: âœ… PASS
- ì´ 388ê±´ì˜ ì¸ì‹œë˜íŠ¸ ê²€ìƒ‰ ì„±ê³µ
- ì‹¬ê°ë„ë³„ ë¶„ë¥˜ ì •ìƒ
- ì¼í‰ê·  ê³„ì‚° ì •í™•
- ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” ì •ìƒ ìƒì„±

**ë¶„ì„ ê²°ê³¼:**
- Medium ì‹¬ê°ë„ê°€ 74.7%ë¡œ ê°€ì¥ ë§ìŒ
- Critical ì¸ì‹œë˜íŠ¸ëŠ” 5ê±´(1.3%)ìœ¼ë¡œ ê´€ë¦¬ ê°€ëŠ¥í•œ ìˆ˜ì¤€
- 11ì›” 3ì¼ì— 330ê±´ì˜ ê¸‰ì¦ í˜„ìƒ í™•ì¸ (ëª¨ë‹ˆí„°ë§ í•„ìš”)

---

### âœ… í…ŒìŠ¤íŠ¸ 3: ìœ„í˜‘ ìœ í˜• ë¶„ì„

**ëª…ë ¹:**
```bash
curl -X POST http://20.41.120.173:8100/tools/analyze_top_threats \
  -H "Content-Type: application/json" \
  -d '{
    "index_pattern": "logs-cortex_xdr-incidents-*",
    "days": 7,
    "threat_field": "alert_category",
    "top_count": 5
  }'
```

**ê²°ê³¼:**
```markdown
# ìƒìœ„ ìœ„í˜‘ ìœ í˜• ë¶„ì„ (ìµœê·¼ 7ì¼)

| ìˆœìœ„ | ìœ„í˜‘ ìœ í˜• | ë°œìƒ ê±´ìˆ˜ | ë¹„ìœ¨ |
| -- | ----- | ----- | -- |
```

**ìƒíƒœ**: âš ï¸ PARTIAL PASS
- API ì •ìƒ ì‘ë‹µ
- ë¹ˆ ê²°ê³¼ ë°˜í™˜ (í•„ë“œëª… ë¶ˆì¼ì¹˜ ê°€ëŠ¥ì„±)

**í•´ê²° ë°©ë²•:**
- `alert_category` ëŒ€ì‹  ë‹¤ë¥¸ í•„ë“œëª… ì‚¬ìš© (ì˜ˆ: `threat_type`, `category`)
- OpenSearch ë§¤í•‘ í™•ì¸ í•„ìš”

---

### âœ… í…ŒìŠ¤íŠ¸ 4: ì°¨íŠ¸ ì§€ì› í™•ì¸

**í™•ì¸ í•­ëª©:**
- Chart.js: âœ… ì„¤ì¹˜ë¨
- Canvas: âœ… ì„¤ì¹˜ë¨ (Linux í™˜ê²½)
- D3.js: âœ… ì„¤ì¹˜ë¨

**ì°¨íŠ¸ ìƒì„± ê°€ëŠ¥ ìœ í˜•:**
- Line Chart (íŠ¸ë Œë“œ ë¶„ì„)
- Pie Chart (ìœ„í˜‘ ë¶„í¬)
- Bar Chart (ì§€ë¦¬ì  ë¶„í¬)

**ì´ë¯¸ì§€ ì¶œë ¥:**
- í¬ë§·: PNG
- ì¸ì½”ë”©: Base64
- MIME Type: `image/png`

---

## ë¬¸ì œ í•´ê²°

### 1. ì„œë²„ ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:**
```
âŒ Cannot connect to MCP server: http://20.41.120.173:8100
```

**í•´ê²° ë°©ë²•:**
```bash
# ì„œë²„ ìƒíƒœ í™•ì¸
curl http://20.41.120.173:8100/health

# ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
ping 20.41.120.173

# í¬íŠ¸ 8100 ì—´ë ¤ìˆëŠ”ì§€ í™•ì¸
telnet 20.41.120.173 8100
```

---

### 2. ë¹ˆ ê²°ê³¼ ë°˜í™˜

**ì›ì¸:**
- ì¸ë±ìŠ¤ íŒ¨í„´ ë¶ˆì¼ì¹˜
- í•„ë“œëª… ì˜¤ë¥˜
- ë‚ ì§œ ë²”ìœ„ì— ë°ì´í„° ì—†ìŒ

**í•´ê²° ë°©ë²•:**
```bash
# ì¸ë±ìŠ¤ ëª©ë¡ í™•ì¸
curl -u admin:Admin@123456 http://opensearch:9200/_cat/indices?v

# í•„ë“œ ë§¤í•‘ í™•ì¸
curl -u admin:Admin@123456 http://opensearch:9200/logs-cortex_xdr-incidents-*/_mapping

# ë°ì´í„° ì¡´ì¬ ì—¬ë¶€ í™•ì¸
curl -u admin:Admin@123456 http://opensearch:9200/logs-cortex_xdr-incidents-*/_count
```

---

### 3. ì°¨íŠ¸ ìƒì„± ì‹¤íŒ¨

**Windows í™˜ê²½:**
- Canvas ì„¤ì¹˜ ì‹¤íŒ¨ ì‹œ â†’ í…Œì´ë¸”ë§Œ ë°˜í™˜ë¨
- í•´ê²°: Linux ì„œë²„ì˜ `incident-analysis-mcp-server` ì‚¬ìš©

**Linux/macOS í™˜ê²½:**
```bash
# Canvas ì„¤ì¹˜ í™•ì¸
npm list canvas

# ì¬ì„¤ì¹˜
npm install canvas
```

---

### 4. ëŠë¦° ì¿¼ë¦¬ ì‘ë‹µ

**ì›ì¸:**
- í° ë‚ ì§œ ë²”ìœ„
- ë§ì€ ì¸ë±ìŠ¤
- ë³µì¡í•œ aggregation

**í•´ê²° ë°©ë²•:**
- `days` íŒŒë¼ë¯¸í„° ì¤„ì´ê¸° (ì˜ˆ: 30 â†’ 7)
- íŠ¹ì • ì¸ë±ìŠ¤ë§Œ ì¿¼ë¦¬ (ì™€ì¼ë“œì¹´ë“œ ìµœì†Œí™”)
- OpenSearch ì„±ëŠ¥ ìµœì í™”

---

## OpenSearch ì¿¼ë¦¬ ì˜ˆì‹œ

### í†µê³„ ì¿¼ë¦¬
```json
{
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-11-01T00:00:00.000Z",
        "lte": "2025-11-08T00:00:00.000Z"
      }
    }
  },
  "aggs": {
    "severity_stats": {
      "terms": {
        "field": "severity.keyword",
        "size": 10
      }
    },
    "daily_count": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "1d"
      }
    }
  },
  "size": 0
}
```

---

## ì„±ëŠ¥ ìµœì í™”

### ê¶Œì¥ ì‚¬í•­

1. **ì¸ë±ìŠ¤ íŒ¨í„´ ìµœì í™”**
   - âŒ `logs-*` (ë„ˆë¬´ ê´‘ë²”ìœ„)
   - âœ… `logs-cortex_xdr-incidents-*` (íŠ¹ì •)

2. **ë‚ ì§œ ë²”ìœ„ ì œí•œ**
   - âŒ `days: 90` (3ê°œì›”)
   - âœ… `days: 7` (1ì£¼ì¼)

3. **Aggregation í¬ê¸° ì œí•œ**
   - âŒ `size: 100`
   - âœ… `size: 10`

4. **ìºì‹± í™œìš©**
   - ë™ì¼í•œ ì¿¼ë¦¬ ë°˜ë³µ ì‹œ ê²°ê³¼ ìºì‹±
   - OpenSearch ì¿¼ë¦¬ ìºì‹œ í™œì„±í™”

---

## ì°¸ê³  ìë£Œ

- [OpenSearch Documentation](https://opensearch.org/docs/)
- [Chart.js Documentation](https://www.chartjs.org/docs/)
- [Model Context Protocol](https://modelcontextprotocol.io/)
- [incident-analysis-inbridge GitHub](https://github.com/jijuta/incident-analysis-inbridge)

---

## ë²„ì „ ì •ë³´

- **MCP Server Version**: 1.0.0
- **OpenSearch**: 3.5
- **Chart.js**: 4.4.4
- **Canvas**: 2.11.2
- **Express**: 4.18.2

---

## ë¼ì´ì„ ìŠ¤

MIT License

---

**ì‘ì„±ì¼**: 2025-11-08
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-08
**ì‘ì„±ì**: InBridge Security Team
