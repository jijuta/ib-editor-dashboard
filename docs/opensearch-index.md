# Cortex XDR 실제 수집 데이터 (2025-06-30 ~ 2025-09-13)

> **생성일**: 2025-11-21
> **OpenSearch**: opensearch:9200
> **분석 기간**: 2025-06-30 ~ 2025-09-13 (실제 수집 데이터)
> **더미 데이터**: 이 기간 외 데이터는 모두 시뮬레이션/테스트 데이터

---

## 📊 실제 수집 데이터 인덱스 현황

### 핵심 인시던트 데이터 (인시던트 ID `4*` 패턴)

| 인덱스 패턴 | 건수 | 데이터 기간 | 상태 |
|------------|------|------------|------|
| **Incidents** | 2,301건 | 2025-07-03 ~ 09-13 | ✅ 완전 |
| **Incident Details** | 2,035건 | 2025-08-02 ~ 09-13 | ⚠️ 266건 누락 |
| **Alerts** | 4,572건 | 2025-07-03 ~ 09-19 | ✅ 있음 |
| **File Artifacts** | 81,341건 | 2025-08-02 ~ 09-30 | ✅ 있음 |
| **File (Short)** | 34건 | 2025-08-01 ~ 09-21 | ✅ 있음 |
| **Network Artifacts** | 24,336건 | 2025-08-02 ~ 09-30 | ✅ 있음 |
| **Endpoints** | 257,970건 | 2025-08-02 ~ 09-19 | ✅ 있음 |

### 보안 분석 데이터

| 인덱스 패턴 | 건수 | 데이터 기간 | 상태 |
|------------|------|------------|------|
| **VA CVEs** | 18,532건 | 2025-08-28, 09-17 | ⚠️ 2일치만 |
| **VA Endpoints** | 4,385건 | 2025-08-28, 09-17 | ⚠️ 2일치만 |
| **MITRE Mappings** | 772건 | 2025-08-03 ~ 08-23 | ⚠️ 8월만 |

### 시스템 로그

| 인덱스 패턴 | 건수 | 데이터 기간 | 상태 |
|------------|------|------------|------|
| **Audit Logs** | 22,826건 | 2025-08-02 ~ 09-17 | ✅ 있음 |
| **Agent Audit Logs** | 131,712건 | 2025-08-22 ~ 09-17 | ✅ 있음 |
| **Endpoint Changes** | 5,527건 | 2025-08-02 ~ 09-17 | ✅ 있음 |

### 성능 & 모니터링

| 인덱스 패턴 | 건수 | 데이터 기간 | 상태 |
|------------|------|------------|------|
| **Hybrid Performance** | 615,218건 | 2025-08-03 ~ 09-15 | ✅ 있음 |
| **Hybrid Alerts** | 37,605건 | 2025-08-03 ~ 09-13 | ✅ 있음 |
| **Hybrid Basic Alerts** | 137,759건 | 2025-08-03 ~ 09-13 | ✅ 있음 |
| **Scripts** | 533건 | 2025-08-03 ~ 09-12 | ✅ 있음 |

### 프로세스 & 이벤트

| 인덱스 패턴 | 건수 | 데이터 기간 | 상태 |
|------------|------|------------|------|
| **Process Events** | 151건 | 2025-08-03, 08-23 | ⚠️ 2일치만 |
| **Process Chains** | 29건 | 2025-08-03, 08-23 | ⚠️ 2일치만 |
| **Registry Events** | 2건 | 2025-08-23 | ⚠️ 1일치만 |
| **Network Events** | 7건 | 2025-08-23 | ⚠️ 1일치만 |
| **File Events** | 32건 | 2025-08-23 | ⚠️ 1일치만 |

### 상관 분석 & 매핑

| 인덱스 패턴 | 건수 | 데이터 기간 | 상태 |
|------------|------|------------|------|
| **Incident-Alert Mappings** | 1,472건 | 2025-08-03, 08-25 | ⚠️ 2일치만 |

---

## 📅 데이터 수집 타임라인

```
2025-06-30 ─────────── 7월 초 ─────────── 8월 초 ─────────── 9월 초 ───── 9월 13일
    │                      │                  │                  │           │
    │                      ▼                  ▼                  ▼           ▼
    │              ┌───────────────┬──────────────────┬──────────────┬──────┐
    │              │   Incidents   │                  │              │      │
    │              │     Alerts    │                  │              │      │
    └──────────────┼───────────────┼──────────────────┼──────────────┼──────┤
                   │               │  File Artifacts  │              │      │
                   │               │  Network         │              │      │
                   │               │  Endpoints       │              │      │
                   │               │  Audit Logs      │              │      │
                   │               │  Endpoint Changes│              │      │
                   │               ├──────────────────┤              │      │
                   │               │  MITRE (8월만)   │              │      │
                   │               │  VA CVEs (2일)   │              │      │
                   │               │  Events (1-2일)  │              │      │
                   └───────────────┴──────────────────┴──────────────┴──────┘
                   실제 수집 시작    대부분 인덱스 시작   일부 종료      수집 종료
```

---

## ✅ 완전한 데이터 (권장 사용)

### 1. Incidents
- **기간**: 2025-07-03 ~ 2025-09-13
- **건수**: 2,301건
- **완전성**: 100%
- **용도**: 기본 인시던트 분석, 통계, 대시보드

### 2. Alerts
- **기간**: 2025-07-03 ~ 2025-09-19
- **건수**: 4,572건
- **완전성**: 알 수 없음 (검증 필요)
- **용도**: 개별 알림 분석, Detection 추적

### 3. File Artifacts
- **기간**: 2025-08-02 ~ 2025-09-30
- **건수**: 81,341건
- **완전성**: 알 수 없음 (8월 초부터 시작)
- **용도**: 파일 해시 분석, 악성코드 추적

### 4. Network Artifacts
- **기간**: 2025-08-02 ~ 2025-09-30
- **건수**: 24,336건
- **완전성**: 알 수 없음 (8월 초부터 시작)
- **용도**: 네트워크 연결 분석, C2 탐지

### 5. Endpoints
- **기간**: 2025-08-02 ~ 2025-09-19
- **건수**: 257,970건
- **완전성**: 알 수 없음 (8월 초부터 시작)
- **용도**: 호스트 정보, 에이전트 상태

---

## ⚠️ 부분 데이터 (주의 필요)

### 1. Incident Details
- **기간**: 2025-08-02 ~ 2025-09-13
- **건수**: 2,035건 (266건 누락, 88.4%)
- **누락 주차**: 8월 11일 (140건), 8월 18일 (126건)
- **권장**: 7월 데이터 또는 8월 11-18일 제외

### 2. VA CVEs (취약점)
- **기간**: 2025-08-28, 2025-09-17 (2일치만)
- **건수**: 18,532건
- **문제**: 전체 기간 데이터 없음
- **권장**: 제한적 사용, 트렌드 분석 불가

### 3. MITRE Mappings
- **기간**: 2025-08-03 ~ 2025-08-23 (3주만)
- **건수**: 772건
- **문제**: 8월만 존재
- **권장**: 8월 데이터 분석 시에만 사용

### 4. Process/Registry/File/Network Events
- **기간**: 2025-08-03, 2025-08-23 (1~2일치)
- **건수**: 합계 221건
- **문제**: 매우 제한적
- **권장**: 특정 날짜 샘플 분석용

---

## ❌ 누락 데이터

다음 데이터는 이 기간에 **수집되지 않았거나 매우 제한적**입니다:

- CVE 데이터 (2일치만)
- VA Endpoints (2일치만)
- MITRE Mappings (8월만)
- Process/Registry Events (1~2일치)
- Incident-Alert Mappings (2일치)

---

## 🔧 권장 Query 패턴

### 실제 인시던트만 조회
```json
GET logs-cortex_xdr-incidents-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "regexp": { "incident_id.keyword": "4[0-9]{5,8}" } },
        { "range": { "creation_time": {
          "gte": 1719705600000,
          "lte": 1726185599999
        }}}
      ]
    }
  }
}
```

### 파일 해시 분석 (8월~9월)
```json
GET logs-cortex_xdr-file-artifacts-2025.0[8-9].*/_search
{
  "query": {
    "exists": { "field": "file_sha256" }
  }
}
```

### 네트워크 아티팩트 (8월~9월)
```json
GET logs-cortex_xdr-network-artifacts-2025.0[8-9].*/_search
{
  "query": {
    "exists": { "field": "external_ip" }
  }
}
```

### CVE 조회 (제한적)
```json
GET logs-cortex_xdr-va-cves-2025.08.28,logs-cortex_xdr-va-cves-2025.09.17/_search
{
  "query": {
    "match_all": {}
  }
}
```

---

## 📋 데이터 사용 가이드

### ✅ 안전하게 사용 가능
1. **Incidents** (2025-07-03 ~ 09-13) - 100% 완전
2. **Alerts** (2025-07-03 ~ 09-19) - 전체 기간 존재
3. **File Artifacts** (2025-08-02 ~ 09-30) - 8월부터 풍부
4. **Network Artifacts** (2025-08-02 ~ 09-30) - 8월부터 풍부
5. **Endpoints** (2025-08-02 ~ 09-19) - 8월부터 풍부

### ⚠️ 주의해서 사용
1. **Incident Details** - 8월 11일, 18일 주 266건 누락
2. **VA CVEs** - 2일치만 (트렌드 분석 불가)
3. **MITRE Mappings** - 8월만 (3주)

### ❌ 사용 불가 또는 매우 제한적
1. **Process Events** - 2일치만
2. **Registry Events** - 1일치만
3. **File Events** - 1일치만
4. **Network Events** - 1일치만

---

## 🎯 분석 시나리오별 권장

### 시나리오 1: 인시던트 트렌드 분석
- **인덱스**: `logs-cortex_xdr-incidents-*`
- **기간**: 2025-07-03 ~ 09-13 (11주)
- **신뢰도**: ✅ 높음

### 시나리오 2: 파일 해시 상세 분석
- **인덱스**: `logs-cortex_xdr-file-artifacts-2025.0[8-9].*`
- **기간**: 2025-08-02 ~ 09-30
- **신뢰도**: ⚠️ 중간 (8월부터만)

### 시나리오 3: CVE 취약점 분석
- **인덱스**: `logs-cortex_xdr-va-cves-*`
- **기간**: 2025-08-28, 09-17 (2일만)
- **신뢰도**: ❌ 낮음 (트렌드 불가)

### 시나리오 4: MITRE ATT&CK 매핑
- **인덱스**: `logs-cortex_xdr-mitre-mappings-2025.08.*`
- **기간**: 2025-08-03 ~ 08-23 (3주)
- **신뢰도**: ⚠️ 중간 (8월만)

---

## 📚 참고 문서

- [Cortex-XDR-Real-Data-Analysis.md](Cortex-XDR-Real-Data-Analysis.md) - 상세 데이터 분석 보고서
- [Cortex-XDR-Index-Patterns.md](Cortex-XDR-Index-Patterns.md) - 전체 인덱스 패턴 목록
- [CLAUDE.md](../CLAUDE.md) - 프로젝트 가이드

---

**생성 도구**: Claude Code + opensearch-mcp
**최종 업데이트**: 2025-11-21
**문서 버전**: 1.0
